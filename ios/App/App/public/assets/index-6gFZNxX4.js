(function(){const p=document.createElement("link").relList;if(p&&p.supports&&p.supports("modulepreload"))return;for(const C of document.querySelectorAll('link[rel="modulepreload"]'))x(C);new MutationObserver(C=>{for(const y of C)if(y.type==="childList")for(const _ of y.addedNodes)_.tagName==="LINK"&&_.rel==="modulepreload"&&x(_)}).observe(document,{childList:!0,subtree:!0});function f(C){const y={};return C.integrity&&(y.integrity=C.integrity),C.referrerPolicy&&(y.referrerPolicy=C.referrerPolicy),C.crossOrigin==="use-credentials"?y.credentials="include":C.crossOrigin==="anonymous"?y.credentials="omit":y.credentials="same-origin",y}function x(C){if(C.ep)return;C.ep=!0;const y=f(C);fetch(C.href,y)}})();var Mh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function uc(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var Bu={exports:{}},La={},Uu={exports:{}},pt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hf;function Fh(){if(hf)return pt;hf=1;var i=Symbol.for("react.element"),p=Symbol.for("react.portal"),f=Symbol.for("react.fragment"),x=Symbol.for("react.strict_mode"),C=Symbol.for("react.profiler"),y=Symbol.for("react.provider"),_=Symbol.for("react.context"),E=Symbol.for("react.forward_ref"),S=Symbol.for("react.suspense"),L=Symbol.for("react.memo"),R=Symbol.for("react.lazy"),J=Symbol.iterator;function V(w){return w===null||typeof w!="object"?null:(w=J&&w[J]||w["@@iterator"],typeof w=="function"?w:null)}var se={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},he=Object.assign,fe={};function X(w,N,re){this.props=w,this.context=N,this.refs=fe,this.updater=re||se}X.prototype.isReactComponent={},X.prototype.setState=function(w,N){if(typeof w!="object"&&typeof w!="function"&&w!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,w,N,"setState")},X.prototype.forceUpdate=function(w){this.updater.enqueueForceUpdate(this,w,"forceUpdate")};function Z(){}Z.prototype=X.prototype;function te(w,N,re){this.props=w,this.context=N,this.refs=fe,this.updater=re||se}var oe=te.prototype=new Z;oe.constructor=te,he(oe,X.prototype),oe.isPureReactComponent=!0;var ce=Array.isArray,ie=Object.prototype.hasOwnProperty,je={current:null},de={key:!0,ref:!0,__self:!0,__source:!0};function Pe(w,N,re){var pe,be={},Oe=null,Ke=null;if(N!=null)for(pe in N.ref!==void 0&&(Ke=N.ref),N.key!==void 0&&(Oe=""+N.key),N)ie.call(N,pe)&&!de.hasOwnProperty(pe)&&(be[pe]=N[pe]);var qe=arguments.length-2;if(qe===1)be.children=re;else if(1<qe){for(var tt=Array(qe),Se=0;Se<qe;Se++)tt[Se]=arguments[Se+2];be.children=tt}if(w&&w.defaultProps)for(pe in qe=w.defaultProps,qe)be[pe]===void 0&&(be[pe]=qe[pe]);return{$$typeof:i,type:w,key:Oe,ref:Ke,props:be,_owner:je.current}}function Be(w,N){return{$$typeof:i,type:w.type,key:N,ref:w.ref,props:w.props,_owner:w._owner}}function Ye(w){return typeof w=="object"&&w!==null&&w.$$typeof===i}function We(w){var N={"=":"=0",":":"=2"};return"$"+w.replace(/[=:]/g,function(re){return N[re]})}var Ge=/\/+/g;function Te(w,N){return typeof w=="object"&&w!==null&&w.key!=null?We(""+w.key):N.toString(36)}function et(w,N,re,pe,be){var Oe=typeof w;(Oe==="undefined"||Oe==="boolean")&&(w=null);var Ke=!1;if(w===null)Ke=!0;else switch(Oe){case"string":case"number":Ke=!0;break;case"object":switch(w.$$typeof){case i:case p:Ke=!0}}if(Ke)return Ke=w,be=be(Ke),w=pe===""?"."+Te(Ke,0):pe,ce(be)?(re="",w!=null&&(re=w.replace(Ge,"$&/")+"/"),et(be,N,re,"",function(Se){return Se})):be!=null&&(Ye(be)&&(be=Be(be,re+(!be.key||Ke&&Ke.key===be.key?"":(""+be.key).replace(Ge,"$&/")+"/")+w)),N.push(be)),1;if(Ke=0,pe=pe===""?".":pe+":",ce(w))for(var qe=0;qe<w.length;qe++){Oe=w[qe];var tt=pe+Te(Oe,qe);Ke+=et(Oe,N,re,tt,be)}else if(tt=V(w),typeof tt=="function")for(w=tt.call(w),qe=0;!(Oe=w.next()).done;)Oe=Oe.value,tt=pe+Te(Oe,qe++),Ke+=et(Oe,N,re,tt,be);else if(Oe==="object")throw N=String(w),Error("Objects are not valid as a React child (found: "+(N==="[object Object]"?"object with keys {"+Object.keys(w).join(", ")+"}":N)+"). If you meant to render a collection of children, use an array instead.");return Ke}function lt(w,N,re){if(w==null)return w;var pe=[],be=0;return et(w,pe,"","",function(Oe){return N.call(re,Oe,be++)}),pe}function it(w){if(w._status===-1){var N=w._result;N=N(),N.then(function(re){(w._status===0||w._status===-1)&&(w._status=1,w._result=re)},function(re){(w._status===0||w._status===-1)&&(w._status=2,w._result=re)}),w._status===-1&&(w._status=0,w._result=N)}if(w._status===1)return w._result.default;throw w._result}var ae={current:null},G={transition:null},T={ReactCurrentDispatcher:ae,ReactCurrentBatchConfig:G,ReactCurrentOwner:je};function v(){throw Error("act(...) is not supported in production builds of React.")}return pt.Children={map:lt,forEach:function(w,N,re){lt(w,function(){N.apply(this,arguments)},re)},count:function(w){var N=0;return lt(w,function(){N++}),N},toArray:function(w){return lt(w,function(N){return N})||[]},only:function(w){if(!Ye(w))throw Error("React.Children.only expected to receive a single React element child.");return w}},pt.Component=X,pt.Fragment=f,pt.Profiler=C,pt.PureComponent=te,pt.StrictMode=x,pt.Suspense=S,pt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=T,pt.act=v,pt.cloneElement=function(w,N,re){if(w==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+w+".");var pe=he({},w.props),be=w.key,Oe=w.ref,Ke=w._owner;if(N!=null){if(N.ref!==void 0&&(Oe=N.ref,Ke=je.current),N.key!==void 0&&(be=""+N.key),w.type&&w.type.defaultProps)var qe=w.type.defaultProps;for(tt in N)ie.call(N,tt)&&!de.hasOwnProperty(tt)&&(pe[tt]=N[tt]===void 0&&qe!==void 0?qe[tt]:N[tt])}var tt=arguments.length-2;if(tt===1)pe.children=re;else if(1<tt){qe=Array(tt);for(var Se=0;Se<tt;Se++)qe[Se]=arguments[Se+2];pe.children=qe}return{$$typeof:i,type:w.type,key:be,ref:Oe,props:pe,_owner:Ke}},pt.createContext=function(w){return w={$$typeof:_,_currentValue:w,_currentValue2:w,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},w.Provider={$$typeof:y,_context:w},w.Consumer=w},pt.createElement=Pe,pt.createFactory=function(w){var N=Pe.bind(null,w);return N.type=w,N},pt.createRef=function(){return{current:null}},pt.forwardRef=function(w){return{$$typeof:E,render:w}},pt.isValidElement=Ye,pt.lazy=function(w){return{$$typeof:R,_payload:{_status:-1,_result:w},_init:it}},pt.memo=function(w,N){return{$$typeof:L,type:w,compare:N===void 0?null:N}},pt.startTransition=function(w){var N=G.transition;G.transition={};try{w()}finally{G.transition=N}},pt.unstable_act=v,pt.useCallback=function(w,N){return ae.current.useCallback(w,N)},pt.useContext=function(w){return ae.current.useContext(w)},pt.useDebugValue=function(){},pt.useDeferredValue=function(w){return ae.current.useDeferredValue(w)},pt.useEffect=function(w,N){return ae.current.useEffect(w,N)},pt.useId=function(){return ae.current.useId()},pt.useImperativeHandle=function(w,N,re){return ae.current.useImperativeHandle(w,N,re)},pt.useInsertionEffect=function(w,N){return ae.current.useInsertionEffect(w,N)},pt.useLayoutEffect=function(w,N){return ae.current.useLayoutEffect(w,N)},pt.useMemo=function(w,N){return ae.current.useMemo(w,N)},pt.useReducer=function(w,N,re){return ae.current.useReducer(w,N,re)},pt.useRef=function(w){return ae.current.useRef(w)},pt.useState=function(w){return ae.current.useState(w)},pt.useSyncExternalStore=function(w,N,re){return ae.current.useSyncExternalStore(w,N,re)},pt.useTransition=function(){return ae.current.useTransition()},pt.version="18.3.1",pt}var mf;function cc(){return mf||(mf=1,Uu.exports=Fh()),Uu.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gf;function zh(){if(gf)return La;gf=1;var i=cc(),p=Symbol.for("react.element"),f=Symbol.for("react.fragment"),x=Object.prototype.hasOwnProperty,C=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,y={key:!0,ref:!0,__self:!0,__source:!0};function _(E,S,L){var R,J={},V=null,se=null;L!==void 0&&(V=""+L),S.key!==void 0&&(V=""+S.key),S.ref!==void 0&&(se=S.ref);for(R in S)x.call(S,R)&&!y.hasOwnProperty(R)&&(J[R]=S[R]);if(E&&E.defaultProps)for(R in S=E.defaultProps,S)J[R]===void 0&&(J[R]=S[R]);return{$$typeof:p,type:E,key:V,ref:se,props:J,_owner:C.current}}return La.Fragment=f,La.jsx=_,La.jsxs=_,La}var xf;function Ih(){return xf||(xf=1,Bu.exports=zh()),Bu.exports}var n=Ih(),j=cc();const Nr=uc(j);var ai={},$u={exports:{}},Lr={},Ku={exports:{}},Vu={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yf;function Bh(){return yf||(yf=1,(function(i){function p(G,T){var v=G.length;G.push(T);e:for(;0<v;){var w=v-1>>>1,N=G[w];if(0<C(N,T))G[w]=T,G[v]=N,v=w;else break e}}function f(G){return G.length===0?null:G[0]}function x(G){if(G.length===0)return null;var T=G[0],v=G.pop();if(v!==T){G[0]=v;e:for(var w=0,N=G.length,re=N>>>1;w<re;){var pe=2*(w+1)-1,be=G[pe],Oe=pe+1,Ke=G[Oe];if(0>C(be,v))Oe<N&&0>C(Ke,be)?(G[w]=Ke,G[Oe]=v,w=Oe):(G[w]=be,G[pe]=v,w=pe);else if(Oe<N&&0>C(Ke,v))G[w]=Ke,G[Oe]=v,w=Oe;else break e}}return T}function C(G,T){var v=G.sortIndex-T.sortIndex;return v!==0?v:G.id-T.id}if(typeof performance=="object"&&typeof performance.now=="function"){var y=performance;i.unstable_now=function(){return y.now()}}else{var _=Date,E=_.now();i.unstable_now=function(){return _.now()-E}}var S=[],L=[],R=1,J=null,V=3,se=!1,he=!1,fe=!1,X=typeof setTimeout=="function"?setTimeout:null,Z=typeof clearTimeout=="function"?clearTimeout:null,te=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function oe(G){for(var T=f(L);T!==null;){if(T.callback===null)x(L);else if(T.startTime<=G)x(L),T.sortIndex=T.expirationTime,p(S,T);else break;T=f(L)}}function ce(G){if(fe=!1,oe(G),!he)if(f(S)!==null)he=!0,it(ie);else{var T=f(L);T!==null&&ae(ce,T.startTime-G)}}function ie(G,T){he=!1,fe&&(fe=!1,Z(Pe),Pe=-1),se=!0;var v=V;try{for(oe(T),J=f(S);J!==null&&(!(J.expirationTime>T)||G&&!We());){var w=J.callback;if(typeof w=="function"){J.callback=null,V=J.priorityLevel;var N=w(J.expirationTime<=T);T=i.unstable_now(),typeof N=="function"?J.callback=N:J===f(S)&&x(S),oe(T)}else x(S);J=f(S)}if(J!==null)var re=!0;else{var pe=f(L);pe!==null&&ae(ce,pe.startTime-T),re=!1}return re}finally{J=null,V=v,se=!1}}var je=!1,de=null,Pe=-1,Be=5,Ye=-1;function We(){return!(i.unstable_now()-Ye<Be)}function Ge(){if(de!==null){var G=i.unstable_now();Ye=G;var T=!0;try{T=de(!0,G)}finally{T?Te():(je=!1,de=null)}}else je=!1}var Te;if(typeof te=="function")Te=function(){te(Ge)};else if(typeof MessageChannel<"u"){var et=new MessageChannel,lt=et.port2;et.port1.onmessage=Ge,Te=function(){lt.postMessage(null)}}else Te=function(){X(Ge,0)};function it(G){de=G,je||(je=!0,Te())}function ae(G,T){Pe=X(function(){G(i.unstable_now())},T)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(G){G.callback=null},i.unstable_continueExecution=function(){he||se||(he=!0,it(ie))},i.unstable_forceFrameRate=function(G){0>G||125<G?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Be=0<G?Math.floor(1e3/G):5},i.unstable_getCurrentPriorityLevel=function(){return V},i.unstable_getFirstCallbackNode=function(){return f(S)},i.unstable_next=function(G){switch(V){case 1:case 2:case 3:var T=3;break;default:T=V}var v=V;V=T;try{return G()}finally{V=v}},i.unstable_pauseExecution=function(){},i.unstable_requestPaint=function(){},i.unstable_runWithPriority=function(G,T){switch(G){case 1:case 2:case 3:case 4:case 5:break;default:G=3}var v=V;V=G;try{return T()}finally{V=v}},i.unstable_scheduleCallback=function(G,T,v){var w=i.unstable_now();switch(typeof v=="object"&&v!==null?(v=v.delay,v=typeof v=="number"&&0<v?w+v:w):v=w,G){case 1:var N=-1;break;case 2:N=250;break;case 5:N=1073741823;break;case 4:N=1e4;break;default:N=5e3}return N=v+N,G={id:R++,callback:T,priorityLevel:G,startTime:v,expirationTime:N,sortIndex:-1},v>w?(G.sortIndex=v,p(L,G),f(S)===null&&G===f(L)&&(fe?(Z(Pe),Pe=-1):fe=!0,ae(ce,v-w))):(G.sortIndex=N,p(S,G),he||se||(he=!0,it(ie))),G},i.unstable_shouldYield=We,i.unstable_wrapCallback=function(G){var T=V;return function(){var v=V;V=T;try{return G.apply(this,arguments)}finally{V=v}}}})(Vu)),Vu}var vf;function Uh(){return vf||(vf=1,Ku.exports=Bh()),Ku.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bf;function $h(){if(bf)return Lr;bf=1;var i=cc(),p=Uh();function f(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var x=new Set,C={};function y(e,t){_(e,t),_(e+"Capture",t)}function _(e,t){for(C[e]=t,e=0;e<t.length;e++)x.add(t[e])}var E=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),S=Object.prototype.hasOwnProperty,L=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,R={},J={};function V(e){return S.call(J,e)?!0:S.call(R,e)?!1:L.test(e)?J[e]=!0:(R[e]=!0,!1)}function se(e,t,r,o){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return o?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function he(e,t,r,o){if(t===null||typeof t>"u"||se(e,t,r,o))return!0;if(o)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function fe(e,t,r,o,l,c,g){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=o,this.attributeNamespace=l,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=c,this.removeEmptyString=g}var X={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){X[e]=new fe(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];X[t]=new fe(t,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){X[e]=new fe(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){X[e]=new fe(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){X[e]=new fe(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){X[e]=new fe(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){X[e]=new fe(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){X[e]=new fe(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){X[e]=new fe(e,5,!1,e.toLowerCase(),null,!1,!1)});var Z=/[\-:]([a-z])/g;function te(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Z,te);X[t]=new fe(t,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Z,te);X[t]=new fe(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Z,te);X[t]=new fe(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){X[e]=new fe(e,1,!1,e.toLowerCase(),null,!1,!1)}),X.xlinkHref=new fe("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){X[e]=new fe(e,1,!1,e.toLowerCase(),null,!0,!0)});function oe(e,t,r,o){var l=X.hasOwnProperty(t)?X[t]:null;(l!==null?l.type!==0:o||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(he(t,r,l,o)&&(r=null),o||l===null?V(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):l.mustUseProperty?e[l.propertyName]=r===null?l.type===3?!1:"":r:(t=l.attributeName,o=l.attributeNamespace,r===null?e.removeAttribute(t):(l=l.type,r=l===3||l===4&&r===!0?"":""+r,o?e.setAttributeNS(o,t,r):e.setAttribute(t,r))))}var ce=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ie=Symbol.for("react.element"),je=Symbol.for("react.portal"),de=Symbol.for("react.fragment"),Pe=Symbol.for("react.strict_mode"),Be=Symbol.for("react.profiler"),Ye=Symbol.for("react.provider"),We=Symbol.for("react.context"),Ge=Symbol.for("react.forward_ref"),Te=Symbol.for("react.suspense"),et=Symbol.for("react.suspense_list"),lt=Symbol.for("react.memo"),it=Symbol.for("react.lazy"),ae=Symbol.for("react.offscreen"),G=Symbol.iterator;function T(e){return e===null||typeof e!="object"?null:(e=G&&e[G]||e["@@iterator"],typeof e=="function"?e:null)}var v=Object.assign,w;function N(e){if(w===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);w=t&&t[1]||""}return`
`+w+e}var re=!1;function pe(e,t){if(!e||re)return"";re=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(ee){var o=ee}Reflect.construct(e,[],t)}else{try{t.call()}catch(ee){o=ee}e.call(t.prototype)}else{try{throw Error()}catch(ee){o=ee}e()}}catch(ee){if(ee&&o&&typeof ee.stack=="string"){for(var l=ee.stack.split(`
`),c=o.stack.split(`
`),g=l.length-1,P=c.length-1;1<=g&&0<=P&&l[g]!==c[P];)P--;for(;1<=g&&0<=P;g--,P--)if(l[g]!==c[P]){if(g!==1||P!==1)do if(g--,P--,0>P||l[g]!==c[P]){var A=`
`+l[g].replace(" at new "," at ");return e.displayName&&A.includes("<anonymous>")&&(A=A.replace("<anonymous>",e.displayName)),A}while(1<=g&&0<=P);break}}}finally{re=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?N(e):""}function be(e){switch(e.tag){case 5:return N(e.type);case 16:return N("Lazy");case 13:return N("Suspense");case 19:return N("SuspenseList");case 0:case 2:case 15:return e=pe(e.type,!1),e;case 11:return e=pe(e.type.render,!1),e;case 1:return e=pe(e.type,!0),e;default:return""}}function Oe(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case de:return"Fragment";case je:return"Portal";case Be:return"Profiler";case Pe:return"StrictMode";case Te:return"Suspense";case et:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case We:return(e.displayName||"Context")+".Consumer";case Ye:return(e._context.displayName||"Context")+".Provider";case Ge:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case lt:return t=e.displayName||null,t!==null?t:Oe(e.type)||"Memo";case it:t=e._payload,e=e._init;try{return Oe(e(t))}catch{}}return null}function Ke(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Oe(t);case 8:return t===Pe?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function qe(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function tt(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Se(e){var t=tt(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),o=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var l=r.get,c=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return l.call(this)},set:function(g){o=""+g,c.call(this,g)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return o},setValue:function(g){o=""+g},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Ht(e){e._valueTracker||(e._valueTracker=Se(e))}function ct(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),o="";return e&&(o=tt(e)?e.checked?"true":"false":e.value),e=o,e!==r?(t.setValue(e),!0):!1}function Mt(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function fr(e,t){var r=t.checked;return v({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function Me(e,t){var r=t.defaultValue==null?"":t.defaultValue,o=t.checked!=null?t.checked:t.defaultChecked;r=qe(t.value!=null?t.value:r),e._wrapperState={initialChecked:o,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Vt(e,t){t=t.checked,t!=null&&oe(e,"checked",t,!1)}function Cr(e,t){Vt(e,t);var r=qe(t.value),o=t.type;if(r!=null)o==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(o==="submit"||o==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?_r(e,t.type,r):t.hasOwnProperty("defaultValue")&&_r(e,t.type,qe(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Mr(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var o=t.type;if(!(o!=="submit"&&o!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function _r(e,t,r){(t!=="number"||Mt(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Xt=Array.isArray;function Nt(e,t,r,o){if(e=e.options,t){t={};for(var l=0;l<r.length;l++)t["$"+r[l]]=!0;for(r=0;r<e.length;r++)l=t.hasOwnProperty("$"+e[r].value),e[r].selected!==l&&(e[r].selected=l),l&&o&&(e[r].defaultSelected=!0)}else{for(r=""+qe(r),t=null,l=0;l<e.length;l++){if(e[l].value===r){e[l].selected=!0,o&&(e[l].defaultSelected=!0);return}t!==null||e[l].disabled||(t=e[l])}t!==null&&(t.selected=!0)}}function we(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(f(91));return v({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Ze(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(f(92));if(Xt(r)){if(1<r.length)throw Error(f(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:qe(r)}}function Ct(e,t){var r=qe(t.value),o=qe(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),o!=null&&(e.defaultValue=""+o)}function ft(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function rt(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ft(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?rt(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Tt,Qt=(function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,o,l){MSApp.execUnsafeLocalFunction(function(){return e(t,r,o,l)})}:e})(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Tt=Tt||document.createElement("div"),Tt.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Tt.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function vt(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var $t={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},pr=["Webkit","ms","Moz","O"];Object.keys($t).forEach(function(e){pr.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),$t[t]=$t[e]})});function Er(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||$t.hasOwnProperty(e)&&$t[e]?(""+t).trim():t+"px"}function Re(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var o=r.indexOf("--")===0,l=Er(r,t[r],o);r==="float"&&(r="cssFloat"),o?e.setProperty(r,l):e[r]=l}}var nt=v({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ce(e,t){if(t){if(nt[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(f(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(f(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(f(61))}if(t.style!=null&&typeof t.style!="object")throw Error(f(62))}}function W(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ne=null;function Fe(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var ue=null,ut=null,st=null;function Rt(e){if(e=va(e)){if(typeof ue!="function")throw Error(f(280));var t=e.stateNode;t&&(t=wl(t),ue(e.stateNode,e.type,t))}}function Wt(e){ut?st?st.push(e):st=[e]:ut=e}function co(){if(ut){var e=ut,t=st;if(st=ut=null,Rt(e),t)for(e=0;e<t.length;e++)Rt(t[e])}}function Qa(e,t){return e(t)}function Ya(){}var hn=!1;function Pn(e,t,r){if(hn)return e(t,r);hn=!0;try{return Qa(e,t,r)}finally{hn=!1,(ut!==null||st!==null)&&(Ya(),co())}}function Tn(e,t){var r=e.stateNode;if(r===null)return null;var o=wl(r);if(o===null)return null;r=o[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(o=!o.disabled)||(e=e.type,o=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!o;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(f(231,t,typeof r));return r}var es=!1;if(E)try{var St={};Object.defineProperty(St,"passive",{get:function(){es=!0}}),window.addEventListener("test",St,St),window.removeEventListener("test",St,St)}catch{es=!1}function Yt(e,t,r,o,l,c,g,P,A){var ee=Array.prototype.slice.call(arguments,3);try{t.apply(r,ee)}catch(ye){this.onError(ye)}}var Ds=!1,Rn=null,Dn=!1,ts=null,ki={onError:function(e){Ds=!0,Rn=e}};function mn(e,t,r,o,l,c,g,P,A){Ds=!1,Rn=null,Yt.apply(ki,arguments)}function rs(e,t,r,o,l,c,g,P,A){if(mn.apply(this,arguments),Ds){if(Ds){var ee=Rn;Ds=!1,Rn=null}else throw Error(f(198));Dn||(Dn=!0,ts=ee)}}function hr(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,(t.flags&4098)!==0&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function As(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Ga(e){if(hr(e)!==e)throw Error(f(188))}function gn(e){var t=e.alternate;if(!t){if(t=hr(e),t===null)throw Error(f(188));return t!==e?null:e}for(var r=e,o=t;;){var l=r.return;if(l===null)break;var c=l.alternate;if(c===null){if(o=l.return,o!==null){r=o;continue}break}if(l.child===c.child){for(c=l.child;c;){if(c===r)return Ga(l),e;if(c===o)return Ga(l),t;c=c.sibling}throw Error(f(188))}if(r.return!==o.return)r=l,o=c;else{for(var g=!1,P=l.child;P;){if(P===r){g=!0,r=l,o=c;break}if(P===o){g=!0,o=l,r=c;break}P=P.sibling}if(!g){for(P=c.child;P;){if(P===r){g=!0,r=c,o=l;break}if(P===o){g=!0,o=c,r=l;break}P=P.sibling}if(!g)throw Error(f(189))}}if(r.alternate!==o)throw Error(f(190))}if(r.tag!==3)throw Error(f(188));return r.stateNode.current===r?e:t}function Go(e){return e=gn(e),e!==null?xn(e):null}function xn(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=xn(e);if(t!==null)return t;e=e.sibling}return null}var Xo=p.unstable_scheduleCallback,fo=p.unstable_cancelCallback,zt=p.unstable_shouldYield,An=p.unstable_requestPaint,jt=p.unstable_now,Xa=p.unstable_getCurrentPriorityLevel,yn=p.unstable_ImmediatePriority,Ls=p.unstable_UserBlockingPriority,ns=p.unstable_NormalPriority,Jo=p.unstable_LowPriority,vn=p.unstable_IdlePriority,Os=null,vr=null;function Ja(e){if(vr&&typeof vr.onCommitFiberRoot=="function")try{vr.onCommitFiberRoot(Os,e,void 0,(e.current.flags&128)===128)}catch{}}var ot=Math.clz32?Math.clz32:po,Za=Math.log,el=Math.LN2;function po(e){return e>>>=0,e===0?32:31-(Za(e)/el|0)|0}var bn=64,Ms=4194304;function ss(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Fs(e,t){var r=e.pendingLanes;if(r===0)return 0;var o=0,l=e.suspendedLanes,c=e.pingedLanes,g=r&268435455;if(g!==0){var P=g&~l;P!==0?o=ss(P):(c&=g,c!==0&&(o=ss(c)))}else g=r&~l,g!==0?o=ss(g):c!==0&&(o=ss(c));if(o===0)return 0;if(t!==0&&t!==o&&(t&l)===0&&(l=o&-o,c=t&-t,l>=c||l===16&&(c&4194240)!==0))return t;if((o&4)!==0&&(o|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=o;0<t;)r=31-ot(t),l=1<<r,o|=e[r],t&=~l;return o}function _t(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function zs(e,t){for(var r=e.suspendedLanes,o=e.pingedLanes,l=e.expirationTimes,c=e.pendingLanes;0<c;){var g=31-ot(c),P=1<<g,A=l[g];A===-1?((P&r)===0||(P&o)!==0)&&(l[g]=_t(P,t)):A<=t&&(e.expiredLanes|=P),c&=~P}}function Ln(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function On(){var e=bn;return bn<<=1,(bn&4194240)===0&&(bn=64),e}function Is(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Mn(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-ot(t),e[t]=r}function ho(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var o=e.eventTimes;for(e=e.expirationTimes;0<r;){var l=31-ot(r),c=1<<l;t[l]=0,o[l]=-1,e[l]=-1,r&=~c}}function mo(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var o=31-ot(r),l=1<<o;l&t|e[o]&t&&(e[o]|=t),r&=~l}}var xt=0;function Zo(e){return e&=-e,1<e?4<e?(e&268435455)!==0?16:536870912:4:1}var tl,mt,ea,rl,nl,ir=!1,Jr=[],Fr=null,ur=null,Zr=null,os=new Map,Lt=new Map,Jt=[],Bs="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function as(e,t){switch(e){case"focusin":case"focusout":Fr=null;break;case"dragenter":case"dragleave":ur=null;break;case"mouseover":case"mouseout":Zr=null;break;case"pointerover":case"pointerout":os.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Lt.delete(t.pointerId)}}function Fn(e,t,r,o,l,c){return e===null||e.nativeEvent!==c?(e={blockedOn:t,domEventName:r,eventSystemFlags:o,nativeEvent:c,targetContainers:[l]},t!==null&&(t=va(t),t!==null&&mt(t)),e):(e.eventSystemFlags|=o,t=e.targetContainers,l!==null&&t.indexOf(l)===-1&&t.push(l),e)}function wn(e,t,r,o,l){switch(t){case"focusin":return Fr=Fn(Fr,e,t,r,o,l),!0;case"dragenter":return ur=Fn(ur,e,t,r,o,l),!0;case"mouseover":return Zr=Fn(Zr,e,t,r,o,l),!0;case"pointerover":var c=l.pointerId;return os.set(c,Fn(os.get(c)||null,e,t,r,o,l)),!0;case"gotpointercapture":return c=l.pointerId,Lt.set(c,Fn(Lt.get(c)||null,e,t,r,o,l)),!0}return!1}function sl(e){var t=Qs(e.target);if(t!==null){var r=hr(t);if(r!==null){if(t=r.tag,t===13){if(t=As(r),t!==null){e.blockedOn=t,nl(e.priority,function(){ea(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function br(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=ls(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var o=new r.constructor(r.type,r);ne=o,r.target.dispatchEvent(o),ne=null}else return t=va(r),t!==null&&mt(t),e.blockedOn=r,!1;t.shift()}return!0}function go(e,t,r){br(e)&&r.delete(t)}function ol(){ir=!1,Fr!==null&&br(Fr)&&(Fr=null),ur!==null&&br(ur)&&(ur=null),Zr!==null&&br(Zr)&&(Zr=null),os.forEach(go),Lt.forEach(go)}function zn(e,t){e.blockedOn===t&&(e.blockedOn=null,ir||(ir=!0,p.unstable_scheduleCallback(p.unstable_NormalPriority,ol)))}function en(e){function t(l){return zn(l,e)}if(0<Jr.length){zn(Jr[0],e);for(var r=1;r<Jr.length;r++){var o=Jr[r];o.blockedOn===e&&(o.blockedOn=null)}}for(Fr!==null&&zn(Fr,e),ur!==null&&zn(ur,e),Zr!==null&&zn(Zr,e),os.forEach(t),Lt.forEach(t),r=0;r<Jt.length;r++)o=Jt[r],o.blockedOn===e&&(o.blockedOn=null);for(;0<Jt.length&&(r=Jt[0],r.blockedOn===null);)sl(r),r.blockedOn===null&&Jt.shift()}var jn=ce.ReactCurrentBatchConfig,Us=!0;function Ni(e,t,r,o){var l=xt,c=jn.transition;jn.transition=null;try{xt=1,ta(e,t,r,o)}finally{xt=l,jn.transition=c}}function $s(e,t,r,o){var l=xt,c=jn.transition;jn.transition=null;try{xt=4,ta(e,t,r,o)}finally{xt=l,jn.transition=c}}function ta(e,t,r,o){if(Us){var l=ls(e,t,r,o);if(l===null)Ti(e,t,o,xo,r),as(e,o);else if(wn(l,e,t,r,o))o.stopPropagation();else if(as(e,o),t&4&&-1<Bs.indexOf(e)){for(;l!==null;){var c=va(l);if(c!==null&&tl(c),c=ls(e,t,r,o),c===null&&Ti(e,t,o,xo,r),c===l)break;l=c}l!==null&&o.stopPropagation()}else Ti(e,t,o,null,r)}}var xo=null;function ls(e,t,r,o){if(xo=null,e=Fe(o),e=Qs(e),e!==null)if(t=hr(e),t===null)e=null;else if(r=t.tag,r===13){if(e=As(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return xo=e,null}function Ks(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Xa()){case yn:return 1;case Ls:return 4;case ns:case Jo:return 16;case vn:return 536870912;default:return 16}default:return 16}}var Kr=null,ra=null,yo=null;function al(){if(yo)return yo;var e,t=ra,r=t.length,o,l="value"in Kr?Kr.value:Kr.textContent,c=l.length;for(e=0;e<r&&t[e]===l[e];e++);var g=r-e;for(o=1;o<=g&&t[r-o]===l[c-o];o++);return yo=l.slice(e,1<o?1-o:void 0)}function is(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function us(){return!0}function na(){return!1}function nr(e){function t(r,o,l,c,g){this._reactName=r,this._targetInst=l,this.type=o,this.nativeEvent=c,this.target=g,this.currentTarget=null;for(var P in e)e.hasOwnProperty(P)&&(r=e[P],this[P]=r?r(c):c[P]);return this.isDefaultPrevented=(c.defaultPrevented!=null?c.defaultPrevented:c.returnValue===!1)?us:na,this.isPropagationStopped=na,this}return v(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=us)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=us)},persist:function(){},isPersistent:us}),t}var tn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},cs=nr(tn),ds=v({},tn,{view:0,detail:0}),Si=nr(ds),kn,Vs,In,fs=v({},ds,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:No,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==In&&(In&&e.type==="mousemove"?(kn=e.screenX-In.screenX,Vs=e.screenY-In.screenY):Vs=kn=0,In=e),kn)},movementY:function(e){return"movementY"in e?e.movementY:Vs}}),vo=nr(fs),sr=v({},fs,{dataTransfer:0}),Ws=nr(sr),qs=v({},ds,{relatedTarget:0}),bo=nr(qs),wo=v({},tn,{animationName:0,elapsedTime:0,pseudoElement:0}),ll=nr(wo),il=v({},tn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),jo=nr(il),sa=v({},tn,{data:0}),Nn=nr(sa),oa={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},aa={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ko={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function la(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=ko[e])?!!t[e]:!1}function No(){return la}var Ci=v({},ds,{key:function(e){if(e.key){var t=oa[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=is(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?aa[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:No,charCode:function(e){return e.type==="keypress"?is(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?is(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),ia=nr(Ci),So=v({},fs,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ul=nr(So),ua=v({},ds,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:No}),ca=nr(ua),_i=v({},tn,{propertyName:0,elapsedTime:0,pseudoElement:0}),cl=nr(_i),Ei=v({},fs,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),dl=nr(Ei),fl=[9,13,27,32],da=E&&"CompositionEvent"in window,ps=null;E&&"documentMode"in document&&(ps=document.documentMode);var fa=E&&"TextEvent"in window&&!ps,pa=E&&(!da||ps&&8<ps&&11>=ps),ha=" ",pl=!1;function hl(e,t){switch(e){case"keyup":return fl.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ml(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var rn=!1;function nn(e,t){switch(e){case"compositionend":return ml(t);case"keypress":return t.which!==32?null:(pl=!0,ha);case"textInput":return e=t.data,e===ha&&pl?null:e;default:return null}}function It(e,t){if(rn)return e==="compositionend"||!da&&hl(e,t)?(e=al(),yo=ra=Kr=null,rn=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return pa&&t.locale!=="ko"?null:t.data;default:return null}}var Co={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Bn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Co[e.type]:t==="textarea"}function gl(e,t,r,o){Wt(o),t=yl(t,"onChange"),0<t.length&&(r=new cs("onChange","change",null,r,o),e.push({event:r,listeners:t}))}var Un=null,hs=null;function $n(e){Pc(e,0)}function ms(e){var t=To(e);if(ct(t))return e}function gs(e,t){if(e==="change")return t}var sn=!1;if(E){var _o;if(E){var s="oninput"in document;if(!s){var a=document.createElement("div");a.setAttribute("oninput","return;"),s=typeof a.oninput=="function"}_o=s}else _o=!1;sn=_o&&(!document.documentMode||9<document.documentMode)}function u(){Un&&(Un.detachEvent("onpropertychange",d),hs=Un=null)}function d(e){if(e.propertyName==="value"&&ms(hs)){var t=[];gl(t,hs,e,Fe(e)),Pn($n,t)}}function h(e,t,r){e==="focusin"?(u(),Un=t,hs=r,Un.attachEvent("onpropertychange",d)):e==="focusout"&&u()}function m(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return ms(hs)}function b(e,t){if(e==="click")return ms(t)}function k(e,t){if(e==="input"||e==="change")return ms(t)}function z(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var $=typeof Object.is=="function"?Object.is:z;function O(e,t){if($(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),o=Object.keys(t);if(r.length!==o.length)return!1;for(o=0;o<r.length;o++){var l=r[o];if(!S.call(t,l)||!$(e[l],t[l]))return!1}return!0}function D(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function I(e,t){var r=D(e);e=0;for(var o;r;){if(r.nodeType===3){if(o=e+r.textContent.length,e<=t&&o>=t)return{node:r,offset:t-e};e=o}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=D(r)}}function B(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?B(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function F(){for(var e=window,t=Mt();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Mt(e.document)}return t}function M(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function H(e){var t=F(),r=e.focusedElem,o=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&B(r.ownerDocument.documentElement,r)){if(o!==null&&M(r)){if(t=o.start,e=o.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var l=r.textContent.length,c=Math.min(o.start,l);o=o.end===void 0?c:Math.min(o.end,l),!e.extend&&c>o&&(l=o,o=c,c=l),l=I(r,c);var g=I(r,o);l&&g&&(e.rangeCount!==1||e.anchorNode!==l.node||e.anchorOffset!==l.offset||e.focusNode!==g.node||e.focusOffset!==g.offset)&&(t=t.createRange(),t.setStart(l.node,l.offset),e.removeAllRanges(),c>o?(e.addRange(t),e.extend(g.node,g.offset)):(t.setEnd(g.node,g.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Y=E&&"documentMode"in document&&11>=document.documentMode,K=null,le=null,me=null,_e=!1;function Ee(e,t,r){var o=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;_e||K==null||K!==Mt(o)||(o=K,"selectionStart"in o&&M(o)?o={start:o.selectionStart,end:o.selectionEnd}:(o=(o.ownerDocument&&o.ownerDocument.defaultView||window).getSelection(),o={anchorNode:o.anchorNode,anchorOffset:o.anchorOffset,focusNode:o.focusNode,focusOffset:o.focusOffset}),me&&O(me,o)||(me=o,o=yl(le,"onSelect"),0<o.length&&(t=new cs("onSelect","select",null,t,r),e.push({event:t,listeners:o}),t.target=K)))}function xe(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Ae={animationend:xe("Animation","AnimationEnd"),animationiteration:xe("Animation","AnimationIteration"),animationstart:xe("Animation","AnimationStart"),transitionend:xe("Transition","TransitionEnd")},De={},ke={};E&&(ke=document.createElement("div").style,"AnimationEvent"in window||(delete Ae.animationend.animation,delete Ae.animationiteration.animation,delete Ae.animationstart.animation),"TransitionEvent"in window||delete Ae.transitionend.transition);function Le(e){if(De[e])return De[e];if(!Ae[e])return e;var t=Ae[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in ke)return De[e]=t[r];return e}var ht=Le("animationend"),gt=Le("animationiteration"),Qe=Le("animationstart"),dt=Le("transitionend"),Et=new Map,wr="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function kt(e,t){Et.set(e,t),y(t,[e])}for(var on=0;on<wr.length;on++){var Hs=wr[on],Wp=Hs.toLowerCase(),qp=Hs[0].toUpperCase()+Hs.slice(1);kt(Wp,"on"+qp)}kt(ht,"onAnimationEnd"),kt(gt,"onAnimationIteration"),kt(Qe,"onAnimationStart"),kt("dblclick","onDoubleClick"),kt("focusin","onFocus"),kt("focusout","onBlur"),kt(dt,"onTransitionEnd"),_("onMouseEnter",["mouseout","mouseover"]),_("onMouseLeave",["mouseout","mouseover"]),_("onPointerEnter",["pointerout","pointerover"]),_("onPointerLeave",["pointerout","pointerover"]),y("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),y("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),y("onBeforeInput",["compositionend","keypress","textInput","paste"]),y("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),y("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),y("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ma="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Hp=new Set("cancel close invalid load scroll toggle".split(" ").concat(ma));function Ec(e,t,r){var o=e.type||"unknown-event";e.currentTarget=r,rs(o,t,void 0,e),e.currentTarget=null}function Pc(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var o=e[r],l=o.event;o=o.listeners;e:{var c=void 0;if(t)for(var g=o.length-1;0<=g;g--){var P=o[g],A=P.instance,ee=P.currentTarget;if(P=P.listener,A!==c&&l.isPropagationStopped())break e;Ec(l,P,ee),c=A}else for(g=0;g<o.length;g++){if(P=o[g],A=P.instance,ee=P.currentTarget,P=P.listener,A!==c&&l.isPropagationStopped())break e;Ec(l,P,ee),c=A}}}if(Dn)throw e=ts,Dn=!1,ts=null,e}function Dt(e,t){var r=t[Mi];r===void 0&&(r=t[Mi]=new Set);var o=e+"__bubble";r.has(o)||(Tc(t,e,2,!1),r.add(o))}function Pi(e,t,r){var o=0;t&&(o|=4),Tc(r,e,o,t)}var xl="_reactListening"+Math.random().toString(36).slice(2);function ga(e){if(!e[xl]){e[xl]=!0,x.forEach(function(r){r!=="selectionchange"&&(Hp.has(r)||Pi(r,!1,e),Pi(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[xl]||(t[xl]=!0,Pi("selectionchange",!1,t))}}function Tc(e,t,r,o){switch(Ks(t)){case 1:var l=Ni;break;case 4:l=$s;break;default:l=ta}r=l.bind(null,t,r,e),l=void 0,!es||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(l=!0),o?l!==void 0?e.addEventListener(t,r,{capture:!0,passive:l}):e.addEventListener(t,r,!0):l!==void 0?e.addEventListener(t,r,{passive:l}):e.addEventListener(t,r,!1)}function Ti(e,t,r,o,l){var c=o;if((t&1)===0&&(t&2)===0&&o!==null)e:for(;;){if(o===null)return;var g=o.tag;if(g===3||g===4){var P=o.stateNode.containerInfo;if(P===l||P.nodeType===8&&P.parentNode===l)break;if(g===4)for(g=o.return;g!==null;){var A=g.tag;if((A===3||A===4)&&(A=g.stateNode.containerInfo,A===l||A.nodeType===8&&A.parentNode===l))return;g=g.return}for(;P!==null;){if(g=Qs(P),g===null)return;if(A=g.tag,A===5||A===6){o=c=g;continue e}P=P.parentNode}}o=o.return}Pn(function(){var ee=c,ye=Fe(r),ve=[];e:{var ge=Et.get(e);if(ge!==void 0){var ze=cs,Ue=e;switch(e){case"keypress":if(is(r)===0)break e;case"keydown":case"keyup":ze=ia;break;case"focusin":Ue="focus",ze=bo;break;case"focusout":Ue="blur",ze=bo;break;case"beforeblur":case"afterblur":ze=bo;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ze=vo;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ze=Ws;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ze=ca;break;case ht:case gt:case Qe:ze=ll;break;case dt:ze=cl;break;case"scroll":ze=Si;break;case"wheel":ze=dl;break;case"copy":case"cut":case"paste":ze=jo;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ze=ul}var $e=(t&4)!==0,qt=!$e&&e==="scroll",q=$e?ge!==null?ge+"Capture":null:ge;$e=[];for(var U=ee,Q;U!==null;){Q=U;var Ne=Q.stateNode;if(Q.tag===5&&Ne!==null&&(Q=Ne,q!==null&&(Ne=Tn(U,q),Ne!=null&&$e.push(xa(U,Ne,Q)))),qt)break;U=U.return}0<$e.length&&(ge=new ze(ge,Ue,null,r,ye),ve.push({event:ge,listeners:$e}))}}if((t&7)===0){e:{if(ge=e==="mouseover"||e==="pointerover",ze=e==="mouseout"||e==="pointerout",ge&&r!==ne&&(Ue=r.relatedTarget||r.fromElement)&&(Qs(Ue)||Ue[Kn]))break e;if((ze||ge)&&(ge=ye.window===ye?ye:(ge=ye.ownerDocument)?ge.defaultView||ge.parentWindow:window,ze?(Ue=r.relatedTarget||r.toElement,ze=ee,Ue=Ue?Qs(Ue):null,Ue!==null&&(qt=hr(Ue),Ue!==qt||Ue.tag!==5&&Ue.tag!==6)&&(Ue=null)):(ze=null,Ue=ee),ze!==Ue)){if($e=vo,Ne="onMouseLeave",q="onMouseEnter",U="mouse",(e==="pointerout"||e==="pointerover")&&($e=ul,Ne="onPointerLeave",q="onPointerEnter",U="pointer"),qt=ze==null?ge:To(ze),Q=Ue==null?ge:To(Ue),ge=new $e(Ne,U+"leave",ze,r,ye),ge.target=qt,ge.relatedTarget=Q,Ne=null,Qs(ye)===ee&&($e=new $e(q,U+"enter",Ue,r,ye),$e.target=Q,$e.relatedTarget=qt,Ne=$e),qt=Ne,ze&&Ue)t:{for($e=ze,q=Ue,U=0,Q=$e;Q;Q=Eo(Q))U++;for(Q=0,Ne=q;Ne;Ne=Eo(Ne))Q++;for(;0<U-Q;)$e=Eo($e),U--;for(;0<Q-U;)q=Eo(q),Q--;for(;U--;){if($e===q||q!==null&&$e===q.alternate)break t;$e=Eo($e),q=Eo(q)}$e=null}else $e=null;ze!==null&&Rc(ve,ge,ze,$e,!1),Ue!==null&&qt!==null&&Rc(ve,qt,Ue,$e,!0)}}e:{if(ge=ee?To(ee):window,ze=ge.nodeName&&ge.nodeName.toLowerCase(),ze==="select"||ze==="input"&&ge.type==="file")var He=gs;else if(Bn(ge))if(sn)He=k;else{He=m;var Xe=h}else(ze=ge.nodeName)&&ze.toLowerCase()==="input"&&(ge.type==="checkbox"||ge.type==="radio")&&(He=b);if(He&&(He=He(e,ee))){gl(ve,He,r,ye);break e}Xe&&Xe(e,ge,ee),e==="focusout"&&(Xe=ge._wrapperState)&&Xe.controlled&&ge.type==="number"&&_r(ge,"number",ge.value)}switch(Xe=ee?To(ee):window,e){case"focusin":(Bn(Xe)||Xe.contentEditable==="true")&&(K=Xe,le=ee,me=null);break;case"focusout":me=le=K=null;break;case"mousedown":_e=!0;break;case"contextmenu":case"mouseup":case"dragend":_e=!1,Ee(ve,r,ye);break;case"selectionchange":if(Y)break;case"keydown":case"keyup":Ee(ve,r,ye)}var Je;if(da)e:{switch(e){case"compositionstart":var at="onCompositionStart";break e;case"compositionend":at="onCompositionEnd";break e;case"compositionupdate":at="onCompositionUpdate";break e}at=void 0}else rn?hl(e,r)&&(at="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(at="onCompositionStart");at&&(pa&&r.locale!=="ko"&&(rn||at!=="onCompositionStart"?at==="onCompositionEnd"&&rn&&(Je=al()):(Kr=ye,ra="value"in Kr?Kr.value:Kr.textContent,rn=!0)),Xe=yl(ee,at),0<Xe.length&&(at=new Nn(at,e,null,r,ye),ve.push({event:at,listeners:Xe}),Je?at.data=Je:(Je=ml(r),Je!==null&&(at.data=Je)))),(Je=fa?nn(e,r):It(e,r))&&(ee=yl(ee,"onBeforeInput"),0<ee.length&&(ye=new Nn("onBeforeInput","beforeinput",null,r,ye),ve.push({event:ye,listeners:ee}),ye.data=Je))}Pc(ve,t)})}function xa(e,t,r){return{instance:e,listener:t,currentTarget:r}}function yl(e,t){for(var r=t+"Capture",o=[];e!==null;){var l=e,c=l.stateNode;l.tag===5&&c!==null&&(l=c,c=Tn(e,r),c!=null&&o.unshift(xa(e,c,l)),c=Tn(e,t),c!=null&&o.push(xa(e,c,l))),e=e.return}return o}function Eo(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Rc(e,t,r,o,l){for(var c=t._reactName,g=[];r!==null&&r!==o;){var P=r,A=P.alternate,ee=P.stateNode;if(A!==null&&A===o)break;P.tag===5&&ee!==null&&(P=ee,l?(A=Tn(r,c),A!=null&&g.unshift(xa(r,A,P))):l||(A=Tn(r,c),A!=null&&g.push(xa(r,A,P)))),r=r.return}g.length!==0&&e.push({event:t,listeners:g})}var Qp=/\r\n?/g,Yp=/\u0000|\uFFFD/g;function Dc(e){return(typeof e=="string"?e:""+e).replace(Qp,`
`).replace(Yp,"")}function vl(e,t,r){if(t=Dc(t),Dc(e)!==t&&r)throw Error(f(425))}function bl(){}var Ri=null,Di=null;function Ai(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Li=typeof setTimeout=="function"?setTimeout:void 0,Gp=typeof clearTimeout=="function"?clearTimeout:void 0,Ac=typeof Promise=="function"?Promise:void 0,Xp=typeof queueMicrotask=="function"?queueMicrotask:typeof Ac<"u"?function(e){return Ac.resolve(null).then(e).catch(Jp)}:Li;function Jp(e){setTimeout(function(){throw e})}function Oi(e,t){var r=t,o=0;do{var l=r.nextSibling;if(e.removeChild(r),l&&l.nodeType===8)if(r=l.data,r==="/$"){if(o===0){e.removeChild(l),en(t);return}o--}else r!=="$"&&r!=="$?"&&r!=="$!"||o++;r=l}while(r);en(t)}function xs(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Lc(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var Po=Math.random().toString(36).slice(2),Sn="__reactFiber$"+Po,ya="__reactProps$"+Po,Kn="__reactContainer$"+Po,Mi="__reactEvents$"+Po,Zp="__reactListeners$"+Po,eh="__reactHandles$"+Po;function Qs(e){var t=e[Sn];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Kn]||r[Sn]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=Lc(e);e!==null;){if(r=e[Sn])return r;e=Lc(e)}return t}e=r,r=e.parentNode}return null}function va(e){return e=e[Sn]||e[Kn],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function To(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(f(33))}function wl(e){return e[ya]||null}var Fi=[],Ro=-1;function ys(e){return{current:e}}function At(e){0>Ro||(e.current=Fi[Ro],Fi[Ro]=null,Ro--)}function Pt(e,t){Ro++,Fi[Ro]=e.current,e.current=t}var vs={},mr=ys(vs),Pr=ys(!1),Ys=vs;function Do(e,t){var r=e.type.contextTypes;if(!r)return vs;var o=e.stateNode;if(o&&o.__reactInternalMemoizedUnmaskedChildContext===t)return o.__reactInternalMemoizedMaskedChildContext;var l={},c;for(c in r)l[c]=t[c];return o&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=l),l}function Tr(e){return e=e.childContextTypes,e!=null}function jl(){At(Pr),At(mr)}function Oc(e,t,r){if(mr.current!==vs)throw Error(f(168));Pt(mr,t),Pt(Pr,r)}function Mc(e,t,r){var o=e.stateNode;if(t=t.childContextTypes,typeof o.getChildContext!="function")return r;o=o.getChildContext();for(var l in o)if(!(l in t))throw Error(f(108,Ke(e)||"Unknown",l));return v({},r,o)}function kl(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||vs,Ys=mr.current,Pt(mr,e),Pt(Pr,Pr.current),!0}function Fc(e,t,r){var o=e.stateNode;if(!o)throw Error(f(169));r?(e=Mc(e,t,Ys),o.__reactInternalMemoizedMergedChildContext=e,At(Pr),At(mr),Pt(mr,e)):At(Pr),Pt(Pr,r)}var Vn=null,Nl=!1,zi=!1;function zc(e){Vn===null?Vn=[e]:Vn.push(e)}function th(e){Nl=!0,zc(e)}function bs(){if(!zi&&Vn!==null){zi=!0;var e=0,t=xt;try{var r=Vn;for(xt=1;e<r.length;e++){var o=r[e];do o=o(!0);while(o!==null)}Vn=null,Nl=!1}catch(l){throw Vn!==null&&(Vn=Vn.slice(e+1)),Xo(yn,bs),l}finally{xt=t,zi=!1}}return null}var Ao=[],Lo=0,Sl=null,Cl=0,Vr=[],Wr=0,Gs=null,Wn=1,qn="";function Xs(e,t){Ao[Lo++]=Cl,Ao[Lo++]=Sl,Sl=e,Cl=t}function Ic(e,t,r){Vr[Wr++]=Wn,Vr[Wr++]=qn,Vr[Wr++]=Gs,Gs=e;var o=Wn;e=qn;var l=32-ot(o)-1;o&=~(1<<l),r+=1;var c=32-ot(t)+l;if(30<c){var g=l-l%5;c=(o&(1<<g)-1).toString(32),o>>=g,l-=g,Wn=1<<32-ot(t)+l|r<<l|o,qn=c+e}else Wn=1<<c|r<<l|o,qn=e}function Ii(e){e.return!==null&&(Xs(e,1),Ic(e,1,0))}function Bi(e){for(;e===Sl;)Sl=Ao[--Lo],Ao[Lo]=null,Cl=Ao[--Lo],Ao[Lo]=null;for(;e===Gs;)Gs=Vr[--Wr],Vr[Wr]=null,qn=Vr[--Wr],Vr[Wr]=null,Wn=Vr[--Wr],Vr[Wr]=null}var zr=null,Ir=null,Ot=!1,an=null;function Bc(e,t){var r=Yr(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function Uc(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,zr=e,Ir=xs(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,zr=e,Ir=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=Gs!==null?{id:Wn,overflow:qn}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Yr(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,zr=e,Ir=null,!0):!1;default:return!1}}function Ui(e){return(e.mode&1)!==0&&(e.flags&128)===0}function $i(e){if(Ot){var t=Ir;if(t){var r=t;if(!Uc(e,t)){if(Ui(e))throw Error(f(418));t=xs(r.nextSibling);var o=zr;t&&Uc(e,t)?Bc(o,r):(e.flags=e.flags&-4097|2,Ot=!1,zr=e)}}else{if(Ui(e))throw Error(f(418));e.flags=e.flags&-4097|2,Ot=!1,zr=e}}}function $c(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;zr=e}function _l(e){if(e!==zr)return!1;if(!Ot)return $c(e),Ot=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Ai(e.type,e.memoizedProps)),t&&(t=Ir)){if(Ui(e))throw Kc(),Error(f(418));for(;t;)Bc(e,t),t=xs(t.nextSibling)}if($c(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(f(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){Ir=xs(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}Ir=null}}else Ir=zr?xs(e.stateNode.nextSibling):null;return!0}function Kc(){for(var e=Ir;e;)e=xs(e.nextSibling)}function Oo(){Ir=zr=null,Ot=!1}function Ki(e){an===null?an=[e]:an.push(e)}var rh=ce.ReactCurrentBatchConfig;function ba(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(f(309));var o=r.stateNode}if(!o)throw Error(f(147,e));var l=o,c=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===c?t.ref:(t=function(g){var P=l.refs;g===null?delete P[c]:P[c]=g},t._stringRef=c,t)}if(typeof e!="string")throw Error(f(284));if(!r._owner)throw Error(f(290,e))}return e}function El(e,t){throw e=Object.prototype.toString.call(t),Error(f(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Vc(e){var t=e._init;return t(e._payload)}function Wc(e){function t(q,U){if(e){var Q=q.deletions;Q===null?(q.deletions=[U],q.flags|=16):Q.push(U)}}function r(q,U){if(!e)return null;for(;U!==null;)t(q,U),U=U.sibling;return null}function o(q,U){for(q=new Map;U!==null;)U.key!==null?q.set(U.key,U):q.set(U.index,U),U=U.sibling;return q}function l(q,U){return q=Es(q,U),q.index=0,q.sibling=null,q}function c(q,U,Q){return q.index=Q,e?(Q=q.alternate,Q!==null?(Q=Q.index,Q<U?(q.flags|=2,U):Q):(q.flags|=2,U)):(q.flags|=1048576,U)}function g(q){return e&&q.alternate===null&&(q.flags|=2),q}function P(q,U,Q,Ne){return U===null||U.tag!==6?(U=Lu(Q,q.mode,Ne),U.return=q,U):(U=l(U,Q),U.return=q,U)}function A(q,U,Q,Ne){var He=Q.type;return He===de?ye(q,U,Q.props.children,Ne,Q.key):U!==null&&(U.elementType===He||typeof He=="object"&&He!==null&&He.$$typeof===it&&Vc(He)===U.type)?(Ne=l(U,Q.props),Ne.ref=ba(q,U,Q),Ne.return=q,Ne):(Ne=Jl(Q.type,Q.key,Q.props,null,q.mode,Ne),Ne.ref=ba(q,U,Q),Ne.return=q,Ne)}function ee(q,U,Q,Ne){return U===null||U.tag!==4||U.stateNode.containerInfo!==Q.containerInfo||U.stateNode.implementation!==Q.implementation?(U=Ou(Q,q.mode,Ne),U.return=q,U):(U=l(U,Q.children||[]),U.return=q,U)}function ye(q,U,Q,Ne,He){return U===null||U.tag!==7?(U=oo(Q,q.mode,Ne,He),U.return=q,U):(U=l(U,Q),U.return=q,U)}function ve(q,U,Q){if(typeof U=="string"&&U!==""||typeof U=="number")return U=Lu(""+U,q.mode,Q),U.return=q,U;if(typeof U=="object"&&U!==null){switch(U.$$typeof){case ie:return Q=Jl(U.type,U.key,U.props,null,q.mode,Q),Q.ref=ba(q,null,U),Q.return=q,Q;case je:return U=Ou(U,q.mode,Q),U.return=q,U;case it:var Ne=U._init;return ve(q,Ne(U._payload),Q)}if(Xt(U)||T(U))return U=oo(U,q.mode,Q,null),U.return=q,U;El(q,U)}return null}function ge(q,U,Q,Ne){var He=U!==null?U.key:null;if(typeof Q=="string"&&Q!==""||typeof Q=="number")return He!==null?null:P(q,U,""+Q,Ne);if(typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case ie:return Q.key===He?A(q,U,Q,Ne):null;case je:return Q.key===He?ee(q,U,Q,Ne):null;case it:return He=Q._init,ge(q,U,He(Q._payload),Ne)}if(Xt(Q)||T(Q))return He!==null?null:ye(q,U,Q,Ne,null);El(q,Q)}return null}function ze(q,U,Q,Ne,He){if(typeof Ne=="string"&&Ne!==""||typeof Ne=="number")return q=q.get(Q)||null,P(U,q,""+Ne,He);if(typeof Ne=="object"&&Ne!==null){switch(Ne.$$typeof){case ie:return q=q.get(Ne.key===null?Q:Ne.key)||null,A(U,q,Ne,He);case je:return q=q.get(Ne.key===null?Q:Ne.key)||null,ee(U,q,Ne,He);case it:var Xe=Ne._init;return ze(q,U,Q,Xe(Ne._payload),He)}if(Xt(Ne)||T(Ne))return q=q.get(Q)||null,ye(U,q,Ne,He,null);El(U,Ne)}return null}function Ue(q,U,Q,Ne){for(var He=null,Xe=null,Je=U,at=U=0,lr=null;Je!==null&&at<Q.length;at++){Je.index>at?(lr=Je,Je=null):lr=Je.sibling;var wt=ge(q,Je,Q[at],Ne);if(wt===null){Je===null&&(Je=lr);break}e&&Je&&wt.alternate===null&&t(q,Je),U=c(wt,U,at),Xe===null?He=wt:Xe.sibling=wt,Xe=wt,Je=lr}if(at===Q.length)return r(q,Je),Ot&&Xs(q,at),He;if(Je===null){for(;at<Q.length;at++)Je=ve(q,Q[at],Ne),Je!==null&&(U=c(Je,U,at),Xe===null?He=Je:Xe.sibling=Je,Xe=Je);return Ot&&Xs(q,at),He}for(Je=o(q,Je);at<Q.length;at++)lr=ze(Je,q,at,Q[at],Ne),lr!==null&&(e&&lr.alternate!==null&&Je.delete(lr.key===null?at:lr.key),U=c(lr,U,at),Xe===null?He=lr:Xe.sibling=lr,Xe=lr);return e&&Je.forEach(function(Ps){return t(q,Ps)}),Ot&&Xs(q,at),He}function $e(q,U,Q,Ne){var He=T(Q);if(typeof He!="function")throw Error(f(150));if(Q=He.call(Q),Q==null)throw Error(f(151));for(var Xe=He=null,Je=U,at=U=0,lr=null,wt=Q.next();Je!==null&&!wt.done;at++,wt=Q.next()){Je.index>at?(lr=Je,Je=null):lr=Je.sibling;var Ps=ge(q,Je,wt.value,Ne);if(Ps===null){Je===null&&(Je=lr);break}e&&Je&&Ps.alternate===null&&t(q,Je),U=c(Ps,U,at),Xe===null?He=Ps:Xe.sibling=Ps,Xe=Ps,Je=lr}if(wt.done)return r(q,Je),Ot&&Xs(q,at),He;if(Je===null){for(;!wt.done;at++,wt=Q.next())wt=ve(q,wt.value,Ne),wt!==null&&(U=c(wt,U,at),Xe===null?He=wt:Xe.sibling=wt,Xe=wt);return Ot&&Xs(q,at),He}for(Je=o(q,Je);!wt.done;at++,wt=Q.next())wt=ze(Je,q,at,wt.value,Ne),wt!==null&&(e&&wt.alternate!==null&&Je.delete(wt.key===null?at:wt.key),U=c(wt,U,at),Xe===null?He=wt:Xe.sibling=wt,Xe=wt);return e&&Je.forEach(function(Oh){return t(q,Oh)}),Ot&&Xs(q,at),He}function qt(q,U,Q,Ne){if(typeof Q=="object"&&Q!==null&&Q.type===de&&Q.key===null&&(Q=Q.props.children),typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case ie:e:{for(var He=Q.key,Xe=U;Xe!==null;){if(Xe.key===He){if(He=Q.type,He===de){if(Xe.tag===7){r(q,Xe.sibling),U=l(Xe,Q.props.children),U.return=q,q=U;break e}}else if(Xe.elementType===He||typeof He=="object"&&He!==null&&He.$$typeof===it&&Vc(He)===Xe.type){r(q,Xe.sibling),U=l(Xe,Q.props),U.ref=ba(q,Xe,Q),U.return=q,q=U;break e}r(q,Xe);break}else t(q,Xe);Xe=Xe.sibling}Q.type===de?(U=oo(Q.props.children,q.mode,Ne,Q.key),U.return=q,q=U):(Ne=Jl(Q.type,Q.key,Q.props,null,q.mode,Ne),Ne.ref=ba(q,U,Q),Ne.return=q,q=Ne)}return g(q);case je:e:{for(Xe=Q.key;U!==null;){if(U.key===Xe)if(U.tag===4&&U.stateNode.containerInfo===Q.containerInfo&&U.stateNode.implementation===Q.implementation){r(q,U.sibling),U=l(U,Q.children||[]),U.return=q,q=U;break e}else{r(q,U);break}else t(q,U);U=U.sibling}U=Ou(Q,q.mode,Ne),U.return=q,q=U}return g(q);case it:return Xe=Q._init,qt(q,U,Xe(Q._payload),Ne)}if(Xt(Q))return Ue(q,U,Q,Ne);if(T(Q))return $e(q,U,Q,Ne);El(q,Q)}return typeof Q=="string"&&Q!==""||typeof Q=="number"?(Q=""+Q,U!==null&&U.tag===6?(r(q,U.sibling),U=l(U,Q),U.return=q,q=U):(r(q,U),U=Lu(Q,q.mode,Ne),U.return=q,q=U),g(q)):r(q,U)}return qt}var Mo=Wc(!0),qc=Wc(!1),Pl=ys(null),Tl=null,Fo=null,Vi=null;function Wi(){Vi=Fo=Tl=null}function qi(e){var t=Pl.current;At(Pl),e._currentValue=t}function Hi(e,t,r){for(;e!==null;){var o=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,o!==null&&(o.childLanes|=t)):o!==null&&(o.childLanes&t)!==t&&(o.childLanes|=t),e===r)break;e=e.return}}function zo(e,t){Tl=e,Vi=Fo=null,e=e.dependencies,e!==null&&e.firstContext!==null&&((e.lanes&t)!==0&&(Rr=!0),e.firstContext=null)}function qr(e){var t=e._currentValue;if(Vi!==e)if(e={context:e,memoizedValue:t,next:null},Fo===null){if(Tl===null)throw Error(f(308));Fo=e,Tl.dependencies={lanes:0,firstContext:e}}else Fo=Fo.next=e;return t}var Js=null;function Qi(e){Js===null?Js=[e]:Js.push(e)}function Hc(e,t,r,o){var l=t.interleaved;return l===null?(r.next=r,Qi(t)):(r.next=l.next,l.next=r),t.interleaved=r,Hn(e,o)}function Hn(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var ws=!1;function Yi(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Qc(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Qn(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function js(e,t,r){var o=e.updateQueue;if(o===null)return null;if(o=o.shared,(bt&2)!==0){var l=o.pending;return l===null?t.next=t:(t.next=l.next,l.next=t),o.pending=t,Hn(e,r)}return l=o.interleaved,l===null?(t.next=t,Qi(o)):(t.next=l.next,l.next=t),o.interleaved=t,Hn(e,r)}function Rl(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var o=t.lanes;o&=e.pendingLanes,r|=o,t.lanes=r,mo(e,r)}}function Yc(e,t){var r=e.updateQueue,o=e.alternate;if(o!==null&&(o=o.updateQueue,r===o)){var l=null,c=null;if(r=r.firstBaseUpdate,r!==null){do{var g={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};c===null?l=c=g:c=c.next=g,r=r.next}while(r!==null);c===null?l=c=t:c=c.next=t}else l=c=t;r={baseState:o.baseState,firstBaseUpdate:l,lastBaseUpdate:c,shared:o.shared,effects:o.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Dl(e,t,r,o){var l=e.updateQueue;ws=!1;var c=l.firstBaseUpdate,g=l.lastBaseUpdate,P=l.shared.pending;if(P!==null){l.shared.pending=null;var A=P,ee=A.next;A.next=null,g===null?c=ee:g.next=ee,g=A;var ye=e.alternate;ye!==null&&(ye=ye.updateQueue,P=ye.lastBaseUpdate,P!==g&&(P===null?ye.firstBaseUpdate=ee:P.next=ee,ye.lastBaseUpdate=A))}if(c!==null){var ve=l.baseState;g=0,ye=ee=A=null,P=c;do{var ge=P.lane,ze=P.eventTime;if((o&ge)===ge){ye!==null&&(ye=ye.next={eventTime:ze,lane:0,tag:P.tag,payload:P.payload,callback:P.callback,next:null});e:{var Ue=e,$e=P;switch(ge=t,ze=r,$e.tag){case 1:if(Ue=$e.payload,typeof Ue=="function"){ve=Ue.call(ze,ve,ge);break e}ve=Ue;break e;case 3:Ue.flags=Ue.flags&-65537|128;case 0:if(Ue=$e.payload,ge=typeof Ue=="function"?Ue.call(ze,ve,ge):Ue,ge==null)break e;ve=v({},ve,ge);break e;case 2:ws=!0}}P.callback!==null&&P.lane!==0&&(e.flags|=64,ge=l.effects,ge===null?l.effects=[P]:ge.push(P))}else ze={eventTime:ze,lane:ge,tag:P.tag,payload:P.payload,callback:P.callback,next:null},ye===null?(ee=ye=ze,A=ve):ye=ye.next=ze,g|=ge;if(P=P.next,P===null){if(P=l.shared.pending,P===null)break;ge=P,P=ge.next,ge.next=null,l.lastBaseUpdate=ge,l.shared.pending=null}}while(!0);if(ye===null&&(A=ve),l.baseState=A,l.firstBaseUpdate=ee,l.lastBaseUpdate=ye,t=l.shared.interleaved,t!==null){l=t;do g|=l.lane,l=l.next;while(l!==t)}else c===null&&(l.shared.lanes=0);to|=g,e.lanes=g,e.memoizedState=ve}}function Gc(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var o=e[t],l=o.callback;if(l!==null){if(o.callback=null,o=r,typeof l!="function")throw Error(f(191,l));l.call(o)}}}var wa={},Cn=ys(wa),ja=ys(wa),ka=ys(wa);function Zs(e){if(e===wa)throw Error(f(174));return e}function Gi(e,t){switch(Pt(ka,t),Pt(ja,e),Pt(Cn,wa),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Ft(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Ft(t,e)}At(Cn),Pt(Cn,t)}function Io(){At(Cn),At(ja),At(ka)}function Xc(e){Zs(ka.current);var t=Zs(Cn.current),r=Ft(t,e.type);t!==r&&(Pt(ja,e),Pt(Cn,r))}function Xi(e){ja.current===e&&(At(Cn),At(ja))}var Bt=ys(0);function Al(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if((t.flags&128)!==0)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Ji=[];function Zi(){for(var e=0;e<Ji.length;e++)Ji[e]._workInProgressVersionPrimary=null;Ji.length=0}var Ll=ce.ReactCurrentDispatcher,eu=ce.ReactCurrentBatchConfig,eo=0,Ut=null,Zt=null,or=null,Ol=!1,Na=!1,Sa=0,nh=0;function gr(){throw Error(f(321))}function tu(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!$(e[r],t[r]))return!1;return!0}function ru(e,t,r,o,l,c){if(eo=c,Ut=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Ll.current=e===null||e.memoizedState===null?lh:ih,e=r(o,l),Na){c=0;do{if(Na=!1,Sa=0,25<=c)throw Error(f(301));c+=1,or=Zt=null,t.updateQueue=null,Ll.current=uh,e=r(o,l)}while(Na)}if(Ll.current=zl,t=Zt!==null&&Zt.next!==null,eo=0,or=Zt=Ut=null,Ol=!1,t)throw Error(f(300));return e}function nu(){var e=Sa!==0;return Sa=0,e}function _n(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return or===null?Ut.memoizedState=or=e:or=or.next=e,or}function Hr(){if(Zt===null){var e=Ut.alternate;e=e!==null?e.memoizedState:null}else e=Zt.next;var t=or===null?Ut.memoizedState:or.next;if(t!==null)or=t,Zt=e;else{if(e===null)throw Error(f(310));Zt=e,e={memoizedState:Zt.memoizedState,baseState:Zt.baseState,baseQueue:Zt.baseQueue,queue:Zt.queue,next:null},or===null?Ut.memoizedState=or=e:or=or.next=e}return or}function Ca(e,t){return typeof t=="function"?t(e):t}function su(e){var t=Hr(),r=t.queue;if(r===null)throw Error(f(311));r.lastRenderedReducer=e;var o=Zt,l=o.baseQueue,c=r.pending;if(c!==null){if(l!==null){var g=l.next;l.next=c.next,c.next=g}o.baseQueue=l=c,r.pending=null}if(l!==null){c=l.next,o=o.baseState;var P=g=null,A=null,ee=c;do{var ye=ee.lane;if((eo&ye)===ye)A!==null&&(A=A.next={lane:0,action:ee.action,hasEagerState:ee.hasEagerState,eagerState:ee.eagerState,next:null}),o=ee.hasEagerState?ee.eagerState:e(o,ee.action);else{var ve={lane:ye,action:ee.action,hasEagerState:ee.hasEagerState,eagerState:ee.eagerState,next:null};A===null?(P=A=ve,g=o):A=A.next=ve,Ut.lanes|=ye,to|=ye}ee=ee.next}while(ee!==null&&ee!==c);A===null?g=o:A.next=P,$(o,t.memoizedState)||(Rr=!0),t.memoizedState=o,t.baseState=g,t.baseQueue=A,r.lastRenderedState=o}if(e=r.interleaved,e!==null){l=e;do c=l.lane,Ut.lanes|=c,to|=c,l=l.next;while(l!==e)}else l===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function ou(e){var t=Hr(),r=t.queue;if(r===null)throw Error(f(311));r.lastRenderedReducer=e;var o=r.dispatch,l=r.pending,c=t.memoizedState;if(l!==null){r.pending=null;var g=l=l.next;do c=e(c,g.action),g=g.next;while(g!==l);$(c,t.memoizedState)||(Rr=!0),t.memoizedState=c,t.baseQueue===null&&(t.baseState=c),r.lastRenderedState=c}return[c,o]}function Jc(){}function Zc(e,t){var r=Ut,o=Hr(),l=t(),c=!$(o.memoizedState,l);if(c&&(o.memoizedState=l,Rr=!0),o=o.queue,au(rd.bind(null,r,o,e),[e]),o.getSnapshot!==t||c||or!==null&&or.memoizedState.tag&1){if(r.flags|=2048,_a(9,td.bind(null,r,o,l,t),void 0,null),ar===null)throw Error(f(349));(eo&30)!==0||ed(r,t,l)}return l}function ed(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Ut.updateQueue,t===null?(t={lastEffect:null,stores:null},Ut.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function td(e,t,r,o){t.value=r,t.getSnapshot=o,nd(t)&&sd(e)}function rd(e,t,r){return r(function(){nd(t)&&sd(e)})}function nd(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!$(e,r)}catch{return!0}}function sd(e){var t=Hn(e,1);t!==null&&dn(t,e,1,-1)}function od(e){var t=_n();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ca,lastRenderedState:e},t.queue=e,e=e.dispatch=ah.bind(null,Ut,e),[t.memoizedState,e]}function _a(e,t,r,o){return e={tag:e,create:t,destroy:r,deps:o,next:null},t=Ut.updateQueue,t===null?(t={lastEffect:null,stores:null},Ut.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(o=r.next,r.next=e,e.next=o,t.lastEffect=e)),e}function ad(){return Hr().memoizedState}function Ml(e,t,r,o){var l=_n();Ut.flags|=e,l.memoizedState=_a(1|t,r,void 0,o===void 0?null:o)}function Fl(e,t,r,o){var l=Hr();o=o===void 0?null:o;var c=void 0;if(Zt!==null){var g=Zt.memoizedState;if(c=g.destroy,o!==null&&tu(o,g.deps)){l.memoizedState=_a(t,r,c,o);return}}Ut.flags|=e,l.memoizedState=_a(1|t,r,c,o)}function ld(e,t){return Ml(8390656,8,e,t)}function au(e,t){return Fl(2048,8,e,t)}function id(e,t){return Fl(4,2,e,t)}function ud(e,t){return Fl(4,4,e,t)}function cd(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function dd(e,t,r){return r=r!=null?r.concat([e]):null,Fl(4,4,cd.bind(null,t,e),r)}function lu(){}function fd(e,t){var r=Hr();t=t===void 0?null:t;var o=r.memoizedState;return o!==null&&t!==null&&tu(t,o[1])?o[0]:(r.memoizedState=[e,t],e)}function pd(e,t){var r=Hr();t=t===void 0?null:t;var o=r.memoizedState;return o!==null&&t!==null&&tu(t,o[1])?o[0]:(e=e(),r.memoizedState=[e,t],e)}function hd(e,t,r){return(eo&21)===0?(e.baseState&&(e.baseState=!1,Rr=!0),e.memoizedState=r):($(r,t)||(r=On(),Ut.lanes|=r,to|=r,e.baseState=!0),t)}function sh(e,t){var r=xt;xt=r!==0&&4>r?r:4,e(!0);var o=eu.transition;eu.transition={};try{e(!1),t()}finally{xt=r,eu.transition=o}}function md(){return Hr().memoizedState}function oh(e,t,r){var o=Cs(e);if(r={lane:o,action:r,hasEagerState:!1,eagerState:null,next:null},gd(e))xd(t,r);else if(r=Hc(e,t,r,o),r!==null){var l=kr();dn(r,e,o,l),yd(r,t,o)}}function ah(e,t,r){var o=Cs(e),l={lane:o,action:r,hasEagerState:!1,eagerState:null,next:null};if(gd(e))xd(t,l);else{var c=e.alternate;if(e.lanes===0&&(c===null||c.lanes===0)&&(c=t.lastRenderedReducer,c!==null))try{var g=t.lastRenderedState,P=c(g,r);if(l.hasEagerState=!0,l.eagerState=P,$(P,g)){var A=t.interleaved;A===null?(l.next=l,Qi(t)):(l.next=A.next,A.next=l),t.interleaved=l;return}}catch{}finally{}r=Hc(e,t,l,o),r!==null&&(l=kr(),dn(r,e,o,l),yd(r,t,o))}}function gd(e){var t=e.alternate;return e===Ut||t!==null&&t===Ut}function xd(e,t){Na=Ol=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function yd(e,t,r){if((r&4194240)!==0){var o=t.lanes;o&=e.pendingLanes,r|=o,t.lanes=r,mo(e,r)}}var zl={readContext:qr,useCallback:gr,useContext:gr,useEffect:gr,useImperativeHandle:gr,useInsertionEffect:gr,useLayoutEffect:gr,useMemo:gr,useReducer:gr,useRef:gr,useState:gr,useDebugValue:gr,useDeferredValue:gr,useTransition:gr,useMutableSource:gr,useSyncExternalStore:gr,useId:gr,unstable_isNewReconciler:!1},lh={readContext:qr,useCallback:function(e,t){return _n().memoizedState=[e,t===void 0?null:t],e},useContext:qr,useEffect:ld,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Ml(4194308,4,cd.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Ml(4194308,4,e,t)},useInsertionEffect:function(e,t){return Ml(4,2,e,t)},useMemo:function(e,t){var r=_n();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var o=_n();return t=r!==void 0?r(t):t,o.memoizedState=o.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},o.queue=e,e=e.dispatch=oh.bind(null,Ut,e),[o.memoizedState,e]},useRef:function(e){var t=_n();return e={current:e},t.memoizedState=e},useState:od,useDebugValue:lu,useDeferredValue:function(e){return _n().memoizedState=e},useTransition:function(){var e=od(!1),t=e[0];return e=sh.bind(null,e[1]),_n().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var o=Ut,l=_n();if(Ot){if(r===void 0)throw Error(f(407));r=r()}else{if(r=t(),ar===null)throw Error(f(349));(eo&30)!==0||ed(o,t,r)}l.memoizedState=r;var c={value:r,getSnapshot:t};return l.queue=c,ld(rd.bind(null,o,c,e),[e]),o.flags|=2048,_a(9,td.bind(null,o,c,r,t),void 0,null),r},useId:function(){var e=_n(),t=ar.identifierPrefix;if(Ot){var r=qn,o=Wn;r=(o&~(1<<32-ot(o)-1)).toString(32)+r,t=":"+t+"R"+r,r=Sa++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=nh++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},ih={readContext:qr,useCallback:fd,useContext:qr,useEffect:au,useImperativeHandle:dd,useInsertionEffect:id,useLayoutEffect:ud,useMemo:pd,useReducer:su,useRef:ad,useState:function(){return su(Ca)},useDebugValue:lu,useDeferredValue:function(e){var t=Hr();return hd(t,Zt.memoizedState,e)},useTransition:function(){var e=su(Ca)[0],t=Hr().memoizedState;return[e,t]},useMutableSource:Jc,useSyncExternalStore:Zc,useId:md,unstable_isNewReconciler:!1},uh={readContext:qr,useCallback:fd,useContext:qr,useEffect:au,useImperativeHandle:dd,useInsertionEffect:id,useLayoutEffect:ud,useMemo:pd,useReducer:ou,useRef:ad,useState:function(){return ou(Ca)},useDebugValue:lu,useDeferredValue:function(e){var t=Hr();return Zt===null?t.memoizedState=e:hd(t,Zt.memoizedState,e)},useTransition:function(){var e=ou(Ca)[0],t=Hr().memoizedState;return[e,t]},useMutableSource:Jc,useSyncExternalStore:Zc,useId:md,unstable_isNewReconciler:!1};function ln(e,t){if(e&&e.defaultProps){t=v({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function iu(e,t,r,o){t=e.memoizedState,r=r(o,t),r=r==null?t:v({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var Il={isMounted:function(e){return(e=e._reactInternals)?hr(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var o=kr(),l=Cs(e),c=Qn(o,l);c.payload=t,r!=null&&(c.callback=r),t=js(e,c,l),t!==null&&(dn(t,e,l,o),Rl(t,e,l))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var o=kr(),l=Cs(e),c=Qn(o,l);c.tag=1,c.payload=t,r!=null&&(c.callback=r),t=js(e,c,l),t!==null&&(dn(t,e,l,o),Rl(t,e,l))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=kr(),o=Cs(e),l=Qn(r,o);l.tag=2,t!=null&&(l.callback=t),t=js(e,l,o),t!==null&&(dn(t,e,o,r),Rl(t,e,o))}};function vd(e,t,r,o,l,c,g){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(o,c,g):t.prototype&&t.prototype.isPureReactComponent?!O(r,o)||!O(l,c):!0}function bd(e,t,r){var o=!1,l=vs,c=t.contextType;return typeof c=="object"&&c!==null?c=qr(c):(l=Tr(t)?Ys:mr.current,o=t.contextTypes,c=(o=o!=null)?Do(e,l):vs),t=new t(r,c),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Il,e.stateNode=t,t._reactInternals=e,o&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=l,e.__reactInternalMemoizedMaskedChildContext=c),t}function wd(e,t,r,o){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,o),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,o),t.state!==e&&Il.enqueueReplaceState(t,t.state,null)}function uu(e,t,r,o){var l=e.stateNode;l.props=r,l.state=e.memoizedState,l.refs={},Yi(e);var c=t.contextType;typeof c=="object"&&c!==null?l.context=qr(c):(c=Tr(t)?Ys:mr.current,l.context=Do(e,c)),l.state=e.memoizedState,c=t.getDerivedStateFromProps,typeof c=="function"&&(iu(e,t,c,r),l.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof l.getSnapshotBeforeUpdate=="function"||typeof l.UNSAFE_componentWillMount!="function"&&typeof l.componentWillMount!="function"||(t=l.state,typeof l.componentWillMount=="function"&&l.componentWillMount(),typeof l.UNSAFE_componentWillMount=="function"&&l.UNSAFE_componentWillMount(),t!==l.state&&Il.enqueueReplaceState(l,l.state,null),Dl(e,r,l,o),l.state=e.memoizedState),typeof l.componentDidMount=="function"&&(e.flags|=4194308)}function Bo(e,t){try{var r="",o=t;do r+=be(o),o=o.return;while(o);var l=r}catch(c){l=`
Error generating stack: `+c.message+`
`+c.stack}return{value:e,source:t,stack:l,digest:null}}function cu(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function du(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var ch=typeof WeakMap=="function"?WeakMap:Map;function jd(e,t,r){r=Qn(-1,r),r.tag=3,r.payload={element:null};var o=t.value;return r.callback=function(){ql||(ql=!0,Cu=o),du(e,t)},r}function kd(e,t,r){r=Qn(-1,r),r.tag=3;var o=e.type.getDerivedStateFromError;if(typeof o=="function"){var l=t.value;r.payload=function(){return o(l)},r.callback=function(){du(e,t)}}var c=e.stateNode;return c!==null&&typeof c.componentDidCatch=="function"&&(r.callback=function(){du(e,t),typeof o!="function"&&(Ns===null?Ns=new Set([this]):Ns.add(this));var g=t.stack;this.componentDidCatch(t.value,{componentStack:g!==null?g:""})}),r}function Nd(e,t,r){var o=e.pingCache;if(o===null){o=e.pingCache=new ch;var l=new Set;o.set(t,l)}else l=o.get(t),l===void 0&&(l=new Set,o.set(t,l));l.has(r)||(l.add(r),e=Nh.bind(null,e,t,r),t.then(e,e))}function Sd(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Cd(e,t,r,o,l){return(e.mode&1)===0?(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=Qn(-1,1),t.tag=2,js(r,t,1))),r.lanes|=1),e):(e.flags|=65536,e.lanes=l,e)}var dh=ce.ReactCurrentOwner,Rr=!1;function jr(e,t,r,o){t.child=e===null?qc(t,null,r,o):Mo(t,e.child,r,o)}function _d(e,t,r,o,l){r=r.render;var c=t.ref;return zo(t,l),o=ru(e,t,r,o,c,l),r=nu(),e!==null&&!Rr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~l,Yn(e,t,l)):(Ot&&r&&Ii(t),t.flags|=1,jr(e,t,o,l),t.child)}function Ed(e,t,r,o,l){if(e===null){var c=r.type;return typeof c=="function"&&!Au(c)&&c.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=c,Pd(e,t,c,o,l)):(e=Jl(r.type,null,o,t,t.mode,l),e.ref=t.ref,e.return=t,t.child=e)}if(c=e.child,(e.lanes&l)===0){var g=c.memoizedProps;if(r=r.compare,r=r!==null?r:O,r(g,o)&&e.ref===t.ref)return Yn(e,t,l)}return t.flags|=1,e=Es(c,o),e.ref=t.ref,e.return=t,t.child=e}function Pd(e,t,r,o,l){if(e!==null){var c=e.memoizedProps;if(O(c,o)&&e.ref===t.ref)if(Rr=!1,t.pendingProps=o=c,(e.lanes&l)!==0)(e.flags&131072)!==0&&(Rr=!0);else return t.lanes=e.lanes,Yn(e,t,l)}return fu(e,t,r,o,l)}function Td(e,t,r){var o=t.pendingProps,l=o.children,c=e!==null?e.memoizedState:null;if(o.mode==="hidden")if((t.mode&1)===0)t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Pt($o,Br),Br|=r;else{if((r&1073741824)===0)return e=c!==null?c.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Pt($o,Br),Br|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},o=c!==null?c.baseLanes:r,Pt($o,Br),Br|=o}else c!==null?(o=c.baseLanes|r,t.memoizedState=null):o=r,Pt($o,Br),Br|=o;return jr(e,t,l,r),t.child}function Rd(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function fu(e,t,r,o,l){var c=Tr(r)?Ys:mr.current;return c=Do(t,c),zo(t,l),r=ru(e,t,r,o,c,l),o=nu(),e!==null&&!Rr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~l,Yn(e,t,l)):(Ot&&o&&Ii(t),t.flags|=1,jr(e,t,r,l),t.child)}function Dd(e,t,r,o,l){if(Tr(r)){var c=!0;kl(t)}else c=!1;if(zo(t,l),t.stateNode===null)Ul(e,t),bd(t,r,o),uu(t,r,o,l),o=!0;else if(e===null){var g=t.stateNode,P=t.memoizedProps;g.props=P;var A=g.context,ee=r.contextType;typeof ee=="object"&&ee!==null?ee=qr(ee):(ee=Tr(r)?Ys:mr.current,ee=Do(t,ee));var ye=r.getDerivedStateFromProps,ve=typeof ye=="function"||typeof g.getSnapshotBeforeUpdate=="function";ve||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(P!==o||A!==ee)&&wd(t,g,o,ee),ws=!1;var ge=t.memoizedState;g.state=ge,Dl(t,o,g,l),A=t.memoizedState,P!==o||ge!==A||Pr.current||ws?(typeof ye=="function"&&(iu(t,r,ye,o),A=t.memoizedState),(P=ws||vd(t,r,P,o,ge,A,ee))?(ve||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount()),typeof g.componentDidMount=="function"&&(t.flags|=4194308)):(typeof g.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=o,t.memoizedState=A),g.props=o,g.state=A,g.context=ee,o=P):(typeof g.componentDidMount=="function"&&(t.flags|=4194308),o=!1)}else{g=t.stateNode,Qc(e,t),P=t.memoizedProps,ee=t.type===t.elementType?P:ln(t.type,P),g.props=ee,ve=t.pendingProps,ge=g.context,A=r.contextType,typeof A=="object"&&A!==null?A=qr(A):(A=Tr(r)?Ys:mr.current,A=Do(t,A));var ze=r.getDerivedStateFromProps;(ye=typeof ze=="function"||typeof g.getSnapshotBeforeUpdate=="function")||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(P!==ve||ge!==A)&&wd(t,g,o,A),ws=!1,ge=t.memoizedState,g.state=ge,Dl(t,o,g,l);var Ue=t.memoizedState;P!==ve||ge!==Ue||Pr.current||ws?(typeof ze=="function"&&(iu(t,r,ze,o),Ue=t.memoizedState),(ee=ws||vd(t,r,ee,o,ge,Ue,A)||!1)?(ye||typeof g.UNSAFE_componentWillUpdate!="function"&&typeof g.componentWillUpdate!="function"||(typeof g.componentWillUpdate=="function"&&g.componentWillUpdate(o,Ue,A),typeof g.UNSAFE_componentWillUpdate=="function"&&g.UNSAFE_componentWillUpdate(o,Ue,A)),typeof g.componentDidUpdate=="function"&&(t.flags|=4),typeof g.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof g.componentDidUpdate!="function"||P===e.memoizedProps&&ge===e.memoizedState||(t.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||P===e.memoizedProps&&ge===e.memoizedState||(t.flags|=1024),t.memoizedProps=o,t.memoizedState=Ue),g.props=o,g.state=Ue,g.context=A,o=ee):(typeof g.componentDidUpdate!="function"||P===e.memoizedProps&&ge===e.memoizedState||(t.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||P===e.memoizedProps&&ge===e.memoizedState||(t.flags|=1024),o=!1)}return pu(e,t,r,o,c,l)}function pu(e,t,r,o,l,c){Rd(e,t);var g=(t.flags&128)!==0;if(!o&&!g)return l&&Fc(t,r,!1),Yn(e,t,c);o=t.stateNode,dh.current=t;var P=g&&typeof r.getDerivedStateFromError!="function"?null:o.render();return t.flags|=1,e!==null&&g?(t.child=Mo(t,e.child,null,c),t.child=Mo(t,null,P,c)):jr(e,t,P,c),t.memoizedState=o.state,l&&Fc(t,r,!0),t.child}function Ad(e){var t=e.stateNode;t.pendingContext?Oc(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Oc(e,t.context,!1),Gi(e,t.containerInfo)}function Ld(e,t,r,o,l){return Oo(),Ki(l),t.flags|=256,jr(e,t,r,o),t.child}var hu={dehydrated:null,treeContext:null,retryLane:0};function mu(e){return{baseLanes:e,cachePool:null,transitions:null}}function Od(e,t,r){var o=t.pendingProps,l=Bt.current,c=!1,g=(t.flags&128)!==0,P;if((P=g)||(P=e!==null&&e.memoizedState===null?!1:(l&2)!==0),P?(c=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(l|=1),Pt(Bt,l&1),e===null)return $i(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?((t.mode&1)===0?t.lanes=1:e.data==="$!"?t.lanes=8:t.lanes=1073741824,null):(g=o.children,e=o.fallback,c?(o=t.mode,c=t.child,g={mode:"hidden",children:g},(o&1)===0&&c!==null?(c.childLanes=0,c.pendingProps=g):c=Zl(g,o,0,null),e=oo(e,o,r,null),c.return=t,e.return=t,c.sibling=e,t.child=c,t.child.memoizedState=mu(r),t.memoizedState=hu,e):gu(t,g));if(l=e.memoizedState,l!==null&&(P=l.dehydrated,P!==null))return fh(e,t,g,o,P,l,r);if(c){c=o.fallback,g=t.mode,l=e.child,P=l.sibling;var A={mode:"hidden",children:o.children};return(g&1)===0&&t.child!==l?(o=t.child,o.childLanes=0,o.pendingProps=A,t.deletions=null):(o=Es(l,A),o.subtreeFlags=l.subtreeFlags&14680064),P!==null?c=Es(P,c):(c=oo(c,g,r,null),c.flags|=2),c.return=t,o.return=t,o.sibling=c,t.child=o,o=c,c=t.child,g=e.child.memoizedState,g=g===null?mu(r):{baseLanes:g.baseLanes|r,cachePool:null,transitions:g.transitions},c.memoizedState=g,c.childLanes=e.childLanes&~r,t.memoizedState=hu,o}return c=e.child,e=c.sibling,o=Es(c,{mode:"visible",children:o.children}),(t.mode&1)===0&&(o.lanes=r),o.return=t,o.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=o,t.memoizedState=null,o}function gu(e,t){return t=Zl({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Bl(e,t,r,o){return o!==null&&Ki(o),Mo(t,e.child,null,r),e=gu(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function fh(e,t,r,o,l,c,g){if(r)return t.flags&256?(t.flags&=-257,o=cu(Error(f(422))),Bl(e,t,g,o)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(c=o.fallback,l=t.mode,o=Zl({mode:"visible",children:o.children},l,0,null),c=oo(c,l,g,null),c.flags|=2,o.return=t,c.return=t,o.sibling=c,t.child=o,(t.mode&1)!==0&&Mo(t,e.child,null,g),t.child.memoizedState=mu(g),t.memoizedState=hu,c);if((t.mode&1)===0)return Bl(e,t,g,null);if(l.data==="$!"){if(o=l.nextSibling&&l.nextSibling.dataset,o)var P=o.dgst;return o=P,c=Error(f(419)),o=cu(c,o,void 0),Bl(e,t,g,o)}if(P=(g&e.childLanes)!==0,Rr||P){if(o=ar,o!==null){switch(g&-g){case 4:l=2;break;case 16:l=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:l=32;break;case 536870912:l=268435456;break;default:l=0}l=(l&(o.suspendedLanes|g))!==0?0:l,l!==0&&l!==c.retryLane&&(c.retryLane=l,Hn(e,l),dn(o,e,l,-1))}return Du(),o=cu(Error(f(421))),Bl(e,t,g,o)}return l.data==="$?"?(t.flags|=128,t.child=e.child,t=Sh.bind(null,e),l._reactRetry=t,null):(e=c.treeContext,Ir=xs(l.nextSibling),zr=t,Ot=!0,an=null,e!==null&&(Vr[Wr++]=Wn,Vr[Wr++]=qn,Vr[Wr++]=Gs,Wn=e.id,qn=e.overflow,Gs=t),t=gu(t,o.children),t.flags|=4096,t)}function Md(e,t,r){e.lanes|=t;var o=e.alternate;o!==null&&(o.lanes|=t),Hi(e.return,t,r)}function xu(e,t,r,o,l){var c=e.memoizedState;c===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:o,tail:r,tailMode:l}:(c.isBackwards=t,c.rendering=null,c.renderingStartTime=0,c.last=o,c.tail=r,c.tailMode=l)}function Fd(e,t,r){var o=t.pendingProps,l=o.revealOrder,c=o.tail;if(jr(e,t,o.children,r),o=Bt.current,(o&2)!==0)o=o&1|2,t.flags|=128;else{if(e!==null&&(e.flags&128)!==0)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Md(e,r,t);else if(e.tag===19)Md(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}o&=1}if(Pt(Bt,o),(t.mode&1)===0)t.memoizedState=null;else switch(l){case"forwards":for(r=t.child,l=null;r!==null;)e=r.alternate,e!==null&&Al(e)===null&&(l=r),r=r.sibling;r=l,r===null?(l=t.child,t.child=null):(l=r.sibling,r.sibling=null),xu(t,!1,l,r,c);break;case"backwards":for(r=null,l=t.child,t.child=null;l!==null;){if(e=l.alternate,e!==null&&Al(e)===null){t.child=l;break}e=l.sibling,l.sibling=r,r=l,l=e}xu(t,!0,r,null,c);break;case"together":xu(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Ul(e,t){(t.mode&1)===0&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Yn(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),to|=t.lanes,(r&t.childLanes)===0)return null;if(e!==null&&t.child!==e.child)throw Error(f(153));if(t.child!==null){for(e=t.child,r=Es(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Es(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function ph(e,t,r){switch(t.tag){case 3:Ad(t),Oo();break;case 5:Xc(t);break;case 1:Tr(t.type)&&kl(t);break;case 4:Gi(t,t.stateNode.containerInfo);break;case 10:var o=t.type._context,l=t.memoizedProps.value;Pt(Pl,o._currentValue),o._currentValue=l;break;case 13:if(o=t.memoizedState,o!==null)return o.dehydrated!==null?(Pt(Bt,Bt.current&1),t.flags|=128,null):(r&t.child.childLanes)!==0?Od(e,t,r):(Pt(Bt,Bt.current&1),e=Yn(e,t,r),e!==null?e.sibling:null);Pt(Bt,Bt.current&1);break;case 19:if(o=(r&t.childLanes)!==0,(e.flags&128)!==0){if(o)return Fd(e,t,r);t.flags|=128}if(l=t.memoizedState,l!==null&&(l.rendering=null,l.tail=null,l.lastEffect=null),Pt(Bt,Bt.current),o)break;return null;case 22:case 23:return t.lanes=0,Td(e,t,r)}return Yn(e,t,r)}var zd,yu,Id,Bd;zd=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}},yu=function(){},Id=function(e,t,r,o){var l=e.memoizedProps;if(l!==o){e=t.stateNode,Zs(Cn.current);var c=null;switch(r){case"input":l=fr(e,l),o=fr(e,o),c=[];break;case"select":l=v({},l,{value:void 0}),o=v({},o,{value:void 0}),c=[];break;case"textarea":l=we(e,l),o=we(e,o),c=[];break;default:typeof l.onClick!="function"&&typeof o.onClick=="function"&&(e.onclick=bl)}Ce(r,o);var g;r=null;for(ee in l)if(!o.hasOwnProperty(ee)&&l.hasOwnProperty(ee)&&l[ee]!=null)if(ee==="style"){var P=l[ee];for(g in P)P.hasOwnProperty(g)&&(r||(r={}),r[g]="")}else ee!=="dangerouslySetInnerHTML"&&ee!=="children"&&ee!=="suppressContentEditableWarning"&&ee!=="suppressHydrationWarning"&&ee!=="autoFocus"&&(C.hasOwnProperty(ee)?c||(c=[]):(c=c||[]).push(ee,null));for(ee in o){var A=o[ee];if(P=l!=null?l[ee]:void 0,o.hasOwnProperty(ee)&&A!==P&&(A!=null||P!=null))if(ee==="style")if(P){for(g in P)!P.hasOwnProperty(g)||A&&A.hasOwnProperty(g)||(r||(r={}),r[g]="");for(g in A)A.hasOwnProperty(g)&&P[g]!==A[g]&&(r||(r={}),r[g]=A[g])}else r||(c||(c=[]),c.push(ee,r)),r=A;else ee==="dangerouslySetInnerHTML"?(A=A?A.__html:void 0,P=P?P.__html:void 0,A!=null&&P!==A&&(c=c||[]).push(ee,A)):ee==="children"?typeof A!="string"&&typeof A!="number"||(c=c||[]).push(ee,""+A):ee!=="suppressContentEditableWarning"&&ee!=="suppressHydrationWarning"&&(C.hasOwnProperty(ee)?(A!=null&&ee==="onScroll"&&Dt("scroll",e),c||P===A||(c=[])):(c=c||[]).push(ee,A))}r&&(c=c||[]).push("style",r);var ee=c;(t.updateQueue=ee)&&(t.flags|=4)}},Bd=function(e,t,r,o){r!==o&&(t.flags|=4)};function Ea(e,t){if(!Ot)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var o=null;r!==null;)r.alternate!==null&&(o=r),r=r.sibling;o===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:o.sibling=null}}function xr(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,o=0;if(t)for(var l=e.child;l!==null;)r|=l.lanes|l.childLanes,o|=l.subtreeFlags&14680064,o|=l.flags&14680064,l.return=e,l=l.sibling;else for(l=e.child;l!==null;)r|=l.lanes|l.childLanes,o|=l.subtreeFlags,o|=l.flags,l.return=e,l=l.sibling;return e.subtreeFlags|=o,e.childLanes=r,t}function hh(e,t,r){var o=t.pendingProps;switch(Bi(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return xr(t),null;case 1:return Tr(t.type)&&jl(),xr(t),null;case 3:return o=t.stateNode,Io(),At(Pr),At(mr),Zi(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(e===null||e.child===null)&&(_l(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&(t.flags&256)===0||(t.flags|=1024,an!==null&&(Pu(an),an=null))),yu(e,t),xr(t),null;case 5:Xi(t);var l=Zs(ka.current);if(r=t.type,e!==null&&t.stateNode!=null)Id(e,t,r,o,l),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!o){if(t.stateNode===null)throw Error(f(166));return xr(t),null}if(e=Zs(Cn.current),_l(t)){o=t.stateNode,r=t.type;var c=t.memoizedProps;switch(o[Sn]=t,o[ya]=c,e=(t.mode&1)!==0,r){case"dialog":Dt("cancel",o),Dt("close",o);break;case"iframe":case"object":case"embed":Dt("load",o);break;case"video":case"audio":for(l=0;l<ma.length;l++)Dt(ma[l],o);break;case"source":Dt("error",o);break;case"img":case"image":case"link":Dt("error",o),Dt("load",o);break;case"details":Dt("toggle",o);break;case"input":Me(o,c),Dt("invalid",o);break;case"select":o._wrapperState={wasMultiple:!!c.multiple},Dt("invalid",o);break;case"textarea":Ze(o,c),Dt("invalid",o)}Ce(r,c),l=null;for(var g in c)if(c.hasOwnProperty(g)){var P=c[g];g==="children"?typeof P=="string"?o.textContent!==P&&(c.suppressHydrationWarning!==!0&&vl(o.textContent,P,e),l=["children",P]):typeof P=="number"&&o.textContent!==""+P&&(c.suppressHydrationWarning!==!0&&vl(o.textContent,P,e),l=["children",""+P]):C.hasOwnProperty(g)&&P!=null&&g==="onScroll"&&Dt("scroll",o)}switch(r){case"input":Ht(o),Mr(o,c,!0);break;case"textarea":Ht(o),ft(o);break;case"select":case"option":break;default:typeof c.onClick=="function"&&(o.onclick=bl)}o=l,t.updateQueue=o,o!==null&&(t.flags|=4)}else{g=l.nodeType===9?l:l.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=rt(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=g.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof o.is=="string"?e=g.createElement(r,{is:o.is}):(e=g.createElement(r),r==="select"&&(g=e,o.multiple?g.multiple=!0:o.size&&(g.size=o.size))):e=g.createElementNS(e,r),e[Sn]=t,e[ya]=o,zd(e,t,!1,!1),t.stateNode=e;e:{switch(g=W(r,o),r){case"dialog":Dt("cancel",e),Dt("close",e),l=o;break;case"iframe":case"object":case"embed":Dt("load",e),l=o;break;case"video":case"audio":for(l=0;l<ma.length;l++)Dt(ma[l],e);l=o;break;case"source":Dt("error",e),l=o;break;case"img":case"image":case"link":Dt("error",e),Dt("load",e),l=o;break;case"details":Dt("toggle",e),l=o;break;case"input":Me(e,o),l=fr(e,o),Dt("invalid",e);break;case"option":l=o;break;case"select":e._wrapperState={wasMultiple:!!o.multiple},l=v({},o,{value:void 0}),Dt("invalid",e);break;case"textarea":Ze(e,o),l=we(e,o),Dt("invalid",e);break;default:l=o}Ce(r,l),P=l;for(c in P)if(P.hasOwnProperty(c)){var A=P[c];c==="style"?Re(e,A):c==="dangerouslySetInnerHTML"?(A=A?A.__html:void 0,A!=null&&Qt(e,A)):c==="children"?typeof A=="string"?(r!=="textarea"||A!=="")&&vt(e,A):typeof A=="number"&&vt(e,""+A):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(C.hasOwnProperty(c)?A!=null&&c==="onScroll"&&Dt("scroll",e):A!=null&&oe(e,c,A,g))}switch(r){case"input":Ht(e),Mr(e,o,!1);break;case"textarea":Ht(e),ft(e);break;case"option":o.value!=null&&e.setAttribute("value",""+qe(o.value));break;case"select":e.multiple=!!o.multiple,c=o.value,c!=null?Nt(e,!!o.multiple,c,!1):o.defaultValue!=null&&Nt(e,!!o.multiple,o.defaultValue,!0);break;default:typeof l.onClick=="function"&&(e.onclick=bl)}switch(r){case"button":case"input":case"select":case"textarea":o=!!o.autoFocus;break e;case"img":o=!0;break e;default:o=!1}}o&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return xr(t),null;case 6:if(e&&t.stateNode!=null)Bd(e,t,e.memoizedProps,o);else{if(typeof o!="string"&&t.stateNode===null)throw Error(f(166));if(r=Zs(ka.current),Zs(Cn.current),_l(t)){if(o=t.stateNode,r=t.memoizedProps,o[Sn]=t,(c=o.nodeValue!==r)&&(e=zr,e!==null))switch(e.tag){case 3:vl(o.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&vl(o.nodeValue,r,(e.mode&1)!==0)}c&&(t.flags|=4)}else o=(r.nodeType===9?r:r.ownerDocument).createTextNode(o),o[Sn]=t,t.stateNode=o}return xr(t),null;case 13:if(At(Bt),o=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Ot&&Ir!==null&&(t.mode&1)!==0&&(t.flags&128)===0)Kc(),Oo(),t.flags|=98560,c=!1;else if(c=_l(t),o!==null&&o.dehydrated!==null){if(e===null){if(!c)throw Error(f(318));if(c=t.memoizedState,c=c!==null?c.dehydrated:null,!c)throw Error(f(317));c[Sn]=t}else Oo(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;xr(t),c=!1}else an!==null&&(Pu(an),an=null),c=!0;if(!c)return t.flags&65536?t:null}return(t.flags&128)!==0?(t.lanes=r,t):(o=o!==null,o!==(e!==null&&e.memoizedState!==null)&&o&&(t.child.flags|=8192,(t.mode&1)!==0&&(e===null||(Bt.current&1)!==0?er===0&&(er=3):Du())),t.updateQueue!==null&&(t.flags|=4),xr(t),null);case 4:return Io(),yu(e,t),e===null&&ga(t.stateNode.containerInfo),xr(t),null;case 10:return qi(t.type._context),xr(t),null;case 17:return Tr(t.type)&&jl(),xr(t),null;case 19:if(At(Bt),c=t.memoizedState,c===null)return xr(t),null;if(o=(t.flags&128)!==0,g=c.rendering,g===null)if(o)Ea(c,!1);else{if(er!==0||e!==null&&(e.flags&128)!==0)for(e=t.child;e!==null;){if(g=Al(e),g!==null){for(t.flags|=128,Ea(c,!1),o=g.updateQueue,o!==null&&(t.updateQueue=o,t.flags|=4),t.subtreeFlags=0,o=r,r=t.child;r!==null;)c=r,e=o,c.flags&=14680066,g=c.alternate,g===null?(c.childLanes=0,c.lanes=e,c.child=null,c.subtreeFlags=0,c.memoizedProps=null,c.memoizedState=null,c.updateQueue=null,c.dependencies=null,c.stateNode=null):(c.childLanes=g.childLanes,c.lanes=g.lanes,c.child=g.child,c.subtreeFlags=0,c.deletions=null,c.memoizedProps=g.memoizedProps,c.memoizedState=g.memoizedState,c.updateQueue=g.updateQueue,c.type=g.type,e=g.dependencies,c.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Pt(Bt,Bt.current&1|2),t.child}e=e.sibling}c.tail!==null&&jt()>Ko&&(t.flags|=128,o=!0,Ea(c,!1),t.lanes=4194304)}else{if(!o)if(e=Al(g),e!==null){if(t.flags|=128,o=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Ea(c,!0),c.tail===null&&c.tailMode==="hidden"&&!g.alternate&&!Ot)return xr(t),null}else 2*jt()-c.renderingStartTime>Ko&&r!==1073741824&&(t.flags|=128,o=!0,Ea(c,!1),t.lanes=4194304);c.isBackwards?(g.sibling=t.child,t.child=g):(r=c.last,r!==null?r.sibling=g:t.child=g,c.last=g)}return c.tail!==null?(t=c.tail,c.rendering=t,c.tail=t.sibling,c.renderingStartTime=jt(),t.sibling=null,r=Bt.current,Pt(Bt,o?r&1|2:r&1),t):(xr(t),null);case 22:case 23:return Ru(),o=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==o&&(t.flags|=8192),o&&(t.mode&1)!==0?(Br&1073741824)!==0&&(xr(t),t.subtreeFlags&6&&(t.flags|=8192)):xr(t),null;case 24:return null;case 25:return null}throw Error(f(156,t.tag))}function mh(e,t){switch(Bi(t),t.tag){case 1:return Tr(t.type)&&jl(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Io(),At(Pr),At(mr),Zi(),e=t.flags,(e&65536)!==0&&(e&128)===0?(t.flags=e&-65537|128,t):null;case 5:return Xi(t),null;case 13:if(At(Bt),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(f(340));Oo()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return At(Bt),null;case 4:return Io(),null;case 10:return qi(t.type._context),null;case 22:case 23:return Ru(),null;case 24:return null;default:return null}}var $l=!1,yr=!1,gh=typeof WeakSet=="function"?WeakSet:Set,Ie=null;function Uo(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(o){Kt(e,t,o)}else r.current=null}function vu(e,t,r){try{r()}catch(o){Kt(e,t,o)}}var Ud=!1;function xh(e,t){if(Ri=Us,e=F(),M(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var o=r.getSelection&&r.getSelection();if(o&&o.rangeCount!==0){r=o.anchorNode;var l=o.anchorOffset,c=o.focusNode;o=o.focusOffset;try{r.nodeType,c.nodeType}catch{r=null;break e}var g=0,P=-1,A=-1,ee=0,ye=0,ve=e,ge=null;t:for(;;){for(var ze;ve!==r||l!==0&&ve.nodeType!==3||(P=g+l),ve!==c||o!==0&&ve.nodeType!==3||(A=g+o),ve.nodeType===3&&(g+=ve.nodeValue.length),(ze=ve.firstChild)!==null;)ge=ve,ve=ze;for(;;){if(ve===e)break t;if(ge===r&&++ee===l&&(P=g),ge===c&&++ye===o&&(A=g),(ze=ve.nextSibling)!==null)break;ve=ge,ge=ve.parentNode}ve=ze}r=P===-1||A===-1?null:{start:P,end:A}}else r=null}r=r||{start:0,end:0}}else r=null;for(Di={focusedElem:e,selectionRange:r},Us=!1,Ie=t;Ie!==null;)if(t=Ie,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Ie=e;else for(;Ie!==null;){t=Ie;try{var Ue=t.alternate;if((t.flags&1024)!==0)switch(t.tag){case 0:case 11:case 15:break;case 1:if(Ue!==null){var $e=Ue.memoizedProps,qt=Ue.memoizedState,q=t.stateNode,U=q.getSnapshotBeforeUpdate(t.elementType===t.type?$e:ln(t.type,$e),qt);q.__reactInternalSnapshotBeforeUpdate=U}break;case 3:var Q=t.stateNode.containerInfo;Q.nodeType===1?Q.textContent="":Q.nodeType===9&&Q.documentElement&&Q.removeChild(Q.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(f(163))}}catch(Ne){Kt(t,t.return,Ne)}if(e=t.sibling,e!==null){e.return=t.return,Ie=e;break}Ie=t.return}return Ue=Ud,Ud=!1,Ue}function Pa(e,t,r){var o=t.updateQueue;if(o=o!==null?o.lastEffect:null,o!==null){var l=o=o.next;do{if((l.tag&e)===e){var c=l.destroy;l.destroy=void 0,c!==void 0&&vu(t,r,c)}l=l.next}while(l!==o)}}function Kl(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var o=r.create;r.destroy=o()}r=r.next}while(r!==t)}}function bu(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function $d(e){var t=e.alternate;t!==null&&(e.alternate=null,$d(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Sn],delete t[ya],delete t[Mi],delete t[Zp],delete t[eh])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Kd(e){return e.tag===5||e.tag===3||e.tag===4}function Vd(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Kd(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function wu(e,t,r){var o=e.tag;if(o===5||o===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=bl));else if(o!==4&&(e=e.child,e!==null))for(wu(e,t,r),e=e.sibling;e!==null;)wu(e,t,r),e=e.sibling}function ju(e,t,r){var o=e.tag;if(o===5||o===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(o!==4&&(e=e.child,e!==null))for(ju(e,t,r),e=e.sibling;e!==null;)ju(e,t,r),e=e.sibling}var cr=null,un=!1;function ks(e,t,r){for(r=r.child;r!==null;)Wd(e,t,r),r=r.sibling}function Wd(e,t,r){if(vr&&typeof vr.onCommitFiberUnmount=="function")try{vr.onCommitFiberUnmount(Os,r)}catch{}switch(r.tag){case 5:yr||Uo(r,t);case 6:var o=cr,l=un;cr=null,ks(e,t,r),cr=o,un=l,cr!==null&&(un?(e=cr,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):cr.removeChild(r.stateNode));break;case 18:cr!==null&&(un?(e=cr,r=r.stateNode,e.nodeType===8?Oi(e.parentNode,r):e.nodeType===1&&Oi(e,r),en(e)):Oi(cr,r.stateNode));break;case 4:o=cr,l=un,cr=r.stateNode.containerInfo,un=!0,ks(e,t,r),cr=o,un=l;break;case 0:case 11:case 14:case 15:if(!yr&&(o=r.updateQueue,o!==null&&(o=o.lastEffect,o!==null))){l=o=o.next;do{var c=l,g=c.destroy;c=c.tag,g!==void 0&&((c&2)!==0||(c&4)!==0)&&vu(r,t,g),l=l.next}while(l!==o)}ks(e,t,r);break;case 1:if(!yr&&(Uo(r,t),o=r.stateNode,typeof o.componentWillUnmount=="function"))try{o.props=r.memoizedProps,o.state=r.memoizedState,o.componentWillUnmount()}catch(P){Kt(r,t,P)}ks(e,t,r);break;case 21:ks(e,t,r);break;case 22:r.mode&1?(yr=(o=yr)||r.memoizedState!==null,ks(e,t,r),yr=o):ks(e,t,r);break;default:ks(e,t,r)}}function qd(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new gh),t.forEach(function(o){var l=Ch.bind(null,e,o);r.has(o)||(r.add(o),o.then(l,l))})}}function cn(e,t){var r=t.deletions;if(r!==null)for(var o=0;o<r.length;o++){var l=r[o];try{var c=e,g=t,P=g;e:for(;P!==null;){switch(P.tag){case 5:cr=P.stateNode,un=!1;break e;case 3:cr=P.stateNode.containerInfo,un=!0;break e;case 4:cr=P.stateNode.containerInfo,un=!0;break e}P=P.return}if(cr===null)throw Error(f(160));Wd(c,g,l),cr=null,un=!1;var A=l.alternate;A!==null&&(A.return=null),l.return=null}catch(ee){Kt(l,t,ee)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Hd(t,e),t=t.sibling}function Hd(e,t){var r=e.alternate,o=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(cn(t,e),En(e),o&4){try{Pa(3,e,e.return),Kl(3,e)}catch($e){Kt(e,e.return,$e)}try{Pa(5,e,e.return)}catch($e){Kt(e,e.return,$e)}}break;case 1:cn(t,e),En(e),o&512&&r!==null&&Uo(r,r.return);break;case 5:if(cn(t,e),En(e),o&512&&r!==null&&Uo(r,r.return),e.flags&32){var l=e.stateNode;try{vt(l,"")}catch($e){Kt(e,e.return,$e)}}if(o&4&&(l=e.stateNode,l!=null)){var c=e.memoizedProps,g=r!==null?r.memoizedProps:c,P=e.type,A=e.updateQueue;if(e.updateQueue=null,A!==null)try{P==="input"&&c.type==="radio"&&c.name!=null&&Vt(l,c),W(P,g);var ee=W(P,c);for(g=0;g<A.length;g+=2){var ye=A[g],ve=A[g+1];ye==="style"?Re(l,ve):ye==="dangerouslySetInnerHTML"?Qt(l,ve):ye==="children"?vt(l,ve):oe(l,ye,ve,ee)}switch(P){case"input":Cr(l,c);break;case"textarea":Ct(l,c);break;case"select":var ge=l._wrapperState.wasMultiple;l._wrapperState.wasMultiple=!!c.multiple;var ze=c.value;ze!=null?Nt(l,!!c.multiple,ze,!1):ge!==!!c.multiple&&(c.defaultValue!=null?Nt(l,!!c.multiple,c.defaultValue,!0):Nt(l,!!c.multiple,c.multiple?[]:"",!1))}l[ya]=c}catch($e){Kt(e,e.return,$e)}}break;case 6:if(cn(t,e),En(e),o&4){if(e.stateNode===null)throw Error(f(162));l=e.stateNode,c=e.memoizedProps;try{l.nodeValue=c}catch($e){Kt(e,e.return,$e)}}break;case 3:if(cn(t,e),En(e),o&4&&r!==null&&r.memoizedState.isDehydrated)try{en(t.containerInfo)}catch($e){Kt(e,e.return,$e)}break;case 4:cn(t,e),En(e);break;case 13:cn(t,e),En(e),l=e.child,l.flags&8192&&(c=l.memoizedState!==null,l.stateNode.isHidden=c,!c||l.alternate!==null&&l.alternate.memoizedState!==null||(Su=jt())),o&4&&qd(e);break;case 22:if(ye=r!==null&&r.memoizedState!==null,e.mode&1?(yr=(ee=yr)||ye,cn(t,e),yr=ee):cn(t,e),En(e),o&8192){if(ee=e.memoizedState!==null,(e.stateNode.isHidden=ee)&&!ye&&(e.mode&1)!==0)for(Ie=e,ye=e.child;ye!==null;){for(ve=Ie=ye;Ie!==null;){switch(ge=Ie,ze=ge.child,ge.tag){case 0:case 11:case 14:case 15:Pa(4,ge,ge.return);break;case 1:Uo(ge,ge.return);var Ue=ge.stateNode;if(typeof Ue.componentWillUnmount=="function"){o=ge,r=ge.return;try{t=o,Ue.props=t.memoizedProps,Ue.state=t.memoizedState,Ue.componentWillUnmount()}catch($e){Kt(o,r,$e)}}break;case 5:Uo(ge,ge.return);break;case 22:if(ge.memoizedState!==null){Gd(ve);continue}}ze!==null?(ze.return=ge,Ie=ze):Gd(ve)}ye=ye.sibling}e:for(ye=null,ve=e;;){if(ve.tag===5){if(ye===null){ye=ve;try{l=ve.stateNode,ee?(c=l.style,typeof c.setProperty=="function"?c.setProperty("display","none","important"):c.display="none"):(P=ve.stateNode,A=ve.memoizedProps.style,g=A!=null&&A.hasOwnProperty("display")?A.display:null,P.style.display=Er("display",g))}catch($e){Kt(e,e.return,$e)}}}else if(ve.tag===6){if(ye===null)try{ve.stateNode.nodeValue=ee?"":ve.memoizedProps}catch($e){Kt(e,e.return,$e)}}else if((ve.tag!==22&&ve.tag!==23||ve.memoizedState===null||ve===e)&&ve.child!==null){ve.child.return=ve,ve=ve.child;continue}if(ve===e)break e;for(;ve.sibling===null;){if(ve.return===null||ve.return===e)break e;ye===ve&&(ye=null),ve=ve.return}ye===ve&&(ye=null),ve.sibling.return=ve.return,ve=ve.sibling}}break;case 19:cn(t,e),En(e),o&4&&qd(e);break;case 21:break;default:cn(t,e),En(e)}}function En(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(Kd(r)){var o=r;break e}r=r.return}throw Error(f(160))}switch(o.tag){case 5:var l=o.stateNode;o.flags&32&&(vt(l,""),o.flags&=-33);var c=Vd(e);ju(e,c,l);break;case 3:case 4:var g=o.stateNode.containerInfo,P=Vd(e);wu(e,P,g);break;default:throw Error(f(161))}}catch(A){Kt(e,e.return,A)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function yh(e,t,r){Ie=e,Qd(e)}function Qd(e,t,r){for(var o=(e.mode&1)!==0;Ie!==null;){var l=Ie,c=l.child;if(l.tag===22&&o){var g=l.memoizedState!==null||$l;if(!g){var P=l.alternate,A=P!==null&&P.memoizedState!==null||yr;P=$l;var ee=yr;if($l=g,(yr=A)&&!ee)for(Ie=l;Ie!==null;)g=Ie,A=g.child,g.tag===22&&g.memoizedState!==null?Xd(l):A!==null?(A.return=g,Ie=A):Xd(l);for(;c!==null;)Ie=c,Qd(c),c=c.sibling;Ie=l,$l=P,yr=ee}Yd(e)}else(l.subtreeFlags&8772)!==0&&c!==null?(c.return=l,Ie=c):Yd(e)}}function Yd(e){for(;Ie!==null;){var t=Ie;if((t.flags&8772)!==0){var r=t.alternate;try{if((t.flags&8772)!==0)switch(t.tag){case 0:case 11:case 15:yr||Kl(5,t);break;case 1:var o=t.stateNode;if(t.flags&4&&!yr)if(r===null)o.componentDidMount();else{var l=t.elementType===t.type?r.memoizedProps:ln(t.type,r.memoizedProps);o.componentDidUpdate(l,r.memoizedState,o.__reactInternalSnapshotBeforeUpdate)}var c=t.updateQueue;c!==null&&Gc(t,c,o);break;case 3:var g=t.updateQueue;if(g!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}Gc(t,g,r)}break;case 5:var P=t.stateNode;if(r===null&&t.flags&4){r=P;var A=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":A.autoFocus&&r.focus();break;case"img":A.src&&(r.src=A.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var ee=t.alternate;if(ee!==null){var ye=ee.memoizedState;if(ye!==null){var ve=ye.dehydrated;ve!==null&&en(ve)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(f(163))}yr||t.flags&512&&bu(t)}catch(ge){Kt(t,t.return,ge)}}if(t===e){Ie=null;break}if(r=t.sibling,r!==null){r.return=t.return,Ie=r;break}Ie=t.return}}function Gd(e){for(;Ie!==null;){var t=Ie;if(t===e){Ie=null;break}var r=t.sibling;if(r!==null){r.return=t.return,Ie=r;break}Ie=t.return}}function Xd(e){for(;Ie!==null;){var t=Ie;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{Kl(4,t)}catch(A){Kt(t,r,A)}break;case 1:var o=t.stateNode;if(typeof o.componentDidMount=="function"){var l=t.return;try{o.componentDidMount()}catch(A){Kt(t,l,A)}}var c=t.return;try{bu(t)}catch(A){Kt(t,c,A)}break;case 5:var g=t.return;try{bu(t)}catch(A){Kt(t,g,A)}}}catch(A){Kt(t,t.return,A)}if(t===e){Ie=null;break}var P=t.sibling;if(P!==null){P.return=t.return,Ie=P;break}Ie=t.return}}var vh=Math.ceil,Vl=ce.ReactCurrentDispatcher,ku=ce.ReactCurrentOwner,Qr=ce.ReactCurrentBatchConfig,bt=0,ar=null,Gt=null,dr=0,Br=0,$o=ys(0),er=0,Ta=null,to=0,Wl=0,Nu=0,Ra=null,Dr=null,Su=0,Ko=1/0,Gn=null,ql=!1,Cu=null,Ns=null,Hl=!1,Ss=null,Ql=0,Da=0,_u=null,Yl=-1,Gl=0;function kr(){return(bt&6)!==0?jt():Yl!==-1?Yl:Yl=jt()}function Cs(e){return(e.mode&1)===0?1:(bt&2)!==0&&dr!==0?dr&-dr:rh.transition!==null?(Gl===0&&(Gl=On()),Gl):(e=xt,e!==0||(e=window.event,e=e===void 0?16:Ks(e.type)),e)}function dn(e,t,r,o){if(50<Da)throw Da=0,_u=null,Error(f(185));Mn(e,r,o),((bt&2)===0||e!==ar)&&(e===ar&&((bt&2)===0&&(Wl|=r),er===4&&_s(e,dr)),Ar(e,o),r===1&&bt===0&&(t.mode&1)===0&&(Ko=jt()+500,Nl&&bs()))}function Ar(e,t){var r=e.callbackNode;zs(e,t);var o=Fs(e,e===ar?dr:0);if(o===0)r!==null&&fo(r),e.callbackNode=null,e.callbackPriority=0;else if(t=o&-o,e.callbackPriority!==t){if(r!=null&&fo(r),t===1)e.tag===0?th(Zd.bind(null,e)):zc(Zd.bind(null,e)),Xp(function(){(bt&6)===0&&bs()}),r=null;else{switch(Zo(o)){case 1:r=yn;break;case 4:r=Ls;break;case 16:r=ns;break;case 536870912:r=vn;break;default:r=ns}r=lf(r,Jd.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function Jd(e,t){if(Yl=-1,Gl=0,(bt&6)!==0)throw Error(f(327));var r=e.callbackNode;if(Vo()&&e.callbackNode!==r)return null;var o=Fs(e,e===ar?dr:0);if(o===0)return null;if((o&30)!==0||(o&e.expiredLanes)!==0||t)t=Xl(e,o);else{t=o;var l=bt;bt|=2;var c=tf();(ar!==e||dr!==t)&&(Gn=null,Ko=jt()+500,no(e,t));do try{jh();break}catch(P){ef(e,P)}while(!0);Wi(),Vl.current=c,bt=l,Gt!==null?t=0:(ar=null,dr=0,t=er)}if(t!==0){if(t===2&&(l=Ln(e),l!==0&&(o=l,t=Eu(e,l))),t===1)throw r=Ta,no(e,0),_s(e,o),Ar(e,jt()),r;if(t===6)_s(e,o);else{if(l=e.current.alternate,(o&30)===0&&!bh(l)&&(t=Xl(e,o),t===2&&(c=Ln(e),c!==0&&(o=c,t=Eu(e,c))),t===1))throw r=Ta,no(e,0),_s(e,o),Ar(e,jt()),r;switch(e.finishedWork=l,e.finishedLanes=o,t){case 0:case 1:throw Error(f(345));case 2:so(e,Dr,Gn);break;case 3:if(_s(e,o),(o&130023424)===o&&(t=Su+500-jt(),10<t)){if(Fs(e,0)!==0)break;if(l=e.suspendedLanes,(l&o)!==o){kr(),e.pingedLanes|=e.suspendedLanes&l;break}e.timeoutHandle=Li(so.bind(null,e,Dr,Gn),t);break}so(e,Dr,Gn);break;case 4:if(_s(e,o),(o&4194240)===o)break;for(t=e.eventTimes,l=-1;0<o;){var g=31-ot(o);c=1<<g,g=t[g],g>l&&(l=g),o&=~c}if(o=l,o=jt()-o,o=(120>o?120:480>o?480:1080>o?1080:1920>o?1920:3e3>o?3e3:4320>o?4320:1960*vh(o/1960))-o,10<o){e.timeoutHandle=Li(so.bind(null,e,Dr,Gn),o);break}so(e,Dr,Gn);break;case 5:so(e,Dr,Gn);break;default:throw Error(f(329))}}}return Ar(e,jt()),e.callbackNode===r?Jd.bind(null,e):null}function Eu(e,t){var r=Ra;return e.current.memoizedState.isDehydrated&&(no(e,t).flags|=256),e=Xl(e,t),e!==2&&(t=Dr,Dr=r,t!==null&&Pu(t)),e}function Pu(e){Dr===null?Dr=e:Dr.push.apply(Dr,e)}function bh(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var o=0;o<r.length;o++){var l=r[o],c=l.getSnapshot;l=l.value;try{if(!$(c(),l))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function _s(e,t){for(t&=~Nu,t&=~Wl,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-ot(t),o=1<<r;e[r]=-1,t&=~o}}function Zd(e){if((bt&6)!==0)throw Error(f(327));Vo();var t=Fs(e,0);if((t&1)===0)return Ar(e,jt()),null;var r=Xl(e,t);if(e.tag!==0&&r===2){var o=Ln(e);o!==0&&(t=o,r=Eu(e,o))}if(r===1)throw r=Ta,no(e,0),_s(e,t),Ar(e,jt()),r;if(r===6)throw Error(f(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,so(e,Dr,Gn),Ar(e,jt()),null}function Tu(e,t){var r=bt;bt|=1;try{return e(t)}finally{bt=r,bt===0&&(Ko=jt()+500,Nl&&bs())}}function ro(e){Ss!==null&&Ss.tag===0&&(bt&6)===0&&Vo();var t=bt;bt|=1;var r=Qr.transition,o=xt;try{if(Qr.transition=null,xt=1,e)return e()}finally{xt=o,Qr.transition=r,bt=t,(bt&6)===0&&bs()}}function Ru(){Br=$o.current,At($o)}function no(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,Gp(r)),Gt!==null)for(r=Gt.return;r!==null;){var o=r;switch(Bi(o),o.tag){case 1:o=o.type.childContextTypes,o!=null&&jl();break;case 3:Io(),At(Pr),At(mr),Zi();break;case 5:Xi(o);break;case 4:Io();break;case 13:At(Bt);break;case 19:At(Bt);break;case 10:qi(o.type._context);break;case 22:case 23:Ru()}r=r.return}if(ar=e,Gt=e=Es(e.current,null),dr=Br=t,er=0,Ta=null,Nu=Wl=to=0,Dr=Ra=null,Js!==null){for(t=0;t<Js.length;t++)if(r=Js[t],o=r.interleaved,o!==null){r.interleaved=null;var l=o.next,c=r.pending;if(c!==null){var g=c.next;c.next=l,o.next=g}r.pending=o}Js=null}return e}function ef(e,t){do{var r=Gt;try{if(Wi(),Ll.current=zl,Ol){for(var o=Ut.memoizedState;o!==null;){var l=o.queue;l!==null&&(l.pending=null),o=o.next}Ol=!1}if(eo=0,or=Zt=Ut=null,Na=!1,Sa=0,ku.current=null,r===null||r.return===null){er=1,Ta=t,Gt=null;break}e:{var c=e,g=r.return,P=r,A=t;if(t=dr,P.flags|=32768,A!==null&&typeof A=="object"&&typeof A.then=="function"){var ee=A,ye=P,ve=ye.tag;if((ye.mode&1)===0&&(ve===0||ve===11||ve===15)){var ge=ye.alternate;ge?(ye.updateQueue=ge.updateQueue,ye.memoizedState=ge.memoizedState,ye.lanes=ge.lanes):(ye.updateQueue=null,ye.memoizedState=null)}var ze=Sd(g);if(ze!==null){ze.flags&=-257,Cd(ze,g,P,c,t),ze.mode&1&&Nd(c,ee,t),t=ze,A=ee;var Ue=t.updateQueue;if(Ue===null){var $e=new Set;$e.add(A),t.updateQueue=$e}else Ue.add(A);break e}else{if((t&1)===0){Nd(c,ee,t),Du();break e}A=Error(f(426))}}else if(Ot&&P.mode&1){var qt=Sd(g);if(qt!==null){(qt.flags&65536)===0&&(qt.flags|=256),Cd(qt,g,P,c,t),Ki(Bo(A,P));break e}}c=A=Bo(A,P),er!==4&&(er=2),Ra===null?Ra=[c]:Ra.push(c),c=g;do{switch(c.tag){case 3:c.flags|=65536,t&=-t,c.lanes|=t;var q=jd(c,A,t);Yc(c,q);break e;case 1:P=A;var U=c.type,Q=c.stateNode;if((c.flags&128)===0&&(typeof U.getDerivedStateFromError=="function"||Q!==null&&typeof Q.componentDidCatch=="function"&&(Ns===null||!Ns.has(Q)))){c.flags|=65536,t&=-t,c.lanes|=t;var Ne=kd(c,P,t);Yc(c,Ne);break e}}c=c.return}while(c!==null)}nf(r)}catch(He){t=He,Gt===r&&r!==null&&(Gt=r=r.return);continue}break}while(!0)}function tf(){var e=Vl.current;return Vl.current=zl,e===null?zl:e}function Du(){(er===0||er===3||er===2)&&(er=4),ar===null||(to&268435455)===0&&(Wl&268435455)===0||_s(ar,dr)}function Xl(e,t){var r=bt;bt|=2;var o=tf();(ar!==e||dr!==t)&&(Gn=null,no(e,t));do try{wh();break}catch(l){ef(e,l)}while(!0);if(Wi(),bt=r,Vl.current=o,Gt!==null)throw Error(f(261));return ar=null,dr=0,er}function wh(){for(;Gt!==null;)rf(Gt)}function jh(){for(;Gt!==null&&!zt();)rf(Gt)}function rf(e){var t=af(e.alternate,e,Br);e.memoizedProps=e.pendingProps,t===null?nf(e):Gt=t,ku.current=null}function nf(e){var t=e;do{var r=t.alternate;if(e=t.return,(t.flags&32768)===0){if(r=hh(r,t,Br),r!==null){Gt=r;return}}else{if(r=mh(r,t),r!==null){r.flags&=32767,Gt=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{er=6,Gt=null;return}}if(t=t.sibling,t!==null){Gt=t;return}Gt=t=e}while(t!==null);er===0&&(er=5)}function so(e,t,r){var o=xt,l=Qr.transition;try{Qr.transition=null,xt=1,kh(e,t,r,o)}finally{Qr.transition=l,xt=o}return null}function kh(e,t,r,o){do Vo();while(Ss!==null);if((bt&6)!==0)throw Error(f(327));r=e.finishedWork;var l=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(f(177));e.callbackNode=null,e.callbackPriority=0;var c=r.lanes|r.childLanes;if(ho(e,c),e===ar&&(Gt=ar=null,dr=0),(r.subtreeFlags&2064)===0&&(r.flags&2064)===0||Hl||(Hl=!0,lf(ns,function(){return Vo(),null})),c=(r.flags&15990)!==0,(r.subtreeFlags&15990)!==0||c){c=Qr.transition,Qr.transition=null;var g=xt;xt=1;var P=bt;bt|=4,ku.current=null,xh(e,r),Hd(r,e),H(Di),Us=!!Ri,Di=Ri=null,e.current=r,yh(r),An(),bt=P,xt=g,Qr.transition=c}else e.current=r;if(Hl&&(Hl=!1,Ss=e,Ql=l),c=e.pendingLanes,c===0&&(Ns=null),Ja(r.stateNode),Ar(e,jt()),t!==null)for(o=e.onRecoverableError,r=0;r<t.length;r++)l=t[r],o(l.value,{componentStack:l.stack,digest:l.digest});if(ql)throw ql=!1,e=Cu,Cu=null,e;return(Ql&1)!==0&&e.tag!==0&&Vo(),c=e.pendingLanes,(c&1)!==0?e===_u?Da++:(Da=0,_u=e):Da=0,bs(),null}function Vo(){if(Ss!==null){var e=Zo(Ql),t=Qr.transition,r=xt;try{if(Qr.transition=null,xt=16>e?16:e,Ss===null)var o=!1;else{if(e=Ss,Ss=null,Ql=0,(bt&6)!==0)throw Error(f(331));var l=bt;for(bt|=4,Ie=e.current;Ie!==null;){var c=Ie,g=c.child;if((Ie.flags&16)!==0){var P=c.deletions;if(P!==null){for(var A=0;A<P.length;A++){var ee=P[A];for(Ie=ee;Ie!==null;){var ye=Ie;switch(ye.tag){case 0:case 11:case 15:Pa(8,ye,c)}var ve=ye.child;if(ve!==null)ve.return=ye,Ie=ve;else for(;Ie!==null;){ye=Ie;var ge=ye.sibling,ze=ye.return;if($d(ye),ye===ee){Ie=null;break}if(ge!==null){ge.return=ze,Ie=ge;break}Ie=ze}}}var Ue=c.alternate;if(Ue!==null){var $e=Ue.child;if($e!==null){Ue.child=null;do{var qt=$e.sibling;$e.sibling=null,$e=qt}while($e!==null)}}Ie=c}}if((c.subtreeFlags&2064)!==0&&g!==null)g.return=c,Ie=g;else e:for(;Ie!==null;){if(c=Ie,(c.flags&2048)!==0)switch(c.tag){case 0:case 11:case 15:Pa(9,c,c.return)}var q=c.sibling;if(q!==null){q.return=c.return,Ie=q;break e}Ie=c.return}}var U=e.current;for(Ie=U;Ie!==null;){g=Ie;var Q=g.child;if((g.subtreeFlags&2064)!==0&&Q!==null)Q.return=g,Ie=Q;else e:for(g=U;Ie!==null;){if(P=Ie,(P.flags&2048)!==0)try{switch(P.tag){case 0:case 11:case 15:Kl(9,P)}}catch(He){Kt(P,P.return,He)}if(P===g){Ie=null;break e}var Ne=P.sibling;if(Ne!==null){Ne.return=P.return,Ie=Ne;break e}Ie=P.return}}if(bt=l,bs(),vr&&typeof vr.onPostCommitFiberRoot=="function")try{vr.onPostCommitFiberRoot(Os,e)}catch{}o=!0}return o}finally{xt=r,Qr.transition=t}}return!1}function sf(e,t,r){t=Bo(r,t),t=jd(e,t,1),e=js(e,t,1),t=kr(),e!==null&&(Mn(e,1,t),Ar(e,t))}function Kt(e,t,r){if(e.tag===3)sf(e,e,r);else for(;t!==null;){if(t.tag===3){sf(t,e,r);break}else if(t.tag===1){var o=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof o.componentDidCatch=="function"&&(Ns===null||!Ns.has(o))){e=Bo(r,e),e=kd(t,e,1),t=js(t,e,1),e=kr(),t!==null&&(Mn(t,1,e),Ar(t,e));break}}t=t.return}}function Nh(e,t,r){var o=e.pingCache;o!==null&&o.delete(t),t=kr(),e.pingedLanes|=e.suspendedLanes&r,ar===e&&(dr&r)===r&&(er===4||er===3&&(dr&130023424)===dr&&500>jt()-Su?no(e,0):Nu|=r),Ar(e,t)}function of(e,t){t===0&&((e.mode&1)===0?t=1:(t=Ms,Ms<<=1,(Ms&130023424)===0&&(Ms=4194304)));var r=kr();e=Hn(e,t),e!==null&&(Mn(e,t,r),Ar(e,r))}function Sh(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),of(e,r)}function Ch(e,t){var r=0;switch(e.tag){case 13:var o=e.stateNode,l=e.memoizedState;l!==null&&(r=l.retryLane);break;case 19:o=e.stateNode;break;default:throw Error(f(314))}o!==null&&o.delete(t),of(e,r)}var af;af=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Pr.current)Rr=!0;else{if((e.lanes&r)===0&&(t.flags&128)===0)return Rr=!1,ph(e,t,r);Rr=(e.flags&131072)!==0}else Rr=!1,Ot&&(t.flags&1048576)!==0&&Ic(t,Cl,t.index);switch(t.lanes=0,t.tag){case 2:var o=t.type;Ul(e,t),e=t.pendingProps;var l=Do(t,mr.current);zo(t,r),l=ru(null,t,o,e,l,r);var c=nu();return t.flags|=1,typeof l=="object"&&l!==null&&typeof l.render=="function"&&l.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Tr(o)?(c=!0,kl(t)):c=!1,t.memoizedState=l.state!==null&&l.state!==void 0?l.state:null,Yi(t),l.updater=Il,t.stateNode=l,l._reactInternals=t,uu(t,o,e,r),t=pu(null,t,o,!0,c,r)):(t.tag=0,Ot&&c&&Ii(t),jr(null,t,l,r),t=t.child),t;case 16:o=t.elementType;e:{switch(Ul(e,t),e=t.pendingProps,l=o._init,o=l(o._payload),t.type=o,l=t.tag=Eh(o),e=ln(o,e),l){case 0:t=fu(null,t,o,e,r);break e;case 1:t=Dd(null,t,o,e,r);break e;case 11:t=_d(null,t,o,e,r);break e;case 14:t=Ed(null,t,o,ln(o.type,e),r);break e}throw Error(f(306,o,""))}return t;case 0:return o=t.type,l=t.pendingProps,l=t.elementType===o?l:ln(o,l),fu(e,t,o,l,r);case 1:return o=t.type,l=t.pendingProps,l=t.elementType===o?l:ln(o,l),Dd(e,t,o,l,r);case 3:e:{if(Ad(t),e===null)throw Error(f(387));o=t.pendingProps,c=t.memoizedState,l=c.element,Qc(e,t),Dl(t,o,null,r);var g=t.memoizedState;if(o=g.element,c.isDehydrated)if(c={element:o,isDehydrated:!1,cache:g.cache,pendingSuspenseBoundaries:g.pendingSuspenseBoundaries,transitions:g.transitions},t.updateQueue.baseState=c,t.memoizedState=c,t.flags&256){l=Bo(Error(f(423)),t),t=Ld(e,t,o,r,l);break e}else if(o!==l){l=Bo(Error(f(424)),t),t=Ld(e,t,o,r,l);break e}else for(Ir=xs(t.stateNode.containerInfo.firstChild),zr=t,Ot=!0,an=null,r=qc(t,null,o,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Oo(),o===l){t=Yn(e,t,r);break e}jr(e,t,o,r)}t=t.child}return t;case 5:return Xc(t),e===null&&$i(t),o=t.type,l=t.pendingProps,c=e!==null?e.memoizedProps:null,g=l.children,Ai(o,l)?g=null:c!==null&&Ai(o,c)&&(t.flags|=32),Rd(e,t),jr(e,t,g,r),t.child;case 6:return e===null&&$i(t),null;case 13:return Od(e,t,r);case 4:return Gi(t,t.stateNode.containerInfo),o=t.pendingProps,e===null?t.child=Mo(t,null,o,r):jr(e,t,o,r),t.child;case 11:return o=t.type,l=t.pendingProps,l=t.elementType===o?l:ln(o,l),_d(e,t,o,l,r);case 7:return jr(e,t,t.pendingProps,r),t.child;case 8:return jr(e,t,t.pendingProps.children,r),t.child;case 12:return jr(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(o=t.type._context,l=t.pendingProps,c=t.memoizedProps,g=l.value,Pt(Pl,o._currentValue),o._currentValue=g,c!==null)if($(c.value,g)){if(c.children===l.children&&!Pr.current){t=Yn(e,t,r);break e}}else for(c=t.child,c!==null&&(c.return=t);c!==null;){var P=c.dependencies;if(P!==null){g=c.child;for(var A=P.firstContext;A!==null;){if(A.context===o){if(c.tag===1){A=Qn(-1,r&-r),A.tag=2;var ee=c.updateQueue;if(ee!==null){ee=ee.shared;var ye=ee.pending;ye===null?A.next=A:(A.next=ye.next,ye.next=A),ee.pending=A}}c.lanes|=r,A=c.alternate,A!==null&&(A.lanes|=r),Hi(c.return,r,t),P.lanes|=r;break}A=A.next}}else if(c.tag===10)g=c.type===t.type?null:c.child;else if(c.tag===18){if(g=c.return,g===null)throw Error(f(341));g.lanes|=r,P=g.alternate,P!==null&&(P.lanes|=r),Hi(g,r,t),g=c.sibling}else g=c.child;if(g!==null)g.return=c;else for(g=c;g!==null;){if(g===t){g=null;break}if(c=g.sibling,c!==null){c.return=g.return,g=c;break}g=g.return}c=g}jr(e,t,l.children,r),t=t.child}return t;case 9:return l=t.type,o=t.pendingProps.children,zo(t,r),l=qr(l),o=o(l),t.flags|=1,jr(e,t,o,r),t.child;case 14:return o=t.type,l=ln(o,t.pendingProps),l=ln(o.type,l),Ed(e,t,o,l,r);case 15:return Pd(e,t,t.type,t.pendingProps,r);case 17:return o=t.type,l=t.pendingProps,l=t.elementType===o?l:ln(o,l),Ul(e,t),t.tag=1,Tr(o)?(e=!0,kl(t)):e=!1,zo(t,r),bd(t,o,l),uu(t,o,l,r),pu(null,t,o,!0,e,r);case 19:return Fd(e,t,r);case 22:return Td(e,t,r)}throw Error(f(156,t.tag))};function lf(e,t){return Xo(e,t)}function _h(e,t,r,o){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=o,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Yr(e,t,r,o){return new _h(e,t,r,o)}function Au(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Eh(e){if(typeof e=="function")return Au(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Ge)return 11;if(e===lt)return 14}return 2}function Es(e,t){var r=e.alternate;return r===null?(r=Yr(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Jl(e,t,r,o,l,c){var g=2;if(o=e,typeof e=="function")Au(e)&&(g=1);else if(typeof e=="string")g=5;else e:switch(e){case de:return oo(r.children,l,c,t);case Pe:g=8,l|=8;break;case Be:return e=Yr(12,r,t,l|2),e.elementType=Be,e.lanes=c,e;case Te:return e=Yr(13,r,t,l),e.elementType=Te,e.lanes=c,e;case et:return e=Yr(19,r,t,l),e.elementType=et,e.lanes=c,e;case ae:return Zl(r,l,c,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Ye:g=10;break e;case We:g=9;break e;case Ge:g=11;break e;case lt:g=14;break e;case it:g=16,o=null;break e}throw Error(f(130,e==null?e:typeof e,""))}return t=Yr(g,r,t,l),t.elementType=e,t.type=o,t.lanes=c,t}function oo(e,t,r,o){return e=Yr(7,e,o,t),e.lanes=r,e}function Zl(e,t,r,o){return e=Yr(22,e,o,t),e.elementType=ae,e.lanes=r,e.stateNode={isHidden:!1},e}function Lu(e,t,r){return e=Yr(6,e,null,t),e.lanes=r,e}function Ou(e,t,r){return t=Yr(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Ph(e,t,r,o,l){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Is(0),this.expirationTimes=Is(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Is(0),this.identifierPrefix=o,this.onRecoverableError=l,this.mutableSourceEagerHydrationData=null}function Mu(e,t,r,o,l,c,g,P,A){return e=new Ph(e,t,r,P,A),t===1?(t=1,c===!0&&(t|=8)):t=0,c=Yr(3,null,null,t),e.current=c,c.stateNode=e,c.memoizedState={element:o,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Yi(c),e}function Th(e,t,r){var o=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:je,key:o==null?null:""+o,children:e,containerInfo:t,implementation:r}}function uf(e){if(!e)return vs;e=e._reactInternals;e:{if(hr(e)!==e||e.tag!==1)throw Error(f(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Tr(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(f(171))}if(e.tag===1){var r=e.type;if(Tr(r))return Mc(e,r,t)}return t}function cf(e,t,r,o,l,c,g,P,A){return e=Mu(r,o,!0,e,l,c,g,P,A),e.context=uf(null),r=e.current,o=kr(),l=Cs(r),c=Qn(o,l),c.callback=t??null,js(r,c,l),e.current.lanes=l,Mn(e,l,o),Ar(e,o),e}function ei(e,t,r,o){var l=t.current,c=kr(),g=Cs(l);return r=uf(r),t.context===null?t.context=r:t.pendingContext=r,t=Qn(c,g),t.payload={element:e},o=o===void 0?null:o,o!==null&&(t.callback=o),e=js(l,t,g),e!==null&&(dn(e,l,g,c),Rl(e,l,g)),g}function ti(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function df(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function Fu(e,t){df(e,t),(e=e.alternate)&&df(e,t)}function Rh(){return null}var ff=typeof reportError=="function"?reportError:function(e){console.error(e)};function zu(e){this._internalRoot=e}ri.prototype.render=zu.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(f(409));ei(e,t,null,null)},ri.prototype.unmount=zu.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;ro(function(){ei(null,e,null,null)}),t[Kn]=null}};function ri(e){this._internalRoot=e}ri.prototype.unstable_scheduleHydration=function(e){if(e){var t=rl();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Jt.length&&t!==0&&t<Jt[r].priority;r++);Jt.splice(r,0,e),r===0&&sl(e)}};function Iu(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function ni(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function pf(){}function Dh(e,t,r,o,l){if(l){if(typeof o=="function"){var c=o;o=function(){var ee=ti(g);c.call(ee)}}var g=cf(t,o,e,0,null,!1,!1,"",pf);return e._reactRootContainer=g,e[Kn]=g.current,ga(e.nodeType===8?e.parentNode:e),ro(),g}for(;l=e.lastChild;)e.removeChild(l);if(typeof o=="function"){var P=o;o=function(){var ee=ti(A);P.call(ee)}}var A=Mu(e,0,!1,null,null,!1,!1,"",pf);return e._reactRootContainer=A,e[Kn]=A.current,ga(e.nodeType===8?e.parentNode:e),ro(function(){ei(t,A,r,o)}),A}function si(e,t,r,o,l){var c=r._reactRootContainer;if(c){var g=c;if(typeof l=="function"){var P=l;l=function(){var A=ti(g);P.call(A)}}ei(t,g,e,l)}else g=Dh(r,t,e,l,o);return ti(g)}tl=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=ss(t.pendingLanes);r!==0&&(mo(t,r|1),Ar(t,jt()),(bt&6)===0&&(Ko=jt()+500,bs()))}break;case 13:ro(function(){var o=Hn(e,1);if(o!==null){var l=kr();dn(o,e,1,l)}}),Fu(e,1)}},mt=function(e){if(e.tag===13){var t=Hn(e,134217728);if(t!==null){var r=kr();dn(t,e,134217728,r)}Fu(e,134217728)}},ea=function(e){if(e.tag===13){var t=Cs(e),r=Hn(e,t);if(r!==null){var o=kr();dn(r,e,t,o)}Fu(e,t)}},rl=function(){return xt},nl=function(e,t){var r=xt;try{return xt=e,t()}finally{xt=r}},ue=function(e,t,r){switch(t){case"input":if(Cr(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var o=r[t];if(o!==e&&o.form===e.form){var l=wl(o);if(!l)throw Error(f(90));ct(o),Cr(o,l)}}}break;case"textarea":Ct(e,r);break;case"select":t=r.value,t!=null&&Nt(e,!!r.multiple,t,!1)}},Qa=Tu,Ya=ro;var Ah={usingClientEntryPoint:!1,Events:[va,To,wl,Wt,co,Tu]},Aa={findFiberByHostInstance:Qs,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Lh={bundleType:Aa.bundleType,version:Aa.version,rendererPackageName:Aa.rendererPackageName,rendererConfig:Aa.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ce.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Go(e),e===null?null:e.stateNode},findFiberByHostInstance:Aa.findFiberByHostInstance||Rh,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var oi=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!oi.isDisabled&&oi.supportsFiber)try{Os=oi.inject(Lh),vr=oi}catch{}}return Lr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Ah,Lr.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Iu(t))throw Error(f(200));return Th(e,t,null,r)},Lr.createRoot=function(e,t){if(!Iu(e))throw Error(f(299));var r=!1,o="",l=ff;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(o=t.identifierPrefix),t.onRecoverableError!==void 0&&(l=t.onRecoverableError)),t=Mu(e,1,!1,null,null,r,!1,o,l),e[Kn]=t.current,ga(e.nodeType===8?e.parentNode:e),new zu(t)},Lr.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(f(188)):(e=Object.keys(e).join(","),Error(f(268,e)));return e=Go(t),e=e===null?null:e.stateNode,e},Lr.flushSync=function(e){return ro(e)},Lr.hydrate=function(e,t,r){if(!ni(t))throw Error(f(200));return si(null,e,t,!0,r)},Lr.hydrateRoot=function(e,t,r){if(!Iu(e))throw Error(f(405));var o=r!=null&&r.hydratedSources||null,l=!1,c="",g=ff;if(r!=null&&(r.unstable_strictMode===!0&&(l=!0),r.identifierPrefix!==void 0&&(c=r.identifierPrefix),r.onRecoverableError!==void 0&&(g=r.onRecoverableError)),t=cf(t,null,e,1,r??null,l,!1,c,g),e[Kn]=t.current,ga(e),o)for(e=0;e<o.length;e++)r=o[e],l=r._getVersion,l=l(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,l]:t.mutableSourceEagerHydrationData.push(r,l);return new ri(t)},Lr.render=function(e,t,r){if(!ni(t))throw Error(f(200));return si(null,e,t,!1,r)},Lr.unmountComponentAtNode=function(e){if(!ni(e))throw Error(f(40));return e._reactRootContainer?(ro(function(){si(null,null,e,!1,function(){e._reactRootContainer=null,e[Kn]=null})}),!0):!1},Lr.unstable_batchedUpdates=Tu,Lr.unstable_renderSubtreeIntoContainer=function(e,t,r,o){if(!ni(r))throw Error(f(200));if(e==null||e._reactInternals===void 0)throw Error(f(38));return si(e,t,r,!1,o)},Lr.version="18.3.1-next-f1338f8080-20240426",Lr}var wf;function Kh(){if(wf)return $u.exports;wf=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(p){console.error(p)}}return i(),$u.exports=$h(),$u.exports}var jf;function Vh(){if(jf)return ai;jf=1;var i=Kh();return ai.createRoot=i.createRoot,ai.hydrateRoot=i.hydrateRoot,ai}var Wh=Vh();const qh=uc(Wh);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Hh={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qh=i=>i.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),Ve=(i,p)=>{const f=j.forwardRef(({color:x="currentColor",size:C=24,strokeWidth:y=2,absoluteStrokeWidth:_,className:E="",children:S,...L},R)=>j.createElement("svg",{ref:R,...Hh,width:C,height:C,stroke:x,strokeWidth:_?Number(y)*24/Number(C):y,className:["lucide",`lucide-${Qh(i)}`,E].join(" "),...L},[...p.map(([J,V])=>j.createElement(J,V)),...Array.isArray(S)?S:[S]]));return f.displayName=`${i}`,f};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dc=Ve("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fc=Ve("ArrowDownUp",[["path",{d:"m3 16 4 4 4-4",key:"1co6wj"}],["path",{d:"M7 20V4",key:"1yoxec"}],["path",{d:"m21 8-4-4-4 4",key:"1c9v7m"}],["path",{d:"M17 4v16",key:"7dpous"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pc=Ve("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ua=Ve("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hc=Ve("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yh=Ve("BarChart2",[["line",{x1:"18",x2:"18",y1:"20",y2:"10",key:"1xfpm4"}],["line",{x1:"12",x2:"12",y1:"20",y2:"4",key:"be30l9"}],["line",{x1:"6",x2:"6",y1:"20",y2:"14",key:"1r4le6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jf=Ve("BookMarked",[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H20v20H6.5a2.5 2.5 0 0 1 0-5H20",key:"t4utmx"}],["polyline",{points:"10 2 10 10 13 7 16 10 16 2",key:"13o6vz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gh=Ve("BookOpenCheck",[["path",{d:"M8 3H2v15h7c1.7 0 3 1.3 3 3V7c0-2.2-1.8-4-4-4Z",key:"1i8u0n"}],["path",{d:"m16 12 2 2 4-4",key:"mdajum"}],["path",{d:"M22 6V3h-6c-2.2 0-4 1.8-4 4v14c0-1.7 1.3-3 3-3h7v-2.3",key:"jb5l51"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sr=Ve("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zf=Ve("Book",[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H20v20H6.5a2.5 2.5 0 0 1 0-5H20",key:"t4utmx"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xh=Ve("Bug",[["path",{d:"m8 2 1.88 1.88",key:"fmnt4t"}],["path",{d:"M14.12 3.88 16 2",key:"qol33r"}],["path",{d:"M9 7.13v-1a3.003 3.003 0 1 1 6 0v1",key:"d7y7pr"}],["path",{d:"M12 20c-3.3 0-6-2.7-6-6v-3a4 4 0 0 1 4-4h4a4 4 0 0 1 4 4v3c0 3.3-2.7 6-6 6",key:"xs1cw7"}],["path",{d:"M12 20v-9",key:"1qisl0"}],["path",{d:"M6.53 9C4.6 8.8 3 7.1 3 5",key:"32zzws"}],["path",{d:"M6 13H2",key:"82j7cp"}],["path",{d:"M3 21c0-2.1 1.7-3.9 3.8-4",key:"4p0ekp"}],["path",{d:"M20.97 5c0 2.1-1.6 3.8-3.5 4",key:"18gb23"}],["path",{d:"M22 13h-4",key:"1jl80f"}],["path",{d:"M17.2 17c2.1.1 3.8 1.9 3.8 4",key:"k3fwyw"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xi=Ve("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ia=Ve("CalendarDays",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $a=Ve("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ci=Ve("CheckCircle2",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jh=Ve("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ep=Ve("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zu=Ve("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zh=Ve("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const io=Ve("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const em=Ve("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tm=Ve("Delete",[["path",{d:"M20 5H9l-7 7 7 7h11a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2Z",key:"1oy587"}],["line",{x1:"18",x2:"12",y1:"9",y2:"15",key:"1olkx5"}],["line",{x1:"12",x2:"18",y1:"9",y2:"15",key:"1n50pc"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rm=Ve("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nm=Ve("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ec=Ve("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tp=Ve("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rp=Ve("Ghost",[["path",{d:"M9 10h.01",key:"qbtxuw"}],["path",{d:"M15 10h.01",key:"1qmjsl"}],["path",{d:"M12 2a8 8 0 0 0-8 8v12l3-3 2.5 2.5L12 19l2.5 2.5L17 19l3 3V10a8 8 0 0 0-8-8z",key:"uwwb07"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sm=Ve("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const om=Ve("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yi=Ve("Headphones",[["path",{d:"M3 14h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-7a9 9 0 0 1 18 0v7a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3",key:"1xhozi"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vi=Ve("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const np=Ve("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mc=Ve("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const di=Ve("Library",[["path",{d:"m16 6 4 14",key:"ji33uf"}],["path",{d:"M12 6v14",key:"1n7gus"}],["path",{d:"M8 8v12",key:"1gg7y9"}],["path",{d:"M4 4v16",key:"6qkkli"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gc=Ve("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xr=Ve("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sp=Ve("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const am=Ve("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lm=Ve("Pause",[["rect",{width:"4",height:"16",x:"6",y:"4",key:"iffhe4"}],["rect",{width:"4",height:"16",x:"14",y:"4",key:"sjin7j"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const op=Ve("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const im=Ve("Pencil",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ap=Ve("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xc=Ve("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const um=Ve("RefreshCcw",[["path",{d:"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"14sxne"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16",key:"1hlbsb"}],["path",{d:"M16 16h5v5",key:"ccwih5"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ka=Ve("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yc=Ve("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cm=Ve("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dm=Ve("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fm=Ve("ShoppingBag",[["path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z",key:"hou9p0"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lp=Ve("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ip=Ve("Smile",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pm=Ve("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hm=Ve("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bi=Ve("Tablet",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["line",{x1:"12",x2:"12.01",y1:"18",y2:"18",key:"1dp563"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const up=Ve("Tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Va=Ve("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vc=Ve("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cp=Ve("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wa=Ve("Wand2",[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72Z",key:"1bcowg"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ur=Ve("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bc=Ve("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]),wc=i=>{try{const p=i.split(","),f=p[0].match(/:(.*?);/),x=f?f[1]:"image/jpeg",C=atob(p[1]);let y=C.length;const _=new Uint8Array(y);for(;y--;)_[y]=C.charCodeAt(y);return new Blob([_],{type:x})}catch(p){return console.error("Failed to convert Base64 to Blob",p),new Blob([],{type:"image/jpeg"})}},mm=i=>new Promise((p,f)=>{const x=new FileReader;x.onloadend=()=>p(x.result),x.onerror=f,x.readAsDataURL(i)}),jc=i=>new Promise((p,f)=>{const x=new FileReader;x.readAsDataURL(i),x.onload=C=>{var _;const y=new Image;y.src=(_=C.target)==null?void 0:_.result,y.onload=()=>{const E=document.createElement("canvas"),S=800,L=1200;let R=y.width,J=y.height;R>J?R>S&&(J*=S/R,R=S):J>L&&(R*=L/J,J=L),E.width=R,E.height=J;const V=E.getContext("2d");V==null||V.drawImage(y,0,0,R,J),E.toBlob(se=>{se?p(se):f(new Error("Canvas to Blob failed"))},"image/jpeg",.7)},y.onerror=E=>f(E)},x.onerror=C=>f(C)}),gm=100,Wo=new Map,kf=(i,p)=>{if(Wo.size>=gm){const f=Wo.keys().next().value;f&&Wo.delete(f)}Wo.set(i,p)};let Nf=0;const Xn=i=>i.replace(/\s+/g," ").trim(),Gr=i=>Xn(i).toLowerCase().normalize("NFKD").replace(/[\u0300-\u036f]/g,"").replace(/[^\p{L}\p{N}\s]+/gu," "),tc=i=>{const p=Gr(i);return p?p.split(/\s+/).filter(Boolean):[]},Sf=(i,p)=>{const f=tc(i);if(f.length===0)return 0;const x=new Set(tc(p));if(x.size===0)return 0;let C=0;for(const y of f)x.has(y)&&(C+=1);return C/f.length},dp=i=>`https://books.google.com/books/content?id=${encodeURIComponent(i)}&printsec=frontcover&img=1&zoom=1&edge=curl&source=gbs_api`,xm=[{title:"",author:" ",volumeId:"E4LgEAAAQBAJ"},{title:"     ",author:" ",volumeId:"ybFUEQAAQBAJ"}],ym=i=>i==="google"?8:i==="openlibrary"?6:4,vm={:"a",:"b",:"v",:"h",:"g",:"d",:"e",:"ye",:"zh",:"z",:"y",:"i",:"yi",:"i",:"k",:"l",:"m",:"n",:"o",:"p",:"r",:"s",:"t",:"u",:"f",:"kh",:"ts",:"ch",:"sh",:"shch",:"",:"yu",:"ya",:"",:"y",:"e",:"yo"},Cf=i=>{let p="";for(const f of i.toLowerCase())p+=vm[f]??f;return Xn(p)},bm=(i,p,f)=>{const x=Gr(i),C=Gr(p),y=Gr(f.title),_=Gr(f.author);let E=0;if(E+=Sf(x,y)*80,x&&y&&y.includes(x)&&(E+=30),x&&y&&x.includes(y)&&y.length>=6&&(E+=10),C){E+=Sf(C,_)*20;const S=tc(C),L=S.length>0?S[S.length-1]:"";L&&_.includes(L)&&(E+=8),_&&C&&(_.includes(C)||C.includes(_))&&(E+=6)}return E+=ym(f.source),f.url.includes("books.google.com/books/content?id=")&&(E+=3),E},_f=(i,p,f)=>{if(f.length===0)return"";const x=f.map(C=>({candidate:C,score:bm(i,p,C)}));return x.sort((C,y)=>y.score-C.score),x[0].candidate.url},Ef=i=>{const p=new Map;for(const f of i){if(!f.url)continue;const x=f.url.trim();x&&(p.has(x)||p.set(x,f))}return Array.from(p.values())},fp=async(i,p=5e3)=>{const f=new AbortController,x=setTimeout(()=>f.abort(),p);try{const C=await fetch(i,{signal:f.signal});return clearTimeout(x),C}catch(C){throw clearTimeout(x),C}},Pf=async(i,p=10)=>{var f,x,C;try{if(Date.now()<Nf)return[];const y=await fp(`https://www.googleapis.com/books/v1/volumes?q=${encodeURIComponent(i)}&maxResults=${p}&printType=books`);if(!y.ok)return y.status===429&&(Nf=Date.now()+20*1e3),[];const _=await y.json(),E=Array.isArray(_==null?void 0:_.items)?_.items:[],S=[];for(const L of E){const R=((f=L==null?void 0:L.volumeInfo)==null?void 0:f.title)||"",J=Array.isArray((x=L==null?void 0:L.volumeInfo)==null?void 0:x.authors)?L.volumeInfo.authors.join(", "):"",V=(C=L==null?void 0:L.volumeInfo)==null?void 0:C.imageLinks,se=(V==null?void 0:V.thumbnail)||(V==null?void 0:V.smallThumbnail)||(L!=null&&L.id?dp(L.id):"");se&&S.push({url:String(se).replace("http://","https://"),title:String(R||""),author:String(J||""),source:"google"})}return S}catch{return[]}},pp=i=>i!=null&&i.cover_i?`https://covers.openlibrary.org/b/id/${i.cover_i}-L.jpg`:"",Tf=async(i,p)=>{try{if(!i)return[];const f=new URLSearchParams({title:i,limit:"25"});p&&f.set("author",p);const x=await fetch(`https://openlibrary.org/search.json?${f.toString()}`);if(!x.ok)return[];const C=await x.json();return(Array.isArray(C==null?void 0:C.docs)?C.docs:[]).map(_=>{const E=pp(_);if(!E)return null;const S=Array.isArray(_==null?void 0:_.author_name)?_.author_name.join(", "):"";return{url:E,title:String((_==null?void 0:_.title)||""),author:String(S||""),source:"openlibrary"}}).filter(Boolean)}catch{return[]}},Rf=async i=>{try{if(!i)return[];const p=new URLSearchParams({q:i,limit:"25"}),f=await fetch(`https://openlibrary.org/search.json?${p.toString()}`);if(!f.ok)return[];const x=await f.json();return(Array.isArray(x==null?void 0:x.docs)?x.docs:[]).map(y=>{const _=pp(y);if(!_)return null;const E=Array.isArray(y==null?void 0:y.author_name)?y.author_name.join(", "):"";return{url:_,title:String((y==null?void 0:y.title)||""),author:String(E||""),source:"openlibrary"}}).filter(Boolean)}catch{return[]}},wm=async i=>{try{const p=await fp(`https://itunes.apple.com/search?term=${encodeURIComponent(i)}&media=ebook&entity=ebook&limit=12`);if(!p.ok)return[];const f=await p.json();return(Array.isArray(f==null?void 0:f.results)?f.results:[]).map(C=>{const y=C==null?void 0:C.artworkUrl100;return y?{url:String(y).replace("100x100","600x600"),title:String((C==null?void 0:C.trackName)||""),author:String((C==null?void 0:C.artistName)||""),source:"itunes"}:null}).filter(Boolean)}catch{return[]}},jm=new Set(["unknown author"," "," "," "]),km=i=>{const p=Gr(i);return p?jm.has(p):!0},Nm=(i,p,f)=>`${Gr(i)}|${Gr(p)}|${f}`,Sm=(i,p)=>{const f=Gr(i);if(!f)return"";const x=Gr(p);for(const C of xm){const y=Gr(C.title),_=Gr(C.author);if(!(!(f===y||f.includes(y)||y.includes(f))||!(!x||x===_||x.includes(_)||_.includes(x))))return dp(C.volumeId)}return""},Qo=async(i,p,f)=>{let x=Xn(i);const C=Xn(p);let y=km(C)?"":C;const _=Xn(f||"").replace(/[^0-9X]/gi,"");if(!y){const de=x.split("+").map(Xn).filter(Boolean);de.length>=2&&(x=de[0],y=de.slice(1).join(" "))}if(!x&&!_)return"";const E=Sm(x,y);if(E)return E;const S=Nm(x,y,_);if(Wo.has(S))return Wo.get(S)||"";const L=[];if(_){const de=await Pf(`isbn:${_}`,8);L.push(...de)}const R=y?y.split(/\s+/).filter(Boolean):[],J=R.length>0?R[R.length-1]:"",V=`${x} ${y}`.trim(),se=Cf(x),he=Cf(y),fe=Xn(`${se} ${he}`),X=[y?`intitle:"${x}" inauthor:"${y}"`:"",y?`intitle:${x} inauthor:${J||y}`:"",y?`"${x}" "${y}"`:"",V,x,fe,se].map(de=>Xn(de)).filter(Boolean),Z=Array.from(new Set(X)).slice(0,4);for(const de of Z){const Pe=await Pf(de,10);if(Pe.length>0&&L.push(...Pe),L.length>0){const Be=_f(x,y,Ef(L));if(Be)return kf(S,Be),Be}}if(x){const[de,Pe,Be,Ye]=await Promise.all([Tf(x,y),Rf(V||x),Tf(x,""),fe?Rf(fe):Promise.resolve([])]);L.push(...de,...Pe,...Be,...Ye)}const oe=[V||x,fe,se].map(Xn).filter(Boolean),ce=Array.from(new Set(oe)).slice(0,3);if(ce.length>0){const de=await Promise.all(ce.map(Pe=>wm(Pe)));for(const Pe of de)L.push(...Pe)}const ie=Ef(L),je=_f(x,y,ie);return kf(S,je||""),je||""},fn=()=>{try{if(typeof crypto<"u"&&typeof crypto.getRandomValues=="function"){const f=new Uint8Array(16);return crypto.getRandomValues(f),`id-${Array.from(f,C=>C.toString(16).padStart(2,"0")).join("")}`}}catch{}const i=Date.now().toString(36),p=Math.random().toString(36).slice(2,12);return`id-${i}-${p}`},hp="libra_debug_mode",kc="libra_debug_logs",mp="libra_debug_runtime",rc=300;let Df=!1,Af=0,Lf=null,Of=null,lo=null,fi=!1,nc=!1,Ts=[];const gp=()=>(Af+=1,`dbg-${Date.now().toString(36)}-${Af.toString(36)}`),sc=i=>{if(i instanceof Error)return`${i.name}: ${i.message}
${i.stack||""}`.trim();if(typeof i=="string")return i;if(typeof i=="number"||typeof i=="boolean"||i===null)return String(i);try{return JSON.stringify(i)}catch{return String(i)}},Cm=()=>{try{const i=localStorage.getItem(kc);if(!i)return[];const p=JSON.parse(i);return Array.isArray(p)?p:[]}catch{return[]}},_m=i=>{try{localStorage.setItem(kc,JSON.stringify(i.slice(-rc)))}catch{}},Nc=()=>{nc||(Ts=Cm(),nc=!0)},oc=()=>{fi=!1,nc&&_m(Ts)},Em=()=>{fi||(fi=!0,lo!==null&&window.clearTimeout(lo),lo=window.setTimeout(()=>{lo=null,oc()},1200))},xp=()=>{try{return localStorage.getItem(hp)==="1"}catch{return!1}},Pm=i=>{try{localStorage.setItem(hp,i?"1":"0")}catch{}rr("info","debug.mode",i?"enabled":"disabled")},Mf=()=>(Nc(),[...Ts]),Tm=()=>{Nc(),Ts=[],fi=!1,lo!==null&&(window.clearTimeout(lo),lo=null);try{localStorage.removeItem(kc)}catch{}},rr=(i,p,f,x)=>{if(!xp())return;Nc();const C={id:gp(),ts:new Date().toISOString(),level:i,scope:p,message:f,details:x===void 0?void 0:sc(x)};Ts.push(C),Ts.length>rc&&(Ts=Ts.slice(-rc)),Em()},Rm=(i,p,f)=>({scope:i,action:p,startedAt:performance.now(),details:f}),Ff=(i,p="info",f)=>{const x=Math.round(performance.now()-i.startedAt);rr(p,i.scope,`${i.action} finished`,{durationMs:x,...i.details===void 0?{}:{startDetails:i.details},...f===void 0?{}:{details:f}})},Wu=()=>{try{const i=localStorage.getItem(mp);return i?JSON.parse(i):null}catch{return null}},qu=i=>{try{localStorage.setItem(mp,JSON.stringify(i))}catch{}},Dm=()=>{if(Lf!==null||Of!==null)return;const i=new Date().toISOString(),p=Wu();if(p&&p.cleanShutdown===!1){const E=Date.now()-new Date(p.lastHeartbeatAt).getTime();Number.isFinite(E)&&E>1e4&&rr("warn","runtime.recover","Detected possible previous app freeze/crash",{previousSessionId:p.sessionId,noHeartbeatMs:E})}const f={sessionId:gp(),startedAt:i,lastHeartbeatAt:i,cleanShutdown:!1};qu(f),Lf=window.setInterval(()=>{const E=Wu();E&&qu({...E,lastHeartbeatAt:new Date().toISOString(),cleanShutdown:!1})},2e3);let x=performance.now()+1e3,C=Date.now();const y=()=>{document.visibilityState==="visible"&&(C=Date.now())};document.addEventListener("visibilitychange",y),Of=window.setInterval(()=>{if(document.visibilityState!=="visible"){x=performance.now()+1e3;return}const E=performance.now(),S=Math.round(E-x);x=E+1e3,!(Date.now()-C<2e3)&&S>1500&&rr("warn","runtime.eventloop","Main thread lag spike detected",{driftMs:S})},1e3);const _=()=>{const E=Wu();E&&qu({...E,lastHeartbeatAt:new Date().toISOString(),cleanShutdown:!0})};window.addEventListener("pagehide",_),window.addEventListener("beforeunload",_),window.addEventListener("pagehide",oc),window.addEventListener("beforeunload",oc)},Am=()=>{if(Df)return;Df=!0;const i=console.error.bind(console),p=console.warn.bind(console);console.error=(...f)=>{try{const[x,...C]=f;rr("error","console.error",sc(x),C.length?C:void 0)}catch{}i(...f)},console.warn=(...f)=>{try{const[x,...C]=f;rr("warn","console.warn",sc(x),C.length?C:void 0)}catch{}p(...f)},window.addEventListener("error",f=>{rr("error","window.error",f.message||"Unknown error",f.error)}),window.addEventListener("unhandledrejection",f=>{rr("error","unhandledrejection","Unhandled promise rejection",f.reason)}),Dm()};var ui={exports:{}},Lm=ui.exports,zf;function Om(){return zf||(zf=1,(function(i,p){((f,x)=>{i.exports=x()})(Lm,function(){var f=function(s,a){return(f=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(u,d){u.__proto__=d}:function(u,d){for(var h in d)Object.prototype.hasOwnProperty.call(d,h)&&(u[h]=d[h])}))(s,a)},x=function(){return(x=Object.assign||function(s){for(var a,u=1,d=arguments.length;u<d;u++)for(var h in a=arguments[u])Object.prototype.hasOwnProperty.call(a,h)&&(s[h]=a[h]);return s}).apply(this,arguments)};function C(s,a,u){for(var d,h=0,m=a.length;h<m;h++)!d&&h in a||((d=d||Array.prototype.slice.call(a,0,h))[h]=a[h]);return s.concat(d||Array.prototype.slice.call(a))}var y=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:Mh,_=Object.keys,E=Array.isArray;function S(s,a){return typeof a=="object"&&_(a).forEach(function(u){s[u]=a[u]}),s}typeof Promise>"u"||y.Promise||(y.Promise=Promise);var L=Object.getPrototypeOf,R={}.hasOwnProperty;function J(s,a){return R.call(s,a)}function V(s,a){typeof a=="function"&&(a=a(L(s))),(typeof Reflect>"u"?_:Reflect.ownKeys)(a).forEach(function(u){he(s,u,a[u])})}var se=Object.defineProperty;function he(s,a,u,d){se(s,a,S(u&&J(u,"get")&&typeof u.get=="function"?{get:u.get,set:u.set,configurable:!0}:{value:u,configurable:!0,writable:!0},d))}function fe(s){return{from:function(a){return s.prototype=Object.create(a.prototype),he(s.prototype,"constructor",s),{extend:V.bind(null,s.prototype)}}}}var X=Object.getOwnPropertyDescriptor,Z=[].slice;function te(s,a,u){return Z.call(s,a,u)}function oe(s,a){return a(s)}function ce(s){if(!s)throw new Error("Assertion Failed")}function ie(s){y.setImmediate?setImmediate(s):setTimeout(s,0)}function je(s,a){if(typeof a=="string"&&J(s,a))return s[a];if(!a)return s;if(typeof a!="string"){for(var u=[],d=0,h=a.length;d<h;++d){var m=je(s,a[d]);u.push(m)}return u}var b,k=a.indexOf(".");return k===-1||(b=s[a.substr(0,k)])==null?void 0:je(b,a.substr(k+1))}function de(s,a,u){if(s&&a!==void 0&&!("isFrozen"in Object&&Object.isFrozen(s)))if(typeof a!="string"&&"length"in a){ce(typeof u!="string"&&"length"in u);for(var d=0,h=a.length;d<h;++d)de(s,a[d],u[d])}else{var m,b,k=a.indexOf(".");k!==-1?(m=a.substr(0,k),(k=a.substr(k+1))===""?u===void 0?E(s)&&!isNaN(parseInt(m))?s.splice(m,1):delete s[m]:s[m]=u:de(b=(b=s[m])&&J(s,m)?b:s[m]={},k,u)):u===void 0?E(s)&&!isNaN(parseInt(a))?s.splice(a,1):delete s[a]:s[a]=u}}function Pe(s){var a,u={};for(a in s)J(s,a)&&(u[a]=s[a]);return u}var Be=[].concat;function Ye(s){return Be.apply([],s)}var N="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(Ye([8,16,32,64].map(function(s){return["Int","Uint","Float"].map(function(a){return a+s+"Array"})}))).filter(function(s){return y[s]}),We=new Set(N.map(function(s){return y[s]})),Ge=null;function Te(s){return Ge=new WeakMap,s=(function a(u){if(!u||typeof u!="object")return u;var d=Ge.get(u);if(d)return d;if(E(u)){d=[],Ge.set(u,d);for(var h=0,m=u.length;h<m;++h)d.push(a(u[h]))}else if(We.has(u.constructor))d=u;else{var b,k=L(u);for(b in d=k===Object.prototype?{}:Object.create(k),Ge.set(u,d),u)J(u,b)&&(d[b]=a(u[b]))}return d})(s),Ge=null,s}var et={}.toString;function lt(s){return et.call(s).slice(8,-1)}var it=typeof Symbol<"u"?Symbol.iterator:"@@iterator",ae=typeof it=="symbol"?function(s){var a;return s!=null&&(a=s[it])&&a.apply(s)}:function(){return null};function G(s,a){a=s.indexOf(a),0<=a&&s.splice(a,1)}var T={};function v(s){var a,u,d,h;if(arguments.length===1){if(E(s))return s.slice();if(this===T&&typeof s=="string")return[s];if(h=ae(s))for(u=[];!(d=h.next()).done;)u.push(d.value);else{if(s==null)return[s];if(typeof(a=s.length)!="number")return[s];for(u=new Array(a);a--;)u[a]=s[a]}}else for(a=arguments.length,u=new Array(a);a--;)u[a]=arguments[a];return u}var w=typeof Symbol<"u"?function(s){return s[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},N=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],rt=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(N),re={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function pe(s,a){this.name=s,this.message=a}function be(s,a){return s+". Errors: "+Object.keys(a).map(function(u){return a[u].toString()}).filter(function(u,d,h){return h.indexOf(u)===d}).join(`
`)}function Oe(s,a,u,d){this.failures=a,this.failedKeys=d,this.successCount=u,this.message=be(s,a)}function Ke(s,a){this.name="BulkError",this.failures=Object.keys(a).map(function(u){return a[u]}),this.failuresByPos=a,this.message=be(s,this.failures)}fe(pe).from(Error).extend({toString:function(){return this.name+": "+this.message}}),fe(Oe).from(pe),fe(Ke).from(pe);var qe=rt.reduce(function(s,a){return s[a]=a+"Error",s},{}),tt=pe,Se=rt.reduce(function(s,a){var u=a+"Error";function d(h,m){this.name=u,h?typeof h=="string"?(this.message="".concat(h).concat(m?`
 `+m:""),this.inner=m||null):typeof h=="object"&&(this.message="".concat(h.name," ").concat(h.message),this.inner=h):(this.message=re[a]||u,this.inner=null)}return fe(d).from(tt),s[a]=d,s},{}),Ht=(Se.Syntax=SyntaxError,Se.Type=TypeError,Se.Range=RangeError,N.reduce(function(s,a){return s[a+"Error"]=Se[a],s},{}));N=rt.reduce(function(s,a){return["Syntax","Type","Range"].indexOf(a)===-1&&(s[a+"Error"]=Se[a]),s},{});function ct(){}function Mt(s){return s}function fr(s,a){return s==null||s===Mt?a:function(u){return a(s(u))}}function Me(s,a){return function(){s.apply(this,arguments),a.apply(this,arguments)}}function Vt(s,a){return s===ct?a:function(){var u=s.apply(this,arguments),d=(u!==void 0&&(arguments[0]=u),this.onsuccess),h=this.onerror,m=(this.onsuccess=null,this.onerror=null,a.apply(this,arguments));return d&&(this.onsuccess=this.onsuccess?Me(d,this.onsuccess):d),h&&(this.onerror=this.onerror?Me(h,this.onerror):h),m!==void 0?m:u}}function Cr(s,a){return s===ct?a:function(){s.apply(this,arguments);var u=this.onsuccess,d=this.onerror;this.onsuccess=this.onerror=null,a.apply(this,arguments),u&&(this.onsuccess=this.onsuccess?Me(u,this.onsuccess):u),d&&(this.onerror=this.onerror?Me(d,this.onerror):d)}}function Mr(s,a){return s===ct?a:function(h){var d=s.apply(this,arguments),h=(S(h,d),this.onsuccess),m=this.onerror,b=(this.onsuccess=null,this.onerror=null,a.apply(this,arguments));return h&&(this.onsuccess=this.onsuccess?Me(h,this.onsuccess):h),m&&(this.onerror=this.onerror?Me(m,this.onerror):m),d===void 0?b===void 0?void 0:b:S(d,b)}}function _r(s,a){return s===ct?a:function(){return a.apply(this,arguments)!==!1&&s.apply(this,arguments)}}function Xt(s,a){return s===ct?a:function(){var u=s.apply(this,arguments);if(u&&typeof u.then=="function"){for(var d=this,h=arguments.length,m=new Array(h);h--;)m[h]=arguments[h];return u.then(function(){return a.apply(d,m)})}return a.apply(this,arguments)}}N.ModifyError=Oe,N.DexieError=pe,N.BulkError=Ke;var Nt=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function we(s){Nt=s}var Ze={},Ct=100,ft=typeof Promise>"u"?[]:(rt=Promise.resolve(),typeof crypto<"u"&&crypto.subtle?[ft=crypto.subtle.digest("SHA-512",new Uint8Array([0])),L(ft),rt]:[rt,L(rt),rt]),rt=ft[0],Bn=ft[1],Bn=Bn&&Bn.then,Ft=rt&&rt.constructor,Tt=!!ft[2],Qt=function(s,a){W.push([s,a]),$t&&(queueMicrotask(Ya),$t=!1)},vt=!0,$t=!0,pr=[],Er=[],Re=Mt,nt={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:ct,pgp:!1,env:{},finalize:ct},Ce=nt,W=[],ne=0,Fe=[];function ue(s){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var a=this._PSD=Ce;if(typeof s!="function"){if(s!==Ze)throw new TypeError("Not a function");this._state=arguments[1],this._value=arguments[2],this._state===!1&&Rt(this,this._value)}else this._state=null,this._value=null,++a.ref,(function u(d,h){try{h(function(m){if(d._state===null){if(m===d)throw new TypeError("A promise cannot be resolved with itself.");var b=d._lib&&hn();m&&typeof m.then=="function"?u(d,function(k,z){m instanceof ue?m._then(k,z):m.then(k,z)}):(d._state=!0,d._value=m,Wt(d)),b&&Pn()}},Rt.bind(null,d))}catch(m){Rt(d,m)}})(this,s)}var ut={get:function(){var s=Ce,a=ts;function u(d,h){var m=this,b=!s.global&&(s!==Ce||a!==ts),k=b&&!hr(),z=new ue(function($,O){co(m,new st(Xo(d,s,b,k),Xo(h,s,b,k),$,O,s))});return this._consoleTask&&(z._consoleTask=this._consoleTask),z}return u.prototype=Ze,u},set:function(s){he(this,"then",s&&s.prototype===Ze?ut:{get:function(){return s},set:ut.set})}};function st(s,a,u,d,h){this.onFulfilled=typeof s=="function"?s:null,this.onRejected=typeof a=="function"?a:null,this.resolve=u,this.reject=d,this.psd=h}function Rt(s,a){var u,d;Er.push(a),s._state===null&&(u=s._lib&&hn(),a=Re(a),s._state=!1,s._value=a,d=s,pr.some(function(h){return h._value===d._value})||pr.push(d),Wt(s),u)&&Pn()}function Wt(s){var a=s._listeners;s._listeners=[];for(var u=0,d=a.length;u<d;++u)co(s,a[u]);var h=s._PSD;--h.ref||h.finalize(),ne===0&&(++ne,Qt(function(){--ne==0&&Tn()},[]))}function co(s,a){if(s._state===null)s._listeners.push(a);else{var u=s._state?a.onFulfilled:a.onRejected;if(u===null)return(s._state?a.resolve:a.reject)(s._value);++a.psd.ref,++ne,Qt(Qa,[u,s,a])}}function Qa(s,a,u){try{var d,h=a._value;!a._state&&Er.length&&(Er=[]),d=Nt&&a._consoleTask?a._consoleTask.run(function(){return s(h)}):s(h),a._state||Er.indexOf(h)!==-1||(m=>{for(var b=pr.length;b;)if(pr[--b]._value===m._value)return pr.splice(b,1)})(a),u.resolve(d)}catch(m){u.reject(m)}finally{--ne==0&&Tn(),--u.psd.ref||u.psd.finalize()}}function Ya(){xn(nt,function(){hn()&&Pn()})}function hn(){var s=vt;return $t=vt=!1,s}function Pn(){var s,a,u;do for(;0<W.length;)for(s=W,W=[],u=s.length,a=0;a<u;++a){var d=s[a];d[0].apply(null,d[1])}while(0<W.length);$t=vt=!0}function Tn(){for(var s=pr,a=(pr=[],s.forEach(function(d){d._PSD.onunhandled.call(null,d._value,d)}),Fe.slice(0)),u=a.length;u;)a[--u]()}function es(s){return new ue(Ze,!1,s)}function St(s,a){var u=Ce;return function(){var d=hn(),h=Ce;try{return gn(u,!0),s.apply(this,arguments)}catch(m){a&&a(m)}finally{gn(h,!1),d&&Pn()}}}V(ue.prototype,{then:ut,_then:function(s,a){co(this,new st(null,null,s,a,Ce))},catch:function(s){var a,u;return arguments.length===1?this.then(null,s):(a=s,u=arguments[1],typeof a=="function"?this.then(null,function(d){return(d instanceof a?u:es)(d)}):this.then(null,function(d){return(d&&d.name===a?u:es)(d)}))},finally:function(s){return this.then(function(a){return ue.resolve(s()).then(function(){return a})},function(a){return ue.resolve(s()).then(function(){return es(a)})})},timeout:function(s,a){var u=this;return s<1/0?new ue(function(d,h){var m=setTimeout(function(){return h(new Se.Timeout(a))},s);u.then(d,h).finally(clearTimeout.bind(null,m))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&he(ue.prototype,Symbol.toStringTag,"Dexie.Promise"),nt.env=Go(),V(ue,{all:function(){var s=v.apply(null,arguments).map(As);return new ue(function(a,u){s.length===0&&a([]);var d=s.length;s.forEach(function(h,m){return ue.resolve(h).then(function(b){s[m]=b,--d||a(s)},u)})})},resolve:function(s){return s instanceof ue?s:s&&typeof s.then=="function"?new ue(function(a,u){s.then(a,u)}):new ue(Ze,!0,s)},reject:es,race:function(){var s=v.apply(null,arguments).map(As);return new ue(function(a,u){s.map(function(d){return ue.resolve(d).then(a,u)})})},PSD:{get:function(){return Ce},set:function(s){return Ce=s}},totalEchoes:{get:function(){return ts}},newPSD:mn,usePSD:xn,scheduler:{get:function(){return Qt},set:function(s){Qt=s}},rejectionMapper:{get:function(){return Re},set:function(s){Re=s}},follow:function(s,a){return new ue(function(u,d){return mn(function(h,m){var b=Ce;b.unhandleds=[],b.onunhandled=m,b.finalize=Me(function(){var k,z=this;k=function(){z.unhandleds.length===0?h():m(z.unhandleds[0])},Fe.push(function $(){k(),Fe.splice(Fe.indexOf($),1)}),++ne,Qt(function(){--ne==0&&Tn()},[])},b.finalize),s()},a,u,d)})}}),Ft&&(Ft.allSettled&&he(ue,"allSettled",function(){var s=v.apply(null,arguments).map(As);return new ue(function(a){s.length===0&&a([]);var u=s.length,d=new Array(u);s.forEach(function(h,m){return ue.resolve(h).then(function(b){return d[m]={status:"fulfilled",value:b}},function(b){return d[m]={status:"rejected",reason:b}}).then(function(){return--u||a(d)})})})}),Ft.any&&typeof AggregateError<"u"&&he(ue,"any",function(){var s=v.apply(null,arguments).map(As);return new ue(function(a,u){s.length===0&&u(new AggregateError([]));var d=s.length,h=new Array(d);s.forEach(function(m,b){return ue.resolve(m).then(function(k){return a(k)},function(k){h[b]=k,--d||u(new AggregateError(h))})})})}),Ft.withResolvers)&&(ue.withResolvers=Ft.withResolvers);var Yt={awaits:0,echoes:0,id:0},Ds=0,Rn=[],Dn=0,ts=0,ki=0;function mn(s,b,u,d){var h=Ce,m=Object.create(h),b=(m.parent=h,m.ref=0,m.global=!1,m.id=++ki,nt.env,m.env=Tt?{Promise:ue,PromiseProp:{value:ue,configurable:!0,writable:!0},all:ue.all,race:ue.race,allSettled:ue.allSettled,any:ue.any,resolve:ue.resolve,reject:ue.reject}:{},b&&S(m,b),++h.ref,m.finalize=function(){--this.parent.ref||this.parent.finalize()},xn(m,s,u,d));return m.ref===0&&m.finalize(),b}function rs(){return Yt.id||(Yt.id=++Ds),++Yt.awaits,Yt.echoes+=Ct,Yt.id}function hr(){return!!Yt.awaits&&(--Yt.awaits==0&&(Yt.id=0),Yt.echoes=Yt.awaits*Ct,!0)}function As(s){return Yt.echoes&&s&&s.constructor===Ft?(rs(),s.then(function(a){return hr(),a},function(a){return hr(),zt(a)})):s}function Ga(){var s=Rn[Rn.length-1];Rn.pop(),gn(s,!1)}function gn(s,a){var u,d,h=Ce;(a?!Yt.echoes||Dn++&&s===Ce:!Dn||--Dn&&s===Ce)||queueMicrotask(a?(function(m){++ts,Yt.echoes&&--Yt.echoes!=0||(Yt.echoes=Yt.awaits=Yt.id=0),Rn.push(Ce),gn(m,!0)}).bind(null,s):Ga),s!==Ce&&(Ce=s,h===nt&&(nt.env=Go()),Tt)&&(u=nt.env.Promise,d=s.env,h.global||s.global)&&(Object.defineProperty(y,"Promise",d.PromiseProp),u.all=d.all,u.race=d.race,u.resolve=d.resolve,u.reject=d.reject,d.allSettled&&(u.allSettled=d.allSettled),d.any)&&(u.any=d.any)}function Go(){var s=y.Promise;return Tt?{Promise:s,PromiseProp:Object.getOwnPropertyDescriptor(y,"Promise"),all:s.all,race:s.race,allSettled:s.allSettled,any:s.any,resolve:s.resolve,reject:s.reject}:{}}function xn(s,a,u,d,h){var m=Ce;try{return gn(s,!0),a(u,d,h)}finally{gn(m,!1)}}function Xo(s,a,u,d){return typeof s!="function"?s:function(){var h=Ce;u&&rs(),gn(a,!0);try{return s.apply(this,arguments)}finally{gn(h,!1),d&&queueMicrotask(hr)}}}function fo(s){Promise===Ft&&Yt.echoes===0?Dn===0?s():enqueueNativeMicroTask(s):setTimeout(s,0)}(""+Bn).indexOf("[native code]")===-1&&(rs=hr=ct);var zt=ue.reject,An="",jt="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Xa="String expected.",yn=[],Ls="__dbnames",ns="readonly",Jo="readwrite";function vn(s,a){return s?a?function(){return s.apply(this,arguments)&&a.apply(this,arguments)}:s:a}var Os={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function vr(s){return typeof s!="string"||/\./.test(s)?function(a){return a}:function(a){return a[s]===void 0&&s in a&&delete(a=Te(a))[s],a}}function Ja(){throw Se.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.")}function ot(s,a){try{var u=Za(s),d=Za(a);if(u!==d)return u==="Array"?1:d==="Array"?-1:u==="binary"?1:d==="binary"?-1:u==="string"?1:d==="string"?-1:u==="Date"?1:d!=="Date"?NaN:-1;switch(u){case"number":case"Date":case"string":return a<s?1:s<a?-1:0;case"binary":for(var h=el(s),m=el(a),b=h.length,k=m.length,z=b<k?b:k,$=0;$<z;++$)if(h[$]!==m[$])return h[$]<m[$]?-1:1;return b===k?0:b<k?-1:1;case"Array":for(var O=s,D=a,I=O.length,B=D.length,F=I<B?I:B,M=0;M<F;++M){var H=ot(O[M],D[M]);if(H!==0)return H}return I===B?0:I<B?-1:1}}catch{}return NaN}function Za(s){var a=typeof s;return a=="object"&&(ArrayBuffer.isView(s)||(a=lt(s))==="ArrayBuffer")?"binary":a}function el(s){return s instanceof Uint8Array?s:ArrayBuffer.isView(s)?new Uint8Array(s.buffer,s.byteOffset,s.byteLength):new Uint8Array(s)}function po(s,a,u){var d=s.schema.yProps;return d?(a&&0<u.numFailures&&(a=a.filter(function(h,m){return!u.failures[m]})),Promise.all(d.map(function(h){return h=h.updatesTable,a?s.db.table(h).where("k").anyOf(a).delete():s.db.table(h).clear()})).then(function(){return u})):u}Ms.prototype.execute=function(s){var a=this["@@propmod"];if(a.add!==void 0){var u=a.add;if(E(u))return C(C([],E(s)?s:[],!0),u).sort();if(typeof u=="number")return(Number(s)||0)+u;if(typeof u=="bigint")try{return BigInt(s)+u}catch{return BigInt(0)+u}throw new TypeError("Invalid term ".concat(u))}if(a.remove!==void 0){var d=a.remove;if(E(d))return E(s)?s.filter(function(h){return!d.includes(h)}).sort():[];if(typeof d=="number")return Number(s)-d;if(typeof d=="bigint")try{return BigInt(s)-d}catch{return BigInt(0)-d}throw new TypeError("Invalid subtrahend ".concat(d))}return u=(u=a.replacePrefix)==null?void 0:u[0],u&&typeof s=="string"&&s.startsWith(u)?a.replacePrefix[1]+s.substring(u.length):s};var bn=Ms;function Ms(s){this["@@propmod"]=s}function ss(s,a){for(var u=_(a),d=u.length,h=!1,m=0;m<d;++m){var b=u[m],k=a[b],z=je(s,b);k instanceof bn?(de(s,b,k.execute(z)),h=!0):z!==k&&(de(s,b,k),h=!0)}return h}_t.prototype._trans=function(s,a,u){var d=this._tx||Ce.trans,h=this.name,m=Nt&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(s==="readonly"?"read":"write"," ").concat(this.name));function b($,O,D){if(D.schema[h])return a(D.idbtrans,D);throw new Se.NotFound("Table "+h+" not part of transaction")}var k=hn();try{var z=d&&d.db._novip===this.db._novip?d===Ce.trans?d._promise(s,b,u):mn(function(){return d._promise(s,b,u)},{trans:d,transless:Ce.transless||Ce}):(function $(O,D,I,B){if(O.idbdb&&(O._state.openComplete||Ce.letThrough||O._vip)){var F=O._createTransaction(D,I,O._dbSchema);try{F.create(),O._state.PR1398_maxLoop=3}catch(M){return M.name===qe.InvalidState&&O.isOpen()&&0<--O._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),O.close({disableAutoOpen:!1}),O.open().then(function(){return $(O,D,I,B)})):zt(M)}return F._promise(D,function(M,H){return mn(function(){return Ce.trans=F,B(M,H,F)})}).then(function(M){if(D==="readwrite")try{F.idbtrans.commit()}catch{}return D==="readonly"?M:F._completion.then(function(){return M})})}if(O._state.openComplete)return zt(new Se.DatabaseClosed(O._state.dbOpenError));if(!O._state.isBeingOpened){if(!O._state.autoOpen)return zt(new Se.DatabaseClosed);O.open().catch(ct)}return O._state.dbReadyPromise.then(function(){return $(O,D,I,B)})})(this.db,s,[this.name],b);return m&&(z._consoleTask=m,z=z.catch(function($){return console.trace($),zt($)})),z}finally{k&&Pn()}},_t.prototype.get=function(s,a){var u=this;return s&&s.constructor===Object?this.where(s).first(a):s==null?zt(new Se.Type("Invalid argument to Table.get()")):this._trans("readonly",function(d){return u.core.get({trans:d,key:s}).then(function(h){return u.hook.reading.fire(h)})}).then(a)},_t.prototype.where=function(s){if(typeof s=="string")return new this.db.WhereClause(this,s);if(E(s))return new this.db.WhereClause(this,"[".concat(s.join("+"),"]"));var a=_(s);if(a.length===1)return this.where(a[0]).equals(s[a[0]]);var u=this.schema.indexes.concat(this.schema.primKey).filter(function(k){if(k.compound&&a.every(function($){return 0<=k.keyPath.indexOf($)})){for(var z=0;z<a.length;++z)if(a.indexOf(k.keyPath[z])===-1)return!1;return!0}return!1}).sort(function(k,z){return k.keyPath.length-z.keyPath.length})[0];if(u&&this.db._maxKey!==An)return b=u.keyPath.slice(0,a.length),this.where(b).equals(b.map(function(k){return s[k]}));!u&&Nt&&console.warn("The query ".concat(JSON.stringify(s)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(a.join("+"),"]"));var d=this.schema.idxByName;function h(k,z){return ot(k,z)===0}var b=a.reduce(function(O,z){var $=O[0],O=O[1],D=d[z],I=s[z];return[$||D,$||!D?vn(O,D&&D.multi?function(B){return B=je(B,z),E(B)&&B.some(function(F){return h(I,F)})}:function(B){return h(I,je(B,z))}):O]},[null,null]),m=b[0],b=b[1];return m?this.where(m.name).equals(s[m.keyPath]).filter(b):u?this.filter(b):this.where(a).equals("")},_t.prototype.filter=function(s){return this.toCollection().and(s)},_t.prototype.count=function(s){return this.toCollection().count(s)},_t.prototype.offset=function(s){return this.toCollection().offset(s)},_t.prototype.limit=function(s){return this.toCollection().limit(s)},_t.prototype.each=function(s){return this.toCollection().each(s)},_t.prototype.toArray=function(s){return this.toCollection().toArray(s)},_t.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},_t.prototype.orderBy=function(s){return new this.db.Collection(new this.db.WhereClause(this,E(s)?"[".concat(s.join("+"),"]"):s))},_t.prototype.reverse=function(){return this.toCollection().reverse()},_t.prototype.mapToClass=function(s){for(var a=this.db,u=this.name,d=((this.schema.mappedClass=s).prototype instanceof Ja&&(s=(b=>{var k=O,z=b;if(typeof z!="function"&&z!==null)throw new TypeError("Class extends value "+String(z)+" is not a constructor or null");function $(){this.constructor=k}function O(){return b!==null&&b.apply(this,arguments)||this}return f(k,z),k.prototype=z===null?Object.create(z):($.prototype=z.prototype,new $),Object.defineProperty(O.prototype,"db",{get:function(){return a},enumerable:!1,configurable:!0}),O.prototype.table=function(){return u},O})(s)),new Set),h=s.prototype;h;h=L(h))Object.getOwnPropertyNames(h).forEach(function(b){return d.add(b)});function m(b){if(!b)return b;var k,z=Object.create(s.prototype);for(k in b)if(!d.has(k))try{z[k]=b[k]}catch{}return z}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=m,this.hook("reading",m),s},_t.prototype.defineClass=function(){return this.mapToClass(function(s){S(this,s)})},_t.prototype.add=function(s,a){var u=this,d=this.schema.primKey,h=d.auto,m=d.keyPath,b=s;return m&&h&&(b=vr(m)(s)),this._trans("readwrite",function(k){return u.core.mutate({trans:k,type:"add",keys:a!=null?[a]:null,values:[b]})}).then(function(k){return k.numFailures?ue.reject(k.failures[0]):k.lastResult}).then(function(k){if(m)try{de(s,m,k)}catch{}return k})},_t.prototype.upsert=function(s,a){var u=this,d=this.schema.primKey.keyPath;return this._trans("readwrite",function(h){return u.core.get({trans:h,key:s}).then(function(m){var b=m??{};return ss(b,a),d&&de(b,d,s),u.core.mutate({trans:h,type:"put",values:[b],keys:[s],upsert:!0,updates:{keys:[s],changeSpecs:[a]}}).then(function(k){return k.numFailures?ue.reject(k.failures[0]):!!m})})})},_t.prototype.update=function(s,a){return typeof s!="object"||E(s)?this.where(":id").equals(s).modify(a):(s=je(s,this.schema.primKey.keyPath))===void 0?zt(new Se.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(s).modify(a)},_t.prototype.put=function(s,a){var u=this,d=this.schema.primKey,h=d.auto,m=d.keyPath,b=s;return m&&h&&(b=vr(m)(s)),this._trans("readwrite",function(k){return u.core.mutate({trans:k,type:"put",values:[b],keys:a!=null?[a]:null})}).then(function(k){return k.numFailures?ue.reject(k.failures[0]):k.lastResult}).then(function(k){if(m)try{de(s,m,k)}catch{}return k})},_t.prototype.delete=function(s){var a=this;return this._trans("readwrite",function(u){return a.core.mutate({trans:u,type:"delete",keys:[s]}).then(function(d){return po(a,[s],d)}).then(function(d){return d.numFailures?ue.reject(d.failures[0]):void 0})})},_t.prototype.clear=function(){var s=this;return this._trans("readwrite",function(a){return s.core.mutate({trans:a,type:"deleteRange",range:Os}).then(function(u){return po(s,null,u)})}).then(function(a){return a.numFailures?ue.reject(a.failures[0]):void 0})},_t.prototype.bulkGet=function(s){var a=this;return this._trans("readonly",function(u){return a.core.getMany({keys:s,trans:u}).then(function(d){return d.map(function(h){return a.hook.reading.fire(h)})})})},_t.prototype.bulkAdd=function(s,a,u){var d=this,h=Array.isArray(a)?a:void 0,m=(u=u||(h?void 0:a))?u.allKeys:void 0;return this._trans("readwrite",function(b){var k=d.schema.primKey,$=k.auto,k=k.keyPath;if(k&&h)throw new Se.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(h&&h.length!==s.length)throw new Se.InvalidArgument("Arguments objects and keys must have the same length");var z=s.length,$=k&&$?s.map(vr(k)):s;return d.core.mutate({trans:b,type:"add",keys:h,values:$,wantResults:m}).then(function(O){var D=O.numFailures,I=O.failures;if(D===0)return m?O.results:O.lastResult;throw new Ke("".concat(d.name,".bulkAdd(): ").concat(D," of ").concat(z," operations failed"),I)})})},_t.prototype.bulkPut=function(s,a,u){var d=this,h=Array.isArray(a)?a:void 0,m=(u=u||(h?void 0:a))?u.allKeys:void 0;return this._trans("readwrite",function(b){var k=d.schema.primKey,$=k.auto,k=k.keyPath;if(k&&h)throw new Se.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(h&&h.length!==s.length)throw new Se.InvalidArgument("Arguments objects and keys must have the same length");var z=s.length,$=k&&$?s.map(vr(k)):s;return d.core.mutate({trans:b,type:"put",keys:h,values:$,wantResults:m}).then(function(O){var D=O.numFailures,I=O.failures;if(D===0)return m?O.results:O.lastResult;throw new Ke("".concat(d.name,".bulkPut(): ").concat(D," of ").concat(z," operations failed"),I)})})},_t.prototype.bulkUpdate=function(s){var a=this,u=this.core,d=s.map(function(b){return b.key}),h=s.map(function(b){return b.changes}),m=[];return this._trans("readwrite",function(b){return u.getMany({trans:b,keys:d,cache:"clone"}).then(function(k){var z=[],$=[],O=(s.forEach(function(D,I){var B=D.key,F=D.changes,M=k[I];if(M){for(var H=0,Y=Object.keys(F);H<Y.length;H++){var K=Y[H],le=F[K];if(K===a.schema.primKey.keyPath){if(ot(le,B)!==0)throw new Se.Constraint("Cannot update primary key in bulkUpdate()")}else de(M,K,le)}m.push(I),z.push(B),$.push(M)}}),z.length);return u.mutate({trans:b,type:"put",keys:z,values:$,updates:{keys:d,changeSpecs:h}}).then(function(D){var I=D.numFailures,B=D.failures;if(I===0)return O;for(var F=0,M=Object.keys(B);F<M.length;F++){var H,Y=M[F],K=m[Number(Y)];K!=null&&(H=B[Y],delete B[Y],B[K]=H)}throw new Ke("".concat(a.name,".bulkUpdate(): ").concat(I," of ").concat(O," operations failed"),B)})})})},_t.prototype.bulkDelete=function(s){var a=this,u=s.length;return this._trans("readwrite",function(d){return a.core.mutate({trans:d,type:"delete",keys:s}).then(function(h){return po(a,s,h)})}).then(function(d){var h=d.numFailures,m=d.failures;if(h===0)return d.lastResult;throw new Ke("".concat(a.name,".bulkDelete(): ").concat(h," of ").concat(u," operations failed"),m)})};var Fs=_t;function _t(){}function zs(s){function a(b,k){if(k){for(var z=arguments.length,$=new Array(z-1);--z;)$[z-1]=arguments[z];return u[b].subscribe.apply(null,$),s}if(typeof b=="string")return u[b]}var u={};a.addEventType=m;for(var d=1,h=arguments.length;d<h;++d)m(arguments[d]);return a;function m(b,k,z){var $,O;if(typeof b!="object")return k=k||_r,O={subscribers:[],fire:z=z||ct,subscribe:function(D){O.subscribers.indexOf(D)===-1&&(O.subscribers.push(D),O.fire=k(O.fire,D))},unsubscribe:function(D){O.subscribers=O.subscribers.filter(function(I){return I!==D}),O.fire=O.subscribers.reduce(k,z)}},u[b]=a[b]=O;_($=b).forEach(function(D){var I=$[D];if(E(I))m(D,$[D][0],$[D][1]);else{if(I!=="asap")throw new Se.InvalidArgument("Invalid event config");var B=m(D,Mt,function(){for(var F=arguments.length,M=new Array(F);F--;)M[F]=arguments[F];B.subscribers.forEach(function(H){ie(function(){H.apply(null,M)})})})}})}}function Ln(s,a){return fe(a).from({prototype:s}),a}function On(s,a){return!(s.filter||s.algorithm||s.or)&&(a?s.justLimit:!s.replayFilter)}function Is(s,a){s.filter=vn(s.filter,a)}function Mn(s,a,u){var d=s.replayFilter;s.replayFilter=d?function(){return vn(d(),a())}:a,s.justLimit=u&&!d}function ho(s,a){if(s.isPrimKey)return a.primaryKey;var u=a.getIndexByKeyPath(s.index);if(u)return u;throw new Se.Schema("KeyPath "+s.index+" on object store "+a.name+" is not indexed")}function mo(s,a,u){var d=ho(s,a.schema);return a.openCursor({trans:u,values:!s.keysOnly,reverse:s.dir==="prev",unique:!!s.unique,query:{index:d,range:s.range}})}function xt(s,a,u,d){var h,m,b=s.replayFilter?vn(s.filter,s.replayFilter()):s.filter;return s.or?(h={},m=function(k,z,$){var O,D;b&&!b(z,$,function(I){return z.stop(I)},function(I){return z.fail(I)})||((D=""+(O=z.primaryKey))=="[object ArrayBuffer]"&&(D=""+new Uint8Array(O)),J(h,D))||(h[D]=!0,a(k,z,$))},Promise.all([s.or._iterate(m,u),Zo(mo(s,d,u),s.algorithm,m,!s.keysOnly&&s.valueMapper)])):Zo(mo(s,d,u),vn(s.algorithm,b),a,!s.keysOnly&&s.valueMapper)}function Zo(s,a,u,d){var h=St(d?function(m,b,k){return u(d(m),b,k)}:u);return s.then(function(m){if(m)return m.start(function(){var b=function(){return m.continue()};a&&!a(m,function(k){return b=k},function(k){m.stop(k),b=ct},function(k){m.fail(k),b=ct})||h(m.value,m,function(k){return b=k}),b()})})}mt.prototype._read=function(s,a){var u=this._ctx;return u.error?u.table._trans(null,zt.bind(null,u.error)):u.table._trans("readonly",s).then(a)},mt.prototype._write=function(s){var a=this._ctx;return a.error?a.table._trans(null,zt.bind(null,a.error)):a.table._trans("readwrite",s,"locked")},mt.prototype._addAlgorithm=function(s){var a=this._ctx;a.algorithm=vn(a.algorithm,s)},mt.prototype._iterate=function(s,a){return xt(this._ctx,s,a,this._ctx.table.core)},mt.prototype.clone=function(s){var a=Object.create(this.constructor.prototype),u=Object.create(this._ctx);return s&&S(u,s),a._ctx=u,a},mt.prototype.raw=function(){return this._ctx.valueMapper=null,this},mt.prototype.each=function(s){var a=this._ctx;return this._read(function(u){return xt(a,s,u,a.table.core)})},mt.prototype.count=function(s){var a=this;return this._read(function(u){var d,h=a._ctx,m=h.table.core;return On(h,!0)?m.count({trans:u,query:{index:ho(h,m.schema),range:h.range}}).then(function(b){return Math.min(b,h.limit)}):(d=0,xt(h,function(){return++d,!1},u,m).then(function(){return d}))}).then(s)},mt.prototype.sortBy=function(s,a){var u=s.split(".").reverse(),d=u[0],h=u.length-1;function m(z,$){return $?m(z[u[$]],$-1):z[d]}var b=this._ctx.dir==="next"?1:-1;function k(z,$){return ot(m(z,h),m($,h))*b}return this.toArray(function(z){return z.sort(k)}).then(a)},mt.prototype.toArray=function(s){var a=this;return this._read(function(u){var d,h,m,b=a._ctx;return b.dir==="next"&&On(b,!0)&&0<b.limit?(d=b.valueMapper,h=ho(b,b.table.core.schema),b.table.core.query({trans:u,limit:b.limit,values:!0,query:{index:h,range:b.range}}).then(function(k){return k=k.result,d?k.map(d):k})):(m=[],xt(b,function(k){return m.push(k)},u,b.table.core).then(function(){return m}))},s)},mt.prototype.offset=function(s){var a=this._ctx;return s<=0||(a.offset+=s,On(a)?Mn(a,function(){var u=s;return function(d,h){return u===0||(u===1?--u:h(function(){d.advance(u),u=0}),!1)}}):Mn(a,function(){var u=s;return function(){return--u<0}})),this},mt.prototype.limit=function(s){return this._ctx.limit=Math.min(this._ctx.limit,s),Mn(this._ctx,function(){var a=s;return function(u,d,h){return--a<=0&&d(h),0<=a}},!0),this},mt.prototype.until=function(s,a){return Is(this._ctx,function(u,d,h){return!s(u.value)||(d(h),a)}),this},mt.prototype.first=function(s){return this.limit(1).toArray(function(a){return a[0]}).then(s)},mt.prototype.last=function(s){return this.reverse().first(s)},mt.prototype.filter=function(s){var a;return Is(this._ctx,function(u){return s(u.value)}),(a=this._ctx).isMatch=vn(a.isMatch,s),this},mt.prototype.and=function(s){return this.filter(s)},mt.prototype.or=function(s){return new this.db.WhereClause(this._ctx.table,s,this)},mt.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},mt.prototype.desc=function(){return this.reverse()},mt.prototype.eachKey=function(s){var a=this._ctx;return a.keysOnly=!a.isMatch,this.each(function(u,d){s(d.key,d)})},mt.prototype.eachUniqueKey=function(s){return this._ctx.unique="unique",this.eachKey(s)},mt.prototype.eachPrimaryKey=function(s){var a=this._ctx;return a.keysOnly=!a.isMatch,this.each(function(u,d){s(d.primaryKey,d)})},mt.prototype.keys=function(s){var a=this._ctx,u=(a.keysOnly=!a.isMatch,[]);return this.each(function(d,h){u.push(h.key)}).then(function(){return u}).then(s)},mt.prototype.primaryKeys=function(s){var a=this._ctx;if(a.dir==="next"&&On(a,!0)&&0<a.limit)return this._read(function(d){var h=ho(a,a.table.core.schema);return a.table.core.query({trans:d,values:!1,limit:a.limit,query:{index:h,range:a.range}})}).then(function(d){return d.result}).then(s);a.keysOnly=!a.isMatch;var u=[];return this.each(function(d,h){u.push(h.primaryKey)}).then(function(){return u}).then(s)},mt.prototype.uniqueKeys=function(s){return this._ctx.unique="unique",this.keys(s)},mt.prototype.firstKey=function(s){return this.limit(1).keys(function(a){return a[0]}).then(s)},mt.prototype.lastKey=function(s){return this.reverse().firstKey(s)},mt.prototype.distinct=function(){var s,a=this._ctx,a=a.index&&a.table.schema.idxByName[a.index];return a&&a.multi&&(s={},Is(this._ctx,function(d){var d=d.primaryKey.toString(),h=J(s,d);return s[d]=!0,!h})),this},mt.prototype.modify=function(s){var a=this,u=this._ctx;return this._write(function(d){function h(M,H){var Y=H.failures;I+=M-H.numFailures;for(var K=0,le=_(Y);K<le.length;K++){var me=le[K];D.push(Y[me])}}var m=typeof s=="function"?s:function(M){return ss(M,s)},b=u.table.core,O=b.schema.primaryKey,k=O.outbound,z=O.extractKey,$=200,O=a.db._options.modifyChunkSize,D=(O&&($=typeof O=="object"?O[b.name]||O["*"]||200:O),[]),I=0,B=[],F=s===ea;return a.clone().primaryKeys().then(function(M){function H(K){var le=Math.min($,M.length-K),me=M.slice(K,K+le);return(F?Promise.resolve([]):b.getMany({trans:d,keys:me,cache:"immutable"})).then(function(_e){var Ee=[],xe=[],Ae=k?[]:null,De=F?me:[];if(!F)for(var ke=0;ke<le;++ke){var Le=_e[ke],ht={value:Te(Le),primKey:M[K+ke]};m.call(ht,ht.value,ht)!==!1&&(ht.value==null?De.push(M[K+ke]):k||ot(z(Le),z(ht.value))===0?(xe.push(ht.value),k&&Ae.push(M[K+ke])):(De.push(M[K+ke]),Ee.push(ht.value)))}return Promise.resolve(0<Ee.length&&b.mutate({trans:d,type:"add",values:Ee}).then(function(gt){for(var Qe in gt.failures)De.splice(parseInt(Qe),1);h(Ee.length,gt)})).then(function(){return(0<xe.length||Y&&typeof s=="object")&&b.mutate({trans:d,type:"put",keys:Ae,values:xe,criteria:Y,changeSpec:typeof s!="function"&&s,isAdditionalChunk:0<K}).then(function(gt){return h(xe.length,gt)})}).then(function(){return(0<De.length||Y&&F)&&b.mutate({trans:d,type:"delete",keys:De,criteria:Y,isAdditionalChunk:0<K}).then(function(gt){return po(u.table,De,gt)}).then(function(gt){return h(De.length,gt)})}).then(function(){return M.length>K+le&&H(K+$)})})}var Y=On(u)&&u.limit===1/0&&(typeof s!="function"||F)&&{index:u.index,range:u.range};return H(0).then(function(){if(0<D.length)throw new Oe("Error modifying one or more objects",D,I,B);return M.length})})})},mt.prototype.delete=function(){var s=this._ctx,a=s.range;return!On(s)||s.table.schema.yProps||!s.isPrimKey&&a.type!==3?this.modify(ea):this._write(function(u){var d=s.table.core.schema.primaryKey,h=a;return s.table.core.count({trans:u,query:{index:d,range:h}}).then(function(m){return s.table.core.mutate({trans:u,type:"deleteRange",range:h}).then(function(z){var k=z.failures,z=z.numFailures;if(z)throw new Oe("Could not delete some values",Object.keys(k).map(function($){return k[$]}),m-z);return m-z})})})};var tl=mt;function mt(){}var ea=function(s,a){return a.value=null};function rl(s,a){return s<a?-1:s===a?0:1}function nl(s,a){return a<s?-1:s===a?0:1}function ir(s,a,u){return s=s instanceof os?new s.Collection(s):s,s._ctx.error=new(u||TypeError)(a),s}function Jr(s){return new s.Collection(s,function(){return Zr("")}).limit(0)}function Fr(B,a,u,d){var h,m,b,k,z,$,O,D=u.length;if(!u.every(function(M){return typeof M=="string"}))return ir(B,Xa);function I(M){h=M==="next"?function(Y){return Y.toUpperCase()}:function(Y){return Y.toLowerCase()},m=M==="next"?function(Y){return Y.toLowerCase()}:function(Y){return Y.toUpperCase()},b=M==="next"?rl:nl;var H=u.map(function(Y){return{lower:m(Y),upper:h(Y)}}).sort(function(Y,K){return b(Y.lower,K.lower)});k=H.map(function(Y){return Y.upper}),z=H.map(function(Y){return Y.lower}),O=($=M)==="next"?"":d}I("next");var B=new B.Collection(B,function(){return ur(k[0],z[D-1]+d)}),F=(B._ondirectionchange=function(M){I(M)},0);return B._addAlgorithm(function(M,H,Y){var K=M.key;if(typeof K=="string"){var le=m(K);if(a(le,z,F))return!0;for(var me=null,_e=F;_e<D;++_e){var Ee=((xe,Ae,De,ke,Le,ht)=>{for(var gt=Math.min(xe.length,ke.length),Qe=-1,dt=0;dt<gt;++dt){var Et=Ae[dt];if(Et!==ke[dt])return Le(xe[dt],De[dt])<0?xe.substr(0,dt)+De[dt]+De.substr(dt+1):Le(xe[dt],ke[dt])<0?xe.substr(0,dt)+ke[dt]+De.substr(dt+1):0<=Qe?xe.substr(0,Qe)+Ae[Qe]+De.substr(Qe+1):null;Le(xe[dt],Et)<0&&(Qe=dt)}return gt<ke.length&&ht==="next"?xe+De.substr(xe.length):gt<xe.length&&ht==="prev"?xe.substr(0,De.length):Qe<0?null:xe.substr(0,Qe)+ke[Qe]+De.substr(Qe+1)})(K,le,k[_e],z[_e],b,$);Ee===null&&me===null?F=_e+1:(me===null||0<b(me,Ee))&&(me=Ee)}H(me!==null?function(){M.continue(me+O)}:Y)}return!1}),B}function ur(s,a,u,d){return{type:2,lower:s,upper:a,lowerOpen:u,upperOpen:d}}function Zr(s){return{type:1,lower:s,upper:s}}Object.defineProperty(Lt.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),Lt.prototype.between=function(s,a,u,d){u=u!==!1,d=d===!0;try{return 0<this._cmp(s,a)||this._cmp(s,a)===0&&(u||d)&&(!u||!d)?Jr(this):new this.Collection(this,function(){return ur(s,a,!u,!d)})}catch{return ir(this,jt)}},Lt.prototype.equals=function(s){return s==null?ir(this,jt):new this.Collection(this,function(){return Zr(s)})},Lt.prototype.above=function(s){return s==null?ir(this,jt):new this.Collection(this,function(){return ur(s,void 0,!0)})},Lt.prototype.aboveOrEqual=function(s){return s==null?ir(this,jt):new this.Collection(this,function(){return ur(s,void 0,!1)})},Lt.prototype.below=function(s){return s==null?ir(this,jt):new this.Collection(this,function(){return ur(void 0,s,!1,!0)})},Lt.prototype.belowOrEqual=function(s){return s==null?ir(this,jt):new this.Collection(this,function(){return ur(void 0,s)})},Lt.prototype.startsWith=function(s){return typeof s!="string"?ir(this,Xa):this.between(s,s+An,!0,!0)},Lt.prototype.startsWithIgnoreCase=function(s){return s===""?this.startsWith(s):Fr(this,function(a,u){return a.indexOf(u[0])===0},[s],An)},Lt.prototype.equalsIgnoreCase=function(s){return Fr(this,function(a,u){return a===u[0]},[s],"")},Lt.prototype.anyOfIgnoreCase=function(){var s=v.apply(T,arguments);return s.length===0?Jr(this):Fr(this,function(a,u){return u.indexOf(a)!==-1},s,"")},Lt.prototype.startsWithAnyOfIgnoreCase=function(){var s=v.apply(T,arguments);return s.length===0?Jr(this):Fr(this,function(a,u){return u.some(function(d){return a.indexOf(d)===0})},s,An)},Lt.prototype.anyOf=function(){var s,a,u=this,d=v.apply(T,arguments),h=this._cmp;try{d.sort(h)}catch{return ir(this,jt)}return d.length===0?Jr(this):((s=new this.Collection(this,function(){return ur(d[0],d[d.length-1])}))._ondirectionchange=function(m){h=m==="next"?u._ascending:u._descending,d.sort(h)},a=0,s._addAlgorithm(function(m,b,k){for(var z=m.key;0<h(z,d[a]);)if(++a===d.length)return b(k),!1;return h(z,d[a])===0||(b(function(){m.continue(d[a])}),!1)}),s)},Lt.prototype.notEqual=function(s){return this.inAnyRange([[-1/0,s],[s,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},Lt.prototype.noneOf=function(){var s=v.apply(T,arguments);if(s.length===0)return new this.Collection(this);try{s.sort(this._ascending)}catch{return ir(this,jt)}var a=s.reduce(function(u,d){return u?u.concat([[u[u.length-1][1],d]]):[[-1/0,d]]},null);return a.push([s[s.length-1],this.db._maxKey]),this.inAnyRange(a,{includeLowers:!1,includeUppers:!1})},Lt.prototype.inAnyRange=function(s,Y){var u=this,d=this._cmp,h=this._ascending,m=this._descending,b=this._min,k=this._max;if(s.length===0)return Jr(this);if(!s.every(function(K){return K[0]!==void 0&&K[1]!==void 0&&h(K[0],K[1])<=0}))return ir(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",Se.InvalidArgument);var z=!Y||Y.includeLowers!==!1,$=Y&&Y.includeUppers===!0,O,D=h;function I(K,le){return D(K[0],le[0])}try{(O=s.reduce(function(K,le){for(var me=0,_e=K.length;me<_e;++me){var Ee=K[me];if(d(le[0],Ee[1])<0&&0<d(le[1],Ee[0])){Ee[0]=b(Ee[0],le[0]),Ee[1]=k(Ee[1],le[1]);break}}return me===_e&&K.push(le),K},[])).sort(I)}catch{return ir(this,jt)}var B=0,F=$?function(K){return 0<h(K,O[B][1])}:function(K){return 0<=h(K,O[B][1])},M=z?function(K){return 0<m(K,O[B][0])}:function(K){return 0<=m(K,O[B][0])},H=F,Y=new this.Collection(this,function(){return ur(O[0][0],O[O.length-1][1],!z,!$)});return Y._ondirectionchange=function(K){D=K==="next"?(H=F,h):(H=M,m),O.sort(I)},Y._addAlgorithm(function(K,le,me){for(var _e,Ee=K.key;H(Ee);)if(++B===O.length)return le(me),!1;return!F(_e=Ee)&&!M(_e)||(u._cmp(Ee,O[B][1])===0||u._cmp(Ee,O[B][0])===0||le(function(){D===h?K.continue(O[B][0]):K.continue(O[B][1])}),!1)}),Y},Lt.prototype.startsWithAnyOf=function(){var s=v.apply(T,arguments);return s.every(function(a){return typeof a=="string"})?s.length===0?Jr(this):this.inAnyRange(s.map(function(a){return[a,a+An]})):ir(this,"startsWithAnyOf() only works with strings")};var os=Lt;function Lt(){}function Jt(s){return St(function(a){return Bs(a),s(a.target.error),!1})}function Bs(s){s.stopPropagation&&s.stopPropagation(),s.preventDefault&&s.preventDefault()}var as="storagemutated",Fn="x-storagemutated-1",wn=zs(null,as),sl=(br.prototype._lock=function(){return ce(!Ce.global),++this._reculock,this._reculock!==1||Ce.global||(Ce.lockOwnerFor=this),this},br.prototype._unlock=function(){if(ce(!Ce.global),--this._reculock==0)for(Ce.global||(Ce.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var s=this._blockedFuncs.shift();try{xn(s[1],s[0])}catch{}}return this},br.prototype._locked=function(){return this._reculock&&Ce.lockOwnerFor!==this},br.prototype.create=function(s){var a=this;if(this.mode){var u=this.db.idbdb,d=this.db._state.dbOpenError;if(ce(!this.idbtrans),!s&&!u)switch(d&&d.name){case"DatabaseClosedError":throw new Se.DatabaseClosed(d);case"MissingAPIError":throw new Se.MissingAPI(d.message,d);default:throw new Se.OpenFailed(d)}if(!this.active)throw new Se.TransactionInactive;ce(this._completion._state===null),(s=this.idbtrans=s||(this.db.core||u).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=St(function(h){Bs(h),a._reject(s.error)}),s.onabort=St(function(h){Bs(h),a.active&&a._reject(new Se.Abort(s.error)),a.active=!1,a.on("abort").fire(h)}),s.oncomplete=St(function(){a.active=!1,a._resolve(),"mutatedParts"in s&&wn.storagemutated.fire(s.mutatedParts)})}return this},br.prototype._promise=function(s,a,u){var d,h=this;return s==="readwrite"&&this.mode!=="readwrite"?zt(new Se.ReadOnly("Transaction is readonly")):this.active?this._locked()?new ue(function(m,b){h._blockedFuncs.push([function(){h._promise(s,a,u).then(m,b)},Ce])}):u?mn(function(){var m=new ue(function(b,k){h._lock();var z=a(b,k,h);z&&z.then&&z.then(b,k)});return m.finally(function(){return h._unlock()}),m._lib=!0,m}):((d=new ue(function(m,b){var k=a(m,b,h);k&&k.then&&k.then(m,b)}))._lib=!0,d):zt(new Se.TransactionInactive)},br.prototype._root=function(){return this.parent?this.parent._root():this},br.prototype.waitFor=function(s){var a,u=this._root(),d=ue.resolve(s),h=(u._waitingFor?u._waitingFor=u._waitingFor.then(function(){return d}):(u._waitingFor=d,u._waitingQueue=[],a=u.idbtrans.objectStore(u.storeNames[0]),(function m(){for(++u._spinCount;u._waitingQueue.length;)u._waitingQueue.shift()();u._waitingFor&&(a.get(-1/0).onsuccess=m)})()),u._waitingFor);return new ue(function(m,b){d.then(function(k){return u._waitingQueue.push(St(m.bind(null,k)))},function(k){return u._waitingQueue.push(St(b.bind(null,k)))}).finally(function(){u._waitingFor===h&&(u._waitingFor=null)})})},br.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new Se.Abort))},br.prototype.table=function(s){var a=this._memoizedTables||(this._memoizedTables={});if(J(a,s))return a[s];var u=this.schema[s];if(u)return(u=new this.db.Table(s,u,this)).core=this.db.core.table(s),a[s]=u;throw new Se.NotFound("Table "+s+" not part of transaction")},br);function br(){}function go(s,a,u,d,h,m,b,k){return{name:s,keyPath:a,unique:u,multi:d,auto:h,compound:m,src:(u&&!b?"&":"")+(d?"*":"")+(h?"++":"")+ol(a),type:k}}function ol(s){return typeof s=="string"?s:s?"["+[].join.call(s,"+")+"]":""}function zn(s,a,u){return{name:s,primKey:a,indexes:u,mappedClass:null,idxByName:(d=function(h){return[h.name,h]},u.reduce(function(h,m,b){return m=d(m,b),m&&(h[m[0]]=m[1]),h},{}))};var d}var en=function(s){try{return s.only([[]]),en=function(){return[[]]},[[]]}catch{return en=function(){return An},An}};function jn(s){return s==null?function(){}:typeof s=="string"?(a=s).split(".").length===1?function(u){return u[a]}:function(u){return je(u,a)}:function(u){return je(u,s)};var a}function Us(s){return[].slice.call(s)}var Ni=0;function $s(s){return s==null?":id":typeof s=="string"?s:"[".concat(s.join("+"),"]")}function ta(s,a,z){function d(F){if(F.type===3)return null;if(F.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var D=F.lower,I=F.upper,B=F.lowerOpen,F=F.upperOpen;return D===void 0?I===void 0?null:a.upperBound(I,!!F):I===void 0?a.lowerBound(D,!!B):a.bound(D,I,!!B,!!F)}function h(O){var D,I=O.name;return{name:I,schema:O,mutate:function(B){var F=B.trans,M=B.type,H=B.keys,Y=B.values,K=B.range;return new Promise(function(le,me){le=St(le);var _e=F.objectStore(I),Ee=_e.keyPath==null,xe=M==="put"||M==="add";if(!xe&&M!=="delete"&&M!=="deleteRange")throw new Error("Invalid operation type: "+M);var Ae,De=(H||Y||{length:1}).length;if(H&&Y&&H.length!==Y.length)throw new Error("Given keys array must have same length as given values array.");if(De===0)return le({numFailures:0,failures:{},results:[],lastResult:void 0});function ke(kt){++gt,Bs(kt)}var Le=[],ht=[],gt=0;if(M==="deleteRange"){if(K.type===4)return le({numFailures:gt,failures:ht,results:[],lastResult:void 0});K.type===3?Le.push(Ae=_e.clear()):Le.push(Ae=_e.delete(d(K)))}else{var Ee=xe?Ee?[Y,H]:[Y,null]:[H,null],Qe=Ee[0],dt=Ee[1];if(xe)for(var Et=0;Et<De;++Et)Le.push(Ae=dt&&dt[Et]!==void 0?_e[M](Qe[Et],dt[Et]):_e[M](Qe[Et])),Ae.onerror=ke;else for(Et=0;Et<De;++Et)Le.push(Ae=_e[M](Qe[Et])),Ae.onerror=ke}function wr(kt){kt=kt.target.result,Le.forEach(function(on,Hs){return on.error!=null&&(ht[Hs]=on.error)}),le({numFailures:gt,failures:ht,results:M==="delete"?H:Le.map(function(on){return on.result}),lastResult:kt})}Ae.onerror=function(kt){ke(kt),wr(kt)},Ae.onsuccess=wr})},getMany:function(B){var F=B.trans,M=B.keys;return new Promise(function(H,Y){H=St(H);for(var K,le=F.objectStore(I),me=M.length,_e=new Array(me),Ee=0,xe=0,Ae=function(Le){Le=Le.target,_e[Le._pos]=Le.result,++xe===Ee&&H(_e)},De=Jt(Y),ke=0;ke<me;++ke)M[ke]!=null&&((K=le.get(M[ke]))._pos=ke,K.onsuccess=Ae,K.onerror=De,++Ee);Ee===0&&H(_e)})},get:function(B){var F=B.trans,M=B.key;return new Promise(function(H,Y){H=St(H);var K=F.objectStore(I).get(M);K.onsuccess=function(le){return H(le.target.result)},K.onerror=Jt(Y)})},query:(D=k,function(B){return new Promise(function(F,M){F=St(F);var H,Y,K,xe=B.trans,le=B.values,me=B.limit,Ee=B.query,_e=me===1/0?void 0:me,Ae=Ee.index,Ee=Ee.range,xe=xe.objectStore(I),xe=Ae.isPrimaryKey?xe:xe.index(Ae.name),Ae=d(Ee);if(me===0)return F({result:[]});D?((Ee=le?xe.getAll(Ae,_e):xe.getAllKeys(Ae,_e)).onsuccess=function(De){return F({result:De.target.result})},Ee.onerror=Jt(M)):(H=0,Y=!le&&"openKeyCursor"in xe?xe.openKeyCursor(Ae):xe.openCursor(Ae),K=[],Y.onsuccess=function(De){var ke=Y.result;return!ke||(K.push(le?ke.value:ke.primaryKey),++H===me)?F({result:K}):void ke.continue()},Y.onerror=Jt(M))})}),openCursor:function(B){var F=B.trans,M=B.values,H=B.query,Y=B.reverse,K=B.unique;return new Promise(function(le,me){le=St(le);var xe=H.index,_e=H.range,Ee=F.objectStore(I),Ee=xe.isPrimaryKey?Ee:Ee.index(xe.name),xe=Y?K?"prevunique":"prev":K?"nextunique":"next",Ae=!M&&"openKeyCursor"in Ee?Ee.openKeyCursor(d(_e),xe):Ee.openCursor(d(_e),xe);Ae.onerror=Jt(me),Ae.onsuccess=St(function(De){var ke,Le,ht,gt,Qe=Ae.result;Qe?(Qe.___id=++Ni,Qe.done=!1,ke=Qe.continue.bind(Qe),Le=(Le=Qe.continuePrimaryKey)&&Le.bind(Qe),ht=Qe.advance.bind(Qe),gt=function(){throw new Error("Cursor not stopped")},Qe.trans=F,Qe.stop=Qe.continue=Qe.continuePrimaryKey=Qe.advance=function(){throw new Error("Cursor not started")},Qe.fail=St(me),Qe.next=function(){var dt=this,Et=1;return this.start(function(){return Et--?dt.continue():dt.stop()}).then(function(){return dt})},Qe.start=function(dt){function Et(){if(Ae.result)try{dt()}catch(kt){Qe.fail(kt)}else Qe.done=!0,Qe.start=function(){throw new Error("Cursor behind last entry")},Qe.stop()}var wr=new Promise(function(kt,on){kt=St(kt),Ae.onerror=Jt(on),Qe.fail=on,Qe.stop=function(Hs){Qe.stop=Qe.continue=Qe.continuePrimaryKey=Qe.advance=gt,kt(Hs)}});return Ae.onsuccess=St(function(kt){Ae.onsuccess=Et,Et()}),Qe.continue=ke,Qe.continuePrimaryKey=Le,Qe.advance=ht,Et(),wr},le(Qe)):le(null)},me)})},count:function(B){var F=B.query,M=B.trans,H=F.index,Y=F.range;return new Promise(function(K,le){var me=M.objectStore(I),me=H.isPrimaryKey?me:me.index(H.name),_e=d(Y),_e=_e?me.count(_e):me.count();_e.onsuccess=St(function(Ee){return K(Ee.target.result)}),_e.onerror=Jt(le)})}}}m=z,b=Us((z=s).objectStoreNames);var m,z={schema:{name:z.name,tables:b.map(function(O){return m.objectStore(O)}).map(function(O){var D=O.keyPath,I=O.autoIncrement,F=E(D),B={},F={name:O.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:D==null,compound:F,keyPath:D,autoIncrement:I,unique:!0,extractKey:jn(D)},indexes:Us(O.indexNames).map(function(M){return O.index(M)}).map(function(K){var le=K.name,H=K.unique,Y=K.multiEntry,K=K.keyPath,le={name:le,compound:E(K),keyPath:K,unique:H,multiEntry:Y,extractKey:jn(K)};return B[$s(K)]=le}),getIndexByKeyPath:function(M){return B[$s(M)]}};return B[":id"]=F.primaryKey,D!=null&&(B[$s(D)]=F.primaryKey),F})},hasGetAll:0<b.length&&"getAll"in m.objectStore(b[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)},b=z.schema,k=z.hasGetAll,z=b.tables.map(h),$={};return z.forEach(function(O){return $[O.name]=O}),{stack:"dbcore",transaction:s.transaction.bind(s),table:function(O){if($[O])return $[O];throw new Error("Table '".concat(O,"' not found"))},MIN_KEY:-1/0,MAX_KEY:en(a),schema:b}}function xo(s,a,u,d){return u=u.IDBKeyRange,a=ta(a,u,d),{dbcore:s.dbcore.reduce(function(h,m){return m=m.create,x(x({},h),m(h))},a)}}function ls(s,a){var u=a.db,u=xo(s._middlewares,u,s._deps,a);s.core=u.dbcore,s.tables.forEach(function(d){var h=d.name;s.core.schema.tables.some(function(m){return m.name===h})&&(d.core=s.core.table(h),s[h]instanceof s.Table)&&(s[h].core=d.core)})}function Ks(s,a,u,d){u.forEach(function(h){var m=d[h];a.forEach(function(b){var k=(function z($,O){return X($,O)||($=L($))&&z($,O)})(b,h);(!k||"value"in k&&k.value===void 0)&&(b===s.Transaction.prototype||b instanceof s.Transaction?he(b,h,{get:function(){return this.table(h)},set:function(z){se(this,h,{value:z,writable:!0,configurable:!0,enumerable:!0})}}):b[h]=new s.Table(h,m))})})}function Kr(s,a){a.forEach(function(u){for(var d in u)u[d]instanceof s.Table&&delete u[d]})}function ra(s,a){return s._cfg.version-a._cfg.version}function yo(s,a,u,d){var h=s._dbSchema,m=(u.objectStoreNames.contains("$meta")&&!h.$meta&&(h.$meta=zn("$meta",ds("")[0],[]),s._storeNames.push("$meta")),s._createTransaction("readwrite",s._storeNames,h)),b=(m.create(u),m._completion.catch(d),m._reject.bind(m)),k=Ce.transless||Ce;mn(function(){if(Ce.trans=m,Ce.transless=k,a!==0)return ls(s,u),$=a,((z=m).storeNames.includes("$meta")?z.table("$meta").get("version").then(function(O){return O??$}):ue.resolve($)).then(function(H){var D=s,I=H,B=m,F=u,M=[],H=D._versions,Y=D._dbSchema=tn(0,D.idbdb,F);return(H=H.filter(function(K){return K._cfg.version>=I})).length===0?ue.resolve():(H.forEach(function(K){M.push(function(){var le,me,_e,Ee=Y,xe=K._cfg.dbschema,Ae=(cs(D,Ee,F),cs(D,xe,F),Y=D._dbSchema=xe,is(Ee,xe)),De=(Ae.add.forEach(function(ke){us(F,ke[0],ke[1].primKey,ke[1].indexes)}),Ae.change.forEach(function(ke){if(ke.recreate)throw new Se.Upgrade("Not yet support for changing primary key");var Le=F.objectStore(ke.name);ke.add.forEach(function(ht){return nr(Le,ht)}),ke.change.forEach(function(ht){Le.deleteIndex(ht.name),nr(Le,ht)}),ke.del.forEach(function(ht){return Le.deleteIndex(ht)})}),K._cfg.contentUpgrade);if(De&&K._cfg.version>I)return ls(D,F),B._memoizedTables={},le=Pe(xe),Ae.del.forEach(function(ke){le[ke]=Ee[ke]}),Kr(D,[D.Transaction.prototype]),Ks(D,[D.Transaction.prototype],_(le),le),B.schema=le,(me=w(De))&&rs(),xe=ue.follow(function(){var ke;(_e=De(B))&&me&&(ke=hr.bind(null,null),_e.then(ke,ke))}),_e&&typeof _e.then=="function"?ue.resolve(_e):xe.then(function(){return _e})}),M.push(function(le){var me,_e,Ee=K._cfg.dbschema;me=Ee,_e=le,[].slice.call(_e.db.objectStoreNames).forEach(function(xe){return me[xe]==null&&_e.db.deleteObjectStore(xe)}),Kr(D,[D.Transaction.prototype]),Ks(D,[D.Transaction.prototype],D._storeNames,D._dbSchema),B.schema=D._dbSchema}),M.push(function(le){D.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(D.idbdb.version/10)===K._cfg.version?(D.idbdb.deleteObjectStore("$meta"),delete D._dbSchema.$meta,D._storeNames=D._storeNames.filter(function(me){return me!=="$meta"})):le.objectStore("$meta").put(K._cfg.version,"version"))})}),(function K(){return M.length?ue.resolve(M.shift()(B.idbtrans)).then(K):ue.resolve()})().then(function(){na(Y,F)}))}).catch(b);var z,$;_(h).forEach(function(O){us(u,O,h[O].primKey,h[O].indexes)}),ls(s,u),ue.follow(function(){return s.on.populate.fire(m)}).catch(b)})}function al(s,a){na(s._dbSchema,a),a.db.version%10!=0||a.objectStoreNames.contains("$meta")||a.db.createObjectStore("$meta").add(Math.ceil(a.db.version/10-1),"version");var u=tn(0,s.idbdb,a);cs(s,s._dbSchema,a);for(var d=0,h=is(u,s._dbSchema).change;d<h.length;d++){var m=(b=>{if(b.change.length||b.recreate)return console.warn("Unable to patch indexes of table ".concat(b.name," because it has changes on the type of index or primary key.")),{value:void 0};var k=a.objectStore(b.name);b.add.forEach(function(z){Nt&&console.debug("Dexie upgrade patch: Creating missing index ".concat(b.name,".").concat(z.src)),nr(k,z)})})(h[d]);if(typeof m=="object")return m.value}}function is(s,a){var u,d={del:[],add:[],change:[]};for(u in s)a[u]||d.del.push(u);for(u in a){var h=s[u],m=a[u];if(h){var b={name:u,def:m,recreate:!1,del:[],add:[],change:[]};if(""+(h.primKey.keyPath||"")!=""+(m.primKey.keyPath||"")||h.primKey.auto!==m.primKey.auto)b.recreate=!0,d.change.push(b);else{var k=h.idxByName,z=m.idxByName,$=void 0;for($ in k)z[$]||b.del.push($);for($ in z){var O=k[$],D=z[$];O?O.src!==D.src&&b.change.push(D):b.add.push(D)}(0<b.del.length||0<b.add.length||0<b.change.length)&&d.change.push(b)}}else d.add.push([u,m])}return d}function us(s,a,u,d){var h=s.db.createObjectStore(a,u.keyPath?{keyPath:u.keyPath,autoIncrement:u.auto}:{autoIncrement:u.auto});d.forEach(function(m){return nr(h,m)})}function na(s,a){_(s).forEach(function(u){a.db.objectStoreNames.contains(u)||(Nt&&console.debug("Dexie: Creating missing table",u),us(a,u,s[u].primKey,s[u].indexes))})}function nr(s,a){s.createIndex(a.name,a.keyPath,{unique:a.unique,multiEntry:a.multi})}function tn(s,a,u){var d={};return te(a.objectStoreNames,0).forEach(function(h){for(var m=u.objectStore(h),b=go(ol($=m.keyPath),$||"",!0,!1,!!m.autoIncrement,$&&typeof $!="string",!0),k=[],z=0;z<m.indexNames.length;++z){var O=m.index(m.indexNames[z]),$=O.keyPath,O=go(O.name,$,!!O.unique,!!O.multiEntry,!1,$&&typeof $!="string",!1);k.push(O)}d[h]=zn(h,b,k)}),d}function cs(s,a,u){for(var d=u.db.objectStoreNames,h=0;h<d.length;++h){var m=d[h],b=u.objectStore(m);s._hasGetAll="getAll"in b;for(var k=0;k<b.indexNames.length;++k){var z,$=b.indexNames[k],O=b.index($).keyPath,O=typeof O=="string"?O:"["+te(O).join("+")+"]";a[m]&&(z=a[m].idxByName[O])&&(z.name=$,delete a[m].idxByName[O],a[m].idxByName[$]=z)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&y.WorkerGlobalScope&&y instanceof y.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(s._hasGetAll=!1)}function ds(s){return s.split(",").map(function(a,u){var h=a.split(":"),d=(d=h[1])==null?void 0:d.trim(),h=(a=h[0].trim()).replace(/([&*]|\+\+)/g,""),m=/^\[/.test(h)?h.match(/^\[(.*)\]$/)[1].split("+"):h;return go(h,m||null,/\&/.test(a),/\*/.test(a),/\+\+/.test(a),E(m),u===0,d)})}kn.prototype._createTableSchema=zn,kn.prototype._parseIndexSyntax=ds,kn.prototype._parseStoresSpec=function(s,a){var u=this;_(s).forEach(function(d){if(s[d]!==null){var h=u._parseIndexSyntax(s[d]),m=h.shift();if(!m)throw new Se.Schema("Invalid schema for table "+d+": "+s[d]);if(m.unique=!0,m.multi)throw new Se.Schema("Primary key cannot be multiEntry*");h.forEach(function(b){if(b.auto)throw new Se.Schema("Only primary key can be marked as autoIncrement (++)");if(!b.keyPath)throw new Se.Schema("Index must have a name and cannot be an empty string")}),m=u._createTableSchema(d,m,h),a[d]=m}})},kn.prototype.stores=function(u){var a=this.db,u=(this._cfg.storesSource=this._cfg.storesSource?S(this._cfg.storesSource,u):u,a._versions),d={},h={};return u.forEach(function(m){S(d,m._cfg.storesSource),h=m._cfg.dbschema={},m._parseStoresSpec(d,h)}),a._dbSchema=h,Kr(a,[a._allTables,a,a.Transaction.prototype]),Ks(a,[a._allTables,a,a.Transaction.prototype,this._cfg.tables],_(h),h),a._storeNames=_(h),this},kn.prototype.upgrade=function(s){return this._cfg.contentUpgrade=Xt(this._cfg.contentUpgrade||ct,s),this};var Si=kn;function kn(){}function Vs(s,a){var u=s._dbNamesDB;return u||(u=s._dbNamesDB=new nn(Ls,{addons:[],indexedDB:s,IDBKeyRange:a})).version(1).stores({dbnames:"name"}),u.table("dbnames")}function In(s){return s&&typeof s.databases=="function"}function fs(s){return mn(function(){return Ce.letThrough=!0,s()})}function vo(s){return!("from"in s)}var sr=function(s,a){var u;if(!this)return u=new sr,s&&"d"in s&&S(u,s),u;S(this,arguments.length?{d:1,from:s,to:1<arguments.length?a:s}:{d:0})};function Ws(s,a,u){var d=ot(a,u);if(!isNaN(d)){if(0<d)throw RangeError();if(vo(s))return S(s,{from:a,to:u,d:1});var d=s.l,h=s.r;if(ot(u,s.from)<0)return d?Ws(d,a,u):s.l={from:a,to:u,d:1,l:null,r:null},ll(s);if(0<ot(a,s.to))return h?Ws(h,a,u):s.r={from:a,to:u,d:1,l:null,r:null},ll(s);ot(a,s.from)<0&&(s.from=a,s.l=null,s.d=h?h.d+1:1),0<ot(u,s.to)&&(s.to=u,s.r=null,s.d=s.l?s.l.d+1:1),a=!s.r,d&&!s.l&&qs(s,d),h&&a&&qs(s,h)}}function qs(s,a){vo(a)||(function u(d,h){var m=h.from,b=h.l,k=h.r;Ws(d,m,h.to),b&&u(d,b),k&&u(d,k)})(s,a)}function bo(s,a){var u=wo(a),d=u.next();if(!d.done)for(var h=d.value,m=wo(s),b=m.next(h.from),k=b.value;!d.done&&!b.done;){if(ot(k.from,h.to)<=0&&0<=ot(k.to,h.from))return!0;ot(h.from,k.from)<0?h=(d=u.next(k.from)).value:k=(b=m.next(h.from)).value}return!1}function wo(s){var a=vo(s)?null:{s:0,n:s};return{next:function(u){for(var d=0<arguments.length;a;)switch(a.s){case 0:if(a.s=1,d)for(;a.n.l&&ot(u,a.n.from)<0;)a={up:a,n:a.n.l,s:1};else for(;a.n.l;)a={up:a,n:a.n.l,s:1};case 1:if(a.s=2,!d||ot(u,a.n.to)<=0)return{value:a.n,done:!1};case 2:if(a.n.r){a.s=3,a={up:a,n:a.n.r,s:0};continue}case 3:a=a.up}return{done:!0}}}}function ll(s){var a,u,d,h=(((h=s.r)==null?void 0:h.d)||0)-(((h=s.l)==null?void 0:h.d)||0),h=1<h?"r":h<-1?"l":"";h&&(a=h=="r"?"l":"r",u=x({},s),d=s[h],s.from=d.from,s.to=d.to,s[h]=d[h],u[h]=d[a],(s[a]=u).d=il(u)),s.d=il(s)}function il(u){var a=u.r,u=u.l;return(a?u?Math.max(a.d,u.d):a.d:u?u.d:0)+1}function jo(s,a){return _(a).forEach(function(u){s[u]?qs(s[u],a[u]):s[u]=(function d(h){var m,b,k={};for(m in h)J(h,m)&&(b=h[m],k[m]=!b||typeof b!="object"||We.has(b.constructor)?b:d(b));return k})(a[u])}),s}function sa(s,a){return s.all||a.all||Object.keys(s).some(function(u){return a[u]&&bo(a[u],s[u])})}V(sr.prototype,((rt={add:function(s){return qs(this,s),this},addKey:function(s){return Ws(this,s,s),this},addKeys:function(s){var a=this;return s.forEach(function(u){return Ws(a,u,u)}),this},hasKey:function(s){var a=wo(this).next(s).value;return a&&ot(a.from,s)<=0&&0<=ot(a.to,s)}})[it]=function(){return wo(this)},rt));var Nn={},oa={},aa=!1;function ko(s){jo(oa,s),aa||(aa=!0,setTimeout(function(){aa=!1,la(oa,!(oa={}))},0))}function la(s,a){a===void 0&&(a=!1);var u=new Set;if(s.all)for(var d=0,h=Object.values(Nn);d<h.length;d++)No(k=h[d],s,u,a);else for(var m in s){var b,k,m=/^idb\:\/\/(.*)\/(.*)\//.exec(m);m&&(b=m[1],m=m[2],k=Nn["idb://".concat(b,"/").concat(m)])&&No(k,s,u,a)}u.forEach(function(z){return z()})}function No(s,a,u,d){for(var h=[],m=0,b=Object.entries(s.queries.query);m<b.length;m++){for(var k=b[m],z=k[0],$=[],O=0,D=k[1];O<D.length;O++){var I=D[O];sa(a,I.obsSet)?I.subscribers.forEach(function(H){return u.add(H)}):d&&$.push(I)}d&&h.push([z,$])}if(d)for(var B=0,F=h;B<F.length;B++){var M=F[B],z=M[0],$=M[1];s.queries.query[z]=$}}function Ci(s){var a=s._state,u=s._deps.indexedDB;if(a.isBeingOpened||s.idbdb)return a.dbReadyPromise.then(function(){return a.dbOpenError?zt(a.dbOpenError):s});a.isBeingOpened=!0,a.dbOpenError=null,a.openComplete=!1;var d=a.openCanceller,h=Math.round(10*s.verno),m=!1;function b(){if(a.openCanceller!==d)throw new Se.DatabaseClosed("db.open() was cancelled")}function k(){return new ue(function(I,B){if(b(),!u)throw new Se.MissingAPI;var F=s.name,M=a.autoSchema||!h?u.open(F):u.open(F,h);if(!M)throw new Se.MissingAPI;M.onerror=Jt(B),M.onblocked=St(s._fireOnBlocked),M.onupgradeneeded=St(function(H){var Y;O=M.transaction,a.autoSchema&&!s._options.allowEmptyDB?(M.onerror=Bs,O.abort(),M.result.close(),(Y=u.deleteDatabase(F)).onsuccess=Y.onerror=St(function(){B(new Se.NoSuchDatabase("Database ".concat(F," doesnt exist")))})):(O.onerror=Jt(B),Y=H.oldVersion>Math.pow(2,62)?0:H.oldVersion,D=Y<1,s.idbdb=M.result,m&&al(s,O),yo(s,Y/10,O,B))},B),M.onsuccess=St(function(){O=null;var H,Y,K,le,me,_e,Ee=s.idbdb=M.result,xe=te(Ee.objectStoreNames);if(0<xe.length)try{var Ae=Ee.transaction((me=xe).length===1?me[0]:me,"readonly");if(a.autoSchema)_e=Ee,le=Ae,(K=s).verno=_e.version/10,le=K._dbSchema=tn(0,_e,le),K._storeNames=te(_e.objectStoreNames,0),Ks(K,[K._allTables],_(le),le);else if(cs(s,s._dbSchema,Ae),Y=Ae,((Y=is(tn(0,(H=s).idbdb,Y),H._dbSchema)).add.length||Y.change.some(function(De){return De.add.length||De.change.length}))&&!m)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),Ee.close(),h=Ee.version+1,m=!0,I(k());ls(s,Ae)}catch{}yn.push(s),Ee.onversionchange=St(function(De){a.vcFired=!0,s.on("versionchange").fire(De)}),Ee.onclose=St(function(){s.close({disableAutoOpen:!1})}),D&&(xe=s._deps,me=F,In(_e=xe.indexedDB)||me===Ls||Vs(_e,xe.IDBKeyRange).put({name:me}).catch(ct)),I()},B)}).catch(function(I){switch(I==null?void 0:I.name){case"UnknownError":if(0<a.PR1398_maxLoop)return a.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),k();break;case"VersionError":if(0<h)return h=0,k()}return ue.reject(I)})}var z,$=a.dbReadyResolve,O=null,D=!1;return ue.race([d,(typeof navigator>"u"?ue.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(I){function B(){return indexedDB.databases().finally(I)}z=setInterval(B,100),B()}).finally(function(){return clearInterval(z)}):Promise.resolve()).then(k)]).then(function(){return b(),a.onReadyBeingFired=[],ue.resolve(fs(function(){return s.on.ready.fire(s.vip)})).then(function I(){var B;if(0<a.onReadyBeingFired.length)return B=a.onReadyBeingFired.reduce(Xt,ct),a.onReadyBeingFired=[],ue.resolve(fs(function(){return B(s.vip)})).then(I)})}).finally(function(){a.openCanceller===d&&(a.onReadyBeingFired=null,a.isBeingOpened=!1)}).catch(function(I){a.dbOpenError=I;try{O&&O.abort()}catch{}return d===a.openCanceller&&s._close(),zt(I)}).finally(function(){a.openComplete=!0,$()}).then(function(){var I;return D&&(I={},s.tables.forEach(function(B){B.schema.indexes.forEach(function(F){F.name&&(I["idb://".concat(s.name,"/").concat(B.name,"/").concat(F.name)]=new sr(-1/0,[[[]]]))}),I["idb://".concat(s.name,"/").concat(B.name,"/")]=I["idb://".concat(s.name,"/").concat(B.name,"/:dels")]=new sr(-1/0,[[[]]])}),wn(as).fire(I),la(I,!0)),s})}function ia(s){function a(m){return s.next(m)}var u=h(a),d=h(function(m){return s.throw(m)});function h(m){return function(k){var k=m(k),z=k.value;return k.done?z:z&&typeof z.then=="function"?z.then(u,d):E(z)?Promise.all(z).then(u,d):u(z)}}return h(a)()}function So(s,a,u){for(var d=E(s)?s.slice():[s],h=0;h<u;++h)d.push(a);return d}var ul={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(s){return x(x({},s),{table:function(d){var u=s.table(d),d=u.schema,h={},m=[];function b(I,B,F){var K=$s(I),M=h[K]=h[K]||[],H=I==null?0:typeof I=="string"?1:I.length,Y=0<B,K=x(x({},F),{name:Y?"".concat(K,"(virtual-from:").concat(F.name,")"):F.name,lowLevelIndex:F,isVirtual:Y,keyTail:B,keyLength:H,extractKey:jn(I),unique:!Y&&F.unique});return M.push(K),K.isPrimaryKey||m.push(K),1<H&&b(H===2?I[0]:I.slice(0,H-1),B+1,F),M.sort(function(le,me){return le.keyTail-me.keyTail}),K}var k=b(d.primaryKey.keyPath,0,d.primaryKey);h[":id"]=[k];for(var z=0,$=d.indexes;z<$.length;z++){var O=$[z];b(O.keyPath,0,O)}function D(I){var B,F=I.query.index;return F.isVirtual?x(x({},I),{query:{index:F.lowLevelIndex,range:(B=I.query.range,F=F.keyTail,{type:B.type===1?2:B.type,lower:So(B.lower,B.lowerOpen?s.MAX_KEY:s.MIN_KEY,F),lowerOpen:!0,upper:So(B.upper,B.upperOpen?s.MIN_KEY:s.MAX_KEY,F),upperOpen:!0})}}):I}return x(x({},u),{schema:x(x({},d),{primaryKey:k,indexes:m,getIndexByKeyPath:function(I){return(I=h[$s(I)])&&I[0]}}),count:function(I){return u.count(D(I))},query:function(I){return u.query(D(I))},openCursor:function(I){var B=I.query.index,F=B.keyTail,M=B.keyLength;return B.isVirtual?u.openCursor(D(I)).then(function(Y){return Y&&H(Y)}):u.openCursor(I);function H(Y){return Object.create(Y,{continue:{value:function(K){K!=null?Y.continue(So(K,I.reverse?s.MAX_KEY:s.MIN_KEY,F)):I.unique?Y.continue(Y.key.slice(0,M).concat(I.reverse?s.MIN_KEY:s.MAX_KEY,F)):Y.continue()}},continuePrimaryKey:{value:function(K,le){Y.continuePrimaryKey(So(K,s.MAX_KEY,F),le)}},primaryKey:{get:function(){return Y.primaryKey}},key:{get:function(){var K=Y.key;return M===1?K[0]:K.slice(0,M)}},value:{get:function(){return Y.value}}})}}})}})}};function ua(s,a,u,d){return u=u||{},d=d||"",_(s).forEach(function(h){var m,b,k;J(a,h)?(m=s[h],b=a[h],typeof m=="object"&&typeof b=="object"&&m&&b?(k=lt(m))!==lt(b)?u[d+h]=a[h]:k==="Object"?ua(m,b,u,d+h+"."):m!==b&&(u[d+h]=a[h]):m!==b&&(u[d+h]=a[h])):u[d+h]=void 0}),_(a).forEach(function(h){J(s,h)||(u[d+h]=a[h])}),u}function ca(s,a){return a.type==="delete"?a.keys:a.keys||a.values.map(s.extractKey)}var _i={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(s){return x(x({},s),{table:function(a){var u=s.table(a),d=u.schema.primaryKey;return x(x({},u),{mutate:function(h){var m=Ce.trans,b=m.table(a).hook,k=b.deleting,z=b.creating,$=b.updating;switch(h.type){case"add":if(z.fire===ct)break;return m._promise("readwrite",function(){return O(h)},!0);case"put":if(z.fire===ct&&$.fire===ct)break;return m._promise("readwrite",function(){return O(h)},!0);case"delete":if(k.fire===ct)break;return m._promise("readwrite",function(){return O(h)},!0);case"deleteRange":if(k.fire===ct)break;return m._promise("readwrite",function(){return(function D(I,B,F){return u.query({trans:I,values:!1,query:{index:d,range:B},limit:F}).then(function(M){var H=M.result;return O({type:"delete",keys:H,trans:I}).then(function(Y){return 0<Y.numFailures?Promise.reject(Y.failures[0]):H.length<F?{failures:[],numFailures:0,lastResult:void 0}:D(I,x(x({},B),{lower:H[H.length-1],lowerOpen:!0}),F)})})})(h.trans,h.range,1e4)},!0)}return u.mutate(h);function O(D){var I,B,F,M=Ce.trans,H=D.keys||ca(d,D);if(H)return(D=D.type==="add"||D.type==="put"?x(x({},D),{keys:H}):x({},D)).type!=="delete"&&(D.values=C([],D.values)),D.keys&&(D.keys=C([],D.keys)),I=u,F=H,((B=D).type==="add"?Promise.resolve([]):I.getMany({trans:B.trans,keys:F,cache:"immutable"})).then(function(Y){var K=H.map(function(le,me){var _e,Ee,xe,Ae=Y[me],De={onerror:null,onsuccess:null};return D.type==="delete"?k.fire.call(De,le,Ae,M):D.type==="add"||Ae===void 0?(_e=z.fire.call(De,le,D.values[me],M),le==null&&_e!=null&&(D.keys[me]=le=_e,d.outbound||de(D.values[me],d.keyPath,le))):(_e=ua(Ae,D.values[me]),(Ee=$.fire.call(De,_e,le,Ae,M))&&(xe=D.values[me],Object.keys(Ee).forEach(function(ke){J(xe,ke)?xe[ke]=Ee[ke]:de(xe,ke,Ee[ke])}))),De});return u.mutate(D).then(function(le){for(var me=le.failures,_e=le.results,Ee=le.numFailures,le=le.lastResult,xe=0;xe<H.length;++xe){var Ae=(_e||H)[xe],De=K[xe];Ae==null?De.onerror&&De.onerror(me[xe]):De.onsuccess&&De.onsuccess(D.type==="put"&&Y[xe]?D.values[xe]:Ae)}return{failures:me,results:_e,numFailures:Ee,lastResult:le}}).catch(function(le){return K.forEach(function(me){return me.onerror&&me.onerror(le)}),Promise.reject(le)})});throw new Error("Keys missing")}}})}})}};function cl(s,a,u){try{if(!a||a.keys.length<s.length)return null;for(var d=[],h=0,m=0;h<a.keys.length&&m<s.length;++h)ot(a.keys[h],s[m])===0&&(d.push(u?Te(a.values[h]):a.values[h]),++m);return d.length===s.length?d:null}catch{return null}}var Ei={stack:"dbcore",level:-1,create:function(s){return{table:function(a){var u=s.table(a);return x(x({},u),{getMany:function(d){var h;return d.cache?(h=cl(d.keys,d.trans._cache,d.cache==="clone"))?ue.resolve(h):u.getMany(d).then(function(m){return d.trans._cache={keys:d.keys,values:d.cache==="clone"?Te(m):m},m}):u.getMany(d)},mutate:function(d){return d.type!=="add"&&(d.trans._cache=null),u.mutate(d)}})}}}};function dl(s,a){return s.trans.mode==="readonly"&&!!s.subscr&&!s.trans.explicit&&s.trans.db._options.cache!=="disabled"&&!a.schema.primaryKey.outbound}function fl(s,a){switch(s){case"query":return a.values&&!a.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var da={stack:"dbcore",level:0,name:"Observability",create:function(s){var a=s.schema.name,u=new sr(s.MIN_KEY,s.MAX_KEY);return x(x({},s),{transaction:function(d,h,m){if(Ce.subscr&&h!=="readonly")throw new Se.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(Ce.querier));return s.transaction(d,h,m)},table:function(d){function h(H){var M,H=H.query;return[M=H.index,new sr((M=(H=H.range).lower)!=null?M:s.MIN_KEY,(M=H.upper)!=null?M:s.MAX_KEY)]}var m=s.table(d),b=m.schema,k=b.primaryKey,z=b.indexes,$=k.extractKey,O=k.outbound,D=k.autoIncrement&&z.filter(function(F){return F.compound&&F.keyPath.includes(k.keyPath)}),I=x(x({},m),{mutate:function(F){function M(Le){return Le="idb://".concat(a,"/").concat(d,"/").concat(Le),me[Le]||(me[Le]=new sr)}var H,Y,K,le=F.trans,me=F.mutatedParts||(F.mutatedParts={}),_e=M(""),Ee=M(":dels"),xe=F.type,De=F.type==="deleteRange"?[F.range]:F.type==="delete"?[F.keys]:F.values.length<50?[ca(k,F).filter(function(Le){return Le}),F.values]:[],Ae=De[0],De=De[1],ke=F.trans._cache;return E(Ae)?(_e.addKeys(Ae),(xe=xe==="delete"||Ae.length===De.length?cl(Ae,ke):null)||Ee.addKeys(Ae),(xe||De)&&(H=M,Y=xe,K=De,b.indexes.forEach(function(Le){var ht=H(Le.name||"");function gt(dt){return dt!=null?Le.extractKey(dt):null}function Qe(dt){Le.multiEntry&&E(dt)?dt.forEach(function(Et){return ht.addKey(Et)}):ht.addKey(dt)}(Y||K).forEach(function(dt,kt){var wr=Y&&gt(Y[kt]),kt=K&&gt(K[kt]);ot(wr,kt)!==0&&(wr!=null&&Qe(wr),kt!=null)&&Qe(kt)})}))):Ae?(De={from:(ke=Ae.lower)!=null?ke:s.MIN_KEY,to:(xe=Ae.upper)!=null?xe:s.MAX_KEY},Ee.add(De),_e.add(De)):(_e.add(u),Ee.add(u),b.indexes.forEach(function(Le){return M(Le.name).add(u)})),m.mutate(F).then(function(Le){return!Ae||F.type!=="add"&&F.type!=="put"||(_e.addKeys(Le.results),D&&D.forEach(function(ht){for(var gt=F.values.map(function(wr){return ht.extractKey(wr)}),Qe=ht.keyPath.findIndex(function(wr){return wr===k.keyPath}),dt=0,Et=Le.results.length;dt<Et;++dt)gt[dt][Qe]=Le.results[dt];M(ht.name).addKeys(gt)})),le.mutatedParts=jo(le.mutatedParts||{},me),Le})}}),B={get:function(F){return[k,new sr(F.key)]},getMany:function(F){return[k,new sr().addKeys(F.keys)]},count:h,query:h,openCursor:h};return _(B).forEach(function(F){I[F]=function(M){var H=Ce.subscr,Y=!!H,K=dl(Ce,m)&&fl(F,M)?M.obsSet={}:H;if(Y){var le,H=function(De){return De="idb://".concat(a,"/").concat(d,"/").concat(De),K[De]||(K[De]=new sr)},me=H(""),_e=H(":dels"),Y=B[F](M),Ee=Y[0],Y=Y[1];if((F==="query"&&Ee.isPrimaryKey&&!M.values?_e:H(Ee.name||"")).add(Y),!Ee.isPrimaryKey){if(F!=="count")return le=F==="query"&&O&&M.values&&m.query(x(x({},M),{values:!1})),m[F].apply(this,arguments).then(function(De){if(F==="query"){if(O&&M.values)return le.then(function(gt){return gt=gt.result,me.addKeys(gt),De});var ke=M.values?De.result.map($):De.result;(M.values?me:_e).addKeys(ke)}else{var Le,ht;if(F==="openCursor")return ht=M.values,(Le=De)&&Object.create(Le,{key:{get:function(){return _e.addKey(Le.primaryKey),Le.key}},primaryKey:{get:function(){var gt=Le.primaryKey;return _e.addKey(gt),gt}},value:{get:function(){return ht&&me.addKey(Le.primaryKey),Le.value}}})}return De});_e.add(u)}}return m[F].apply(this,arguments)}}),I}})}};function ps(s,a,u){var d;return u.numFailures===0?a:a.type==="deleteRange"||(d=a.keys?a.keys.length:"values"in a&&a.values?a.values.length:1,u.numFailures===d)?null:(d=x({},a),E(d.keys)&&(d.keys=d.keys.filter(function(h,m){return!(m in u.failures)})),"values"in d&&E(d.values)&&(d.values=d.values.filter(function(h,m){return!(m in u.failures)})),d)}function fa(s,a){return u=s,((d=a).lower===void 0||(d.lowerOpen?0<ot(u,d.lower):0<=ot(u,d.lower)))&&(u=s,(d=a).upper===void 0||(d.upperOpen?ot(u,d.upper)<0:ot(u,d.upper)<=0));var u,d}function pa(s,a,u,d,h,m){var b,k,z,$,O,D;return!u||u.length===0||(b=a.query.index,k=b.multiEntry,z=a.query.range,$=d.schema.primaryKey.extractKey,O=b.extractKey,D=(b.lowLevelIndex||b).extractKey,(d=u.reduce(function(I,B){var F=I,M=[];if(B.type==="add"||B.type==="put")for(var H=new sr,Y=B.values.length-1;0<=Y;--Y){var K,le=B.values[Y],me=$(le);!H.hasKey(me)&&(K=O(le),k&&E(K)?K.some(function(De){return fa(De,z)}):fa(K,z))&&(H.addKey(me),M.push(le))}switch(B.type){case"add":var _e=new sr().addKeys(a.values?I.map(function(ke){return $(ke)}):I),F=I.concat(a.values?M.filter(function(ke){return ke=$(ke),!_e.hasKey(ke)&&(_e.addKey(ke),!0)}):M.map(function(ke){return $(ke)}).filter(function(ke){return!_e.hasKey(ke)&&(_e.addKey(ke),!0)}));break;case"put":var Ee=new sr().addKeys(B.values.map(function(ke){return $(ke)}));F=I.filter(function(ke){return!Ee.hasKey(a.values?$(ke):ke)}).concat(a.values?M:M.map(function(ke){return $(ke)}));break;case"delete":var xe=new sr().addKeys(B.keys);F=I.filter(function(ke){return!xe.hasKey(a.values?$(ke):ke)});break;case"deleteRange":var Ae=B.range;F=I.filter(function(ke){return!fa($(ke),Ae)})}return F},s))===s)?s:(d.sort(function(I,B){return ot(D(I),D(B))||ot($(I),$(B))}),a.limit&&a.limit<1/0&&(d.length>a.limit?d.length=a.limit:s.length===a.limit&&d.length<a.limit&&(h.dirty=!0)),m?Object.freeze(d):d)}function ha(s,a){return ot(s.lower,a.lower)===0&&ot(s.upper,a.upper)===0&&!!s.lowerOpen==!!a.lowerOpen&&!!s.upperOpen==!!a.upperOpen}function pl(s,a){return((u,d,h,m)=>{if(u===void 0)return d!==void 0?-1:0;if(d===void 0)return 1;if((u=ot(u,d))===0){if(h&&m)return 0;if(h)return 1;if(m)return-1}return u})(s.lower,a.lower,s.lowerOpen,a.lowerOpen)<=0&&0<=((u,d,h,m)=>{if(u===void 0)return d!==void 0?1:0;if(d===void 0)return-1;if((u=ot(u,d))===0){if(h&&m)return 0;if(h)return-1;if(m)return 1}return u})(s.upper,a.upper,s.upperOpen,a.upperOpen)}function hl(s,a,u,d){s.subscribers.add(u),d.addEventListener("abort",function(){var h,m;s.subscribers.delete(u),s.subscribers.size===0&&(h=s,m=a,setTimeout(function(){h.subscribers.size===0&&G(m,h)},3e3))})}var ml={stack:"dbcore",level:0,name:"Cache",create:function(s){var a=s.schema.name;return x(x({},s),{transaction:function(u,d,h){var m,b,k=s.transaction(u,d,h);return d==="readwrite"&&(h=(m=new AbortController).signal,k.addEventListener("abort",(b=function(z){return function(){if(m.abort(),d==="readwrite"){for(var $=new Set,O=0,D=u;O<D.length;O++){var I=D[O],B=Nn["idb://".concat(a,"/").concat(I)];if(B){var F=s.table(I),M=B.optimisticOps.filter(function(Le){return Le.trans===k});if(k._explicit&&z&&k.mutatedParts)for(var H=0,Y=Object.values(B.queries.query);H<Y.length;H++)for(var K=0,le=(Ee=Y[H]).slice();K<le.length;K++)sa((xe=le[K]).obsSet,k.mutatedParts)&&(G(Ee,xe),xe.subscribers.forEach(function(Le){return $.add(Le)}));else if(0<M.length){B.optimisticOps=B.optimisticOps.filter(function(Le){return Le.trans!==k});for(var me=0,_e=Object.values(B.queries.query);me<_e.length;me++)for(var Ee,xe,Ae,De=0,ke=(Ee=_e[me]).slice();De<ke.length;De++)(xe=ke[De]).res!=null&&k.mutatedParts&&(z&&!xe.dirty?(Ae=Object.isFrozen(xe.res),Ae=pa(xe.res,xe.req,M,F,xe,Ae),xe.dirty?(G(Ee,xe),xe.subscribers.forEach(function(Le){return $.add(Le)})):Ae!==xe.res&&(xe.res=Ae,xe.promise=ue.resolve({result:Ae}))):(xe.dirty&&G(Ee,xe),xe.subscribers.forEach(function(Le){return $.add(Le)})))}}}$.forEach(function(Le){return Le()})}}})(!1),{signal:h}),k.addEventListener("error",b(!1),{signal:h}),k.addEventListener("complete",b(!0),{signal:h})),k},table:function(u){var d=s.table(u),h=d.schema.primaryKey;return x(x({},d),{mutate:function(m){var b,k=Ce.trans;return!h.outbound&&k.db._options.cache!=="disabled"&&!k.explicit&&k.idbtrans.mode==="readwrite"&&(b=Nn["idb://".concat(a,"/").concat(u)])?(k=d.mutate(m),m.type!=="add"&&m.type!=="put"||!(50<=m.values.length||ca(h,m).some(function(z){return z==null}))?(b.optimisticOps.push(m),m.mutatedParts&&ko(m.mutatedParts),k.then(function(z){0<z.numFailures&&(G(b.optimisticOps,m),(z=ps(0,m,z))&&b.optimisticOps.push(z),m.mutatedParts)&&ko(m.mutatedParts)}),k.catch(function(){G(b.optimisticOps,m),m.mutatedParts&&ko(m.mutatedParts)})):k.then(function(z){var $=ps(0,x(x({},m),{values:m.values.map(function(O,D){var I;return z.failures[D]?O:(de(I=(I=h.keyPath)!=null&&I.includes(".")?Te(O):x({},O),h.keyPath,z.results[D]),I)})}),z);b.optimisticOps.push($),queueMicrotask(function(){return m.mutatedParts&&ko(m.mutatedParts)})}),k):d.mutate(m)},query:function(m){var b,k,z,$,O,D,I;return dl(Ce,d)&&fl("query",m)?(b=((z=Ce.trans)==null?void 0:z.db._options.cache)==="immutable",k=(z=Ce).requery,z=z.signal,D=((B,F,M,H)=>{var Y=Nn["idb://".concat(B,"/").concat(F)];if(!Y)return[];if(!(B=Y.queries[M]))return[null,!1,Y,null];var K=B[(H.query?H.query.index.name:null)||""];if(!K)return[null,!1,Y,null];switch(M){case"query":var le=K.find(function(me){return me.req.limit===H.limit&&me.req.values===H.values&&ha(me.req.query.range,H.query.range)});return le?[le,!0,Y,K]:[K.find(function(me){return("limit"in me.req?me.req.limit:1/0)>=H.limit&&(!H.values||me.req.values)&&pl(me.req.query.range,H.query.range)}),!1,Y,K];case"count":return le=K.find(function(me){return ha(me.req.query.range,H.query.range)}),[le,!!le,Y,K]}})(a,u,"query",m),I=D[0],$=D[2],O=D[3],I&&D[1]?I.obsSet=m.obsSet:(D=d.query(m).then(function(B){var F=B.result;if(I&&(I.res=F),b){for(var M=0,H=F.length;M<H;++M)Object.freeze(F[M]);Object.freeze(F)}else B.result=Te(F);return B}).catch(function(B){return O&&I&&G(O,I),Promise.reject(B)}),I={obsSet:m.obsSet,promise:D,subscribers:new Set,type:"query",req:m,dirty:!1},O?O.push(I):(O=[I],($=$||(Nn["idb://".concat(a,"/").concat(u)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[m.query.index.name||""]=O)),hl(I,O,k,z),I.promise.then(function(B){return{result:pa(B.result,m,$==null?void 0:$.optimisticOps,d,I,b)}})):d.query(m)}})}})}};function rn(s,a){return new Proxy(s,{get:function(u,d,h){return d==="db"?a:Reflect.get(u,d,h)}})}It.prototype.version=function(s){if(isNaN(s)||s<.1)throw new Se.Type("Given version is not a positive number");if(s=Math.round(10*s)/10,this.idbdb||this._state.isBeingOpened)throw new Se.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,s);var a=this._versions,u=a.filter(function(d){return d._cfg.version===s})[0];return u||(u=new this.Version(s),a.push(u),a.sort(ra),u.stores({}),this._state.autoSchema=!1),u},It.prototype._whenReady=function(s){var a=this;return this.idbdb&&(this._state.openComplete||Ce.letThrough||this._vip)?s():new ue(function(u,d){if(a._state.openComplete)return d(new Se.DatabaseClosed(a._state.dbOpenError));if(!a._state.isBeingOpened){if(!a._state.autoOpen)return void d(new Se.DatabaseClosed);a.open().catch(ct)}a._state.dbReadyPromise.then(u,d)}).then(s)},It.prototype.use=function(h){var a=h.stack,u=h.create,d=h.level,h=h.name,m=(h&&this.unuse({stack:a,name:h}),this._middlewares[a]||(this._middlewares[a]=[]));return m.push({stack:a,create:u,level:d??10,name:h}),m.sort(function(b,k){return b.level-k.level}),this},It.prototype.unuse=function(s){var a=s.stack,u=s.name,d=s.create;return a&&this._middlewares[a]&&(this._middlewares[a]=this._middlewares[a].filter(function(h){return d?h.create!==d:!!u&&h.name!==u})),this},It.prototype.open=function(){var s=this;return xn(nt,function(){return Ci(s)})},It.prototype._close=function(){this.on.close.fire(new CustomEvent("close"));var s=this._state,a=yn.indexOf(this);if(0<=a&&yn.splice(a,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}s.isBeingOpened||(s.dbReadyPromise=new ue(function(u){s.dbReadyResolve=u}),s.openCanceller=new ue(function(u,d){s.cancelOpen=d}))},It.prototype.close=function(a){var a=(a===void 0?{disableAutoOpen:!0}:a).disableAutoOpen,u=this._state;a?(u.isBeingOpened&&u.cancelOpen(new Se.DatabaseClosed),this._close(),u.autoOpen=!1,u.dbOpenError=new Se.DatabaseClosed):(this._close(),u.autoOpen=this._options.autoOpen||u.isBeingOpened,u.openComplete=!1,u.dbOpenError=null)},It.prototype.delete=function(s){var a=this,u=(s===void 0&&(s={disableAutoOpen:!0}),0<arguments.length&&typeof arguments[0]!="object"),d=this._state;return new ue(function(h,m){function b(){a.close(s);var k=a._deps.indexedDB.deleteDatabase(a.name);k.onsuccess=St(function(){var z,$,O;z=a._deps,$=a.name,In(O=z.indexedDB)||$===Ls||Vs(O,z.IDBKeyRange).delete($).catch(ct),h()}),k.onerror=Jt(m),k.onblocked=a._fireOnBlocked}if(u)throw new Se.InvalidArgument("Invalid closeOptions argument to db.delete()");d.isBeingOpened?d.dbReadyPromise.then(b):b()})},It.prototype.backendDB=function(){return this.idbdb},It.prototype.isOpen=function(){return this.idbdb!==null},It.prototype.hasBeenClosed=function(){var s=this._state.dbOpenError;return s&&s.name==="DatabaseClosed"},It.prototype.hasFailed=function(){return this._state.dbOpenError!==null},It.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(It.prototype,"tables",{get:function(){var s=this;return _(this._allTables).map(function(a){return s._allTables[a]})},enumerable:!1,configurable:!0}),It.prototype.transaction=function(){var s=(function(a,u,d){var h=arguments.length;if(h<2)throw new Se.InvalidArgument("Too few arguments");for(var m=new Array(h-1);--h;)m[h-1]=arguments[h];return d=m.pop(),[a,Ye(m),d]}).apply(this,arguments);return this._transaction.apply(this,s)},It.prototype._transaction=function(s,a,u){var d,h,m=this,b=Ce.trans,k=(b&&b.db===this&&s.indexOf("!")===-1||(b=null),s.indexOf("?")!==-1);s=s.replace("!","").replace("?","");try{if(h=a.map(function($){if($=$ instanceof m.Table?$.name:$,typeof $!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return $}),s=="r"||s===ns)d=ns;else{if(s!="rw"&&s!=Jo)throw new Se.InvalidArgument("Invalid transaction mode: "+s);d=Jo}if(b){if(b.mode===ns&&d===Jo){if(!k)throw new Se.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");b=null}b&&h.forEach(function($){if(b&&b.storeNames.indexOf($)===-1){if(!k)throw new Se.SubTransaction("Table "+$+" not included in parent transaction.");b=null}}),k&&b&&!b.active&&(b=null)}}catch($){return b?b._promise(null,function(O,D){D($)}):zt($)}var z=(function $(O,D,I,B,F){return ue.resolve().then(function(){var K=Ce.transless||Ce,M=O._createTransaction(D,I,O._dbSchema,B),K=(M.explicit=!0,{trans:M,transless:K});if(B)M.idbtrans=B.idbtrans;else try{M.create(),M.idbtrans._explicit=!0,O._state.PR1398_maxLoop=3}catch(le){return le.name===qe.InvalidState&&O.isOpen()&&0<--O._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),O.close({disableAutoOpen:!1}),O.open().then(function(){return $(O,D,I,null,F)})):zt(le)}var H,Y=w(F),K=(Y&&rs(),ue.follow(function(){var le;(H=F.call(M,M))&&(Y?(le=hr.bind(null,null),H.then(le,le)):typeof H.next=="function"&&typeof H.throw=="function"&&(H=ia(H)))},K));return(H&&typeof H.then=="function"?ue.resolve(H).then(function(le){return M.active?le:zt(new Se.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):K.then(function(){return H})).then(function(le){return B&&M._resolve(),M._completion.then(function(){return le})}).catch(function(le){return M._reject(le),zt(le)})})}).bind(null,this,d,h,b,u);return b?b._promise(d,z,"lock"):Ce.trans?xn(Ce.transless,function(){return m._whenReady(z)}):this._whenReady(z)},It.prototype.table=function(s){if(J(this._allTables,s))return this._allTables[s];throw new Se.InvalidTable("Table ".concat(s," does not exist"))};var nn=It;function It(s,a){var u,d,h,m,b,k=this,z=(this._middlewares={},this.verno=0,It.dependencies),z=(this._options=a=x({addons:It.addons,autoOpen:!0,indexedDB:z.indexedDB,IDBKeyRange:z.IDBKeyRange,cache:"cloned"},a),this._deps={indexedDB:a.indexedDB,IDBKeyRange:a.IDBKeyRange},a.addons),$=(this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this,{dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:ct,dbReadyPromise:null,cancelOpen:ct,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:a.autoOpen}),O=($.dbReadyPromise=new ue(function(D){$.dbReadyResolve=D}),$.openCanceller=new ue(function(D,I){$.cancelOpen=I}),this._state=$,this.name=s,this.on=zs(this,"populate","blocked","versionchange","close",{ready:[Xt,ct]}),this.once=function(D,I){var B=function(){for(var F=[],M=0;M<arguments.length;M++)F[M]=arguments[M];k.on(D).unsubscribe(B),I.apply(k,F)};return k.on(D,B)},this.on.ready.subscribe=oe(this.on.ready.subscribe,function(D){return function(I,B){It.vip(function(){var F,M=k._state;M.openComplete?(M.dbOpenError||ue.resolve().then(I),B&&D(I)):M.onReadyBeingFired?(M.onReadyBeingFired.push(I),B&&D(I)):(D(I),F=k,B||D(function H(){F.on.ready.unsubscribe(I),F.on.ready.unsubscribe(H)}))})}}),this.Collection=(u=this,Ln(tl.prototype,function(H,M){this.db=u;var B=Os,F=null;if(M)try{B=M()}catch(K){F=K}var M=H._ctx,H=M.table,Y=H.hook.reading.fire;this._ctx={table:H,index:M.index,isPrimKey:!M.index||H.schema.primKey.keyPath&&M.index===H.schema.primKey.name,range:B,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:F,or:M.or,valueMapper:Y!==Mt?Y:null}})),this.Table=(d=this,Ln(Fs.prototype,function(D,I,B){this.db=d,this._tx=B,this.name=D,this.schema=I,this.hook=d._allTables[D]?d._allTables[D].hook:zs(null,{creating:[Vt,ct],reading:[fr,Mt],updating:[Mr,ct],deleting:[Cr,ct]})})),this.Transaction=(h=this,Ln(sl.prototype,function(D,I,B,F,M){var H=this;D!=="readonly"&&I.forEach(function(Y){Y=(Y=B[Y])==null?void 0:Y.yProps,Y&&(I=I.concat(Y.map(function(K){return K.updatesTable})))}),this.db=h,this.mode=D,this.storeNames=I,this.schema=B,this.chromeTransactionDurability=F,this.idbtrans=null,this.on=zs(this,"complete","error","abort"),this.parent=M||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new ue(function(Y,K){H._resolve=Y,H._reject=K}),this._completion.then(function(){H.active=!1,H.on.complete.fire()},function(Y){var K=H.active;return H.active=!1,H.on.error.fire(Y),H.parent?H.parent._reject(Y):K&&H.idbtrans&&H.idbtrans.abort(),zt(Y)})})),this.Version=(m=this,Ln(Si.prototype,function(D){this.db=m,this._cfg={version:D,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(b=this,Ln(os.prototype,function(D,I,B){if(this.db=b,this._ctx={table:D,index:I===":id"?null:I,or:B},this._cmp=this._ascending=ot,this._descending=function(F,M){return ot(M,F)},this._max=function(F,M){return 0<ot(F,M)?F:M},this._min=function(F,M){return ot(F,M)<0?F:M},this._IDBKeyRange=b._deps.IDBKeyRange,!this._IDBKeyRange)throw new Se.MissingAPI})),this.on("versionchange",function(D){0<D.newVersion?console.warn("Another connection wants to upgrade database '".concat(k.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(k.name,"'. Closing db now to resume the delete request.")),k.close({disableAutoOpen:!1})}),this.on("blocked",function(D){!D.newVersion||D.newVersion<D.oldVersion?console.warn("Dexie.delete('".concat(k.name,"') was blocked")):console.warn("Upgrade '".concat(k.name,"' blocked by other connection holding version ").concat(D.oldVersion/10))}),this._maxKey=en(a.IDBKeyRange),this._createTransaction=function(D,I,B,F){return new k.Transaction(D,I,B,k._options.chromeTransactionDurability,F)},this._fireOnBlocked=function(D){k.on("blocked").fire(D),yn.filter(function(I){return I.name===k.name&&I!==k&&!I._state.vcFired}).map(function(I){return I.on("versionchange").fire(D)})},this.use(Ei),this.use(ml),this.use(da),this.use(ul),this.use(_i),new Proxy(this,{get:function(D,I,B){var F;return I==="_vip"||(I==="table"?function(M){return rn(k.table(M),O)}:(F=Reflect.get(D,I,B))instanceof Fs?rn(F,O):I==="tables"?F.map(function(M){return rn(M,O)}):I==="_createTransaction"?function(){return rn(F.apply(this,arguments),O)}:F)}}));this.vip=O,z.forEach(function(D){return D(k)})}var Co,Bn=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",gl=(Un.prototype.subscribe=function(s,a,u){return this._subscribe(s&&typeof s!="function"?s:{next:s,error:a,complete:u})},Un.prototype[Bn]=function(){return this},Un);function Un(s){this._subscribe=s}try{Co={indexedDB:y.indexedDB||y.mozIndexedDB||y.webkitIndexedDB||y.msIndexedDB,IDBKeyRange:y.IDBKeyRange||y.webkitIDBKeyRange}}catch{Co={indexedDB:null,IDBKeyRange:null}}function hs(s){var a,u=!1,d=new gl(function(h){var m=w(s),b,k=!1,z={},$={},O={get closed(){return k},unsubscribe:function(){k||(k=!0,b&&b.abort(),D&&wn.storagemutated.unsubscribe(B))}},D=(h.start&&h.start(O),!1),I=function(){return fo(F)},B=function(M){jo(z,M),sa($,z)&&I()},F=function(){var M,H,Y;!k&&Co.indexedDB&&(z={},M={},b&&b.abort(),b=new AbortController,Y=(K=>{var le=hn();try{m&&rs();var me=mn(s,K);return me=m?me.finally(hr):me}finally{le&&Pn()}})(H={subscr:M,signal:b.signal,requery:I,querier:s,trans:null}),Promise.resolve(Y).then(function(K){u=!0,a=K,k||H.signal.aborted||(z={},(le=>{for(var me in le)if(J(le,me))return;return 1})($=M)||D||(wn(as,B),D=!0),fo(function(){return!k&&h.next&&h.next(K)}))},function(K){u=!1,["DatabaseClosedError","AbortError"].includes(K==null?void 0:K.name)||k||fo(function(){k||h.error&&h.error(K)})}))};return setTimeout(I,0),O});return d.hasValue=function(){return u},d.getValue=function(){return a},d}var $n=nn;function ms(s){var a=sn;try{sn=!0,wn.storagemutated.fire(s),la(s,!0)}finally{sn=a}}V($n,x(x({},N),{delete:function(s){return new $n(s,{addons:[]}).delete()},exists:function(s){return new $n(s,{addons:[]}).open().then(function(a){return a.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(s){try{return a=$n.dependencies,u=a.indexedDB,a=a.IDBKeyRange,(In(u)?Promise.resolve(u.databases()).then(function(d){return d.map(function(h){return h.name}).filter(function(h){return h!==Ls})}):Vs(u,a).toCollection().primaryKeys()).then(s)}catch{return zt(new Se.MissingAPI)}var a,u},defineClass:function(){return function(s){S(this,s)}},ignoreTransaction:function(s){return Ce.trans?xn(Ce.transless,s):s()},vip:fs,async:function(s){return function(){try{var a=ia(s.apply(this,arguments));return a&&typeof a.then=="function"?a:ue.resolve(a)}catch(u){return zt(u)}}},spawn:function(s,a,u){try{var d=ia(s.apply(u,a||[]));return d&&typeof d.then=="function"?d:ue.resolve(d)}catch(h){return zt(h)}},currentTransaction:{get:function(){return Ce.trans||null}},waitFor:function(s,a){return s=ue.resolve(typeof s=="function"?$n.ignoreTransaction(s):s).timeout(a||6e4),Ce.trans?Ce.trans.waitFor(s):s},Promise:ue,debug:{get:function(){return Nt},set:function(s){we(s)}},derive:fe,extend:S,props:V,override:oe,Events:zs,on:wn,liveQuery:hs,extendObservabilitySet:jo,getByKeyPath:je,setByKeyPath:de,delByKeyPath:function(s,a){typeof a=="string"?de(s,a,void 0):"length"in a&&[].map.call(a,function(u){de(s,u,void 0)})},shallowClone:Pe,deepClone:Te,getObjectDiff:ua,cmp:ot,asap:ie,minKey:-1/0,addons:[],connections:yn,errnames:qe,dependencies:Co,cache:Nn,semVer:"4.3.0",version:"4.3.0".split(".").map(function(s){return parseInt(s)}).reduce(function(s,a,u){return s+a/Math.pow(10,2*u)})})),$n.maxKey=en($n.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(wn(as,function(s){sn||(s=new CustomEvent(Fn,{detail:s}),sn=!0,dispatchEvent(s),sn=!1)}),addEventListener(Fn,function(s){s=s.detail,sn||ms(s)}));var gs,sn=!1,_o=function(){};return typeof BroadcastChannel<"u"&&((_o=function(){(gs=new BroadcastChannel(Fn)).onmessage=function(s){return s.data&&ms(s.data)}})(),typeof gs.unref=="function"&&gs.unref(),wn(as,function(s){sn||gs.postMessage(s)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(s){if(!nn.disableBfCache&&s.persisted){Nt&&console.debug("Dexie: handling persisted pagehide"),gs!=null&&gs.close();for(var a=0,u=yn;a<u.length;a++)u[a].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(s){!nn.disableBfCache&&s.persisted&&(Nt&&console.debug("Dexie: handling persisted pageshow"),_o(),ms({all:new sr(-1/0,[[]])}))})),ue.rejectionMapper=function(s,a){return!s||s instanceof pe||s instanceof TypeError||s instanceof SyntaxError||!s.name||!Ht[s.name]?s:(a=new Ht[s.name](a||s.message,s),"stack"in s&&he(a,"stack",{get:function(){return this.inner.stack}}),a)},we(Nt),x(nn,Object.freeze({__proto__:null,Dexie:nn,Entity:Ja,PropModification:bn,RangeSet:sr,add:function(s){return new bn({add:s})},cmp:ot,default:nn,liveQuery:hs,mergeRanges:qs,rangesOverlap:bo,remove:function(s){return new bn({remove:s})},replacePrefix:function(s,a){return new bn({replacePrefix:[s,a]})}}),{default:nn}),nn})})(ui)),ui.exports}var Mm=Om();const ac=uc(Mm),If=Symbol.for("Dexie"),pi=globalThis[If]||(globalThis[If]=ac);if(ac.semVer!==pi.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${ac.semVer} and ${pi.semVer}`);const{liveQuery:qg,mergeRanges:Hg,rangesOverlap:Qg,RangeSet:Yg,cmp:Gg,Entity:Xg,PropModification:Jg,replacePrefix:Zg,add:e0,remove:t0,DexieYProvider:r0}=pi;class Fm extends pi{constructor(){super("LibraDexieDB"),this.version(1).stores({books:"id,status,customOrder,addedAt,updatedAt,publisher,genre,[status+customOrder]",covers:"bookId,updatedAt"}),this.version(2).stores({books:"id,status,customOrder,addedAt,updatedAt,publisher,genre,[status+customOrder]",covers:"bookId,updatedAt",meta:"key,updatedAt"})}}const yt=new Fm,Hu={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1},zm="libra_use_dexie_storage";(()=>{try{return String((Hu==null?void 0:Hu.VITE_USE_DEXIE_STORAGE)||"").toLowerCase()==="true"}catch{return!1}})();const Im=i=>{try{localStorage.setItem(zm,String(i))}catch{}},yp="libra_dexie_fail_count",Bm="libra_dexie_last_op",Um=3,Ba=()=>new Date().toISOString(),$m=()=>{try{const i=localStorage.getItem(yp),p=Number(i);return Number.isFinite(p)?p:0}catch{return 0}},vp=i=>{try{localStorage.setItem(yp,String(Math.max(0,i)))}catch{}},bp=(i,p,f,x)=>{try{localStorage.setItem(Bm,JSON.stringify({op:i,ok:p,durationMs:f,reason:x,at:Ba()}))}catch{}},lc=async(i,p)=>{try{await yt.meta.put({key:i,value:JSON.stringify(p),updatedAt:Ba()})}catch{}},qa=async(i,p)=>{const f=Date.now()-p;vp(0),bp(i,!0,f),await lc("health_last_success",{op:i,durationMs:f,at:Ba()})},Ha=async(i,p)=>{const f=$m()+1;vp(f);const x=p instanceof Error?p.message:String(p);bp(i,!1,void 0,x),await lc("health_last_failure",{op:i,error:x,at:Ba(),failCount:f}),f>=Um&&(Im(!1),await lc("health_auto_fallback",{at:Ba(),failCount:f}),console.warn(`[Dexie] Auto-fallback to legacy storage after ${f} failures.`))},wp="LibraDB",Km=1,hi="books",Vm=()=>new Promise((i,p)=>{const f=indexedDB.open(wp,Km);f.onerror=()=>p(f.error),f.onsuccess=()=>i(f.result),f.onupgradeneeded=x=>{const C=x.target.result;C.objectStoreNames.contains(hi)||C.createObjectStore(hi,{keyPath:"id"})}}),Wm=i=>new Promise((p,f)=>{const y=i.transaction(hi,"readonly").objectStore(hi).getAll();y.onsuccess=()=>p(y.result),y.onerror=()=>f(y.error)}),qm=()=>new Promise((i,p)=>{const f=indexedDB.deleteDatabase(wp);f.onsuccess=()=>i(),f.onerror=()=>p(f.error),f.onblocked=()=>i()}),ic=()=>new Date().toISOString(),jp=async i=>{let p=i.coverBlob,f=i.coverUrl||"";p&&f.startsWith("blob:")&&(f=""),f.startsWith("data:image")&&(p=wc(f),f="");const{coverBlob:x,coverUrl:C,...y}=i,_=await yt.books.get(i.id),E=((_==null?void 0:_.version)||0)+1,S={...y,updatedAt:ic(),version:E};return!p&&!f?{meta:S}:{meta:S,cover:{bookId:i.id,coverBlob:p,coverUrl:f,updatedAt:ic()}}},Hm=(i,p)=>{const f=i,x=(p==null?void 0:p.coverBlob)??f.coverBlob,C=(p==null?void 0:p.coverUrl)??f.coverUrl??"";return{...i,coverBlob:x,coverUrl:C}},kp=async()=>yt.transaction("r",yt.books,yt.covers,async()=>{const[i,p]=await Promise.all([yt.books.toArray(),yt.covers.toArray()]),f=new Map(p.map(y=>[y.bookId,y])),x=i.map(y=>Hm(y,f.get(y.id)));return x.some(y=>typeof y.customOrder=="number")?[...x].sort((y,_)=>{const E=typeof y.customOrder=="number"?y.customOrder:Number.MAX_SAFE_INTEGER,S=typeof _.customOrder=="number"?_.customOrder:Number.MAX_SAFE_INTEGER;return E!==S?E-S:new Date(y.addedAt).getTime()-new Date(_.addedAt).getTime()}):x}),Qm=async i=>{const p=await jp(i);await yt.transaction("rw",yt.books,yt.covers,async()=>{await yt.books.put(p.meta),p.cover?await yt.covers.put(p.cover):await yt.covers.delete(i.id)})},Ym=async i=>{await Qm(i)},Gm=async i=>{await yt.transaction("rw",yt.books,yt.covers,async()=>{await yt.books.delete(i),await yt.covers.delete(i)})},Np=async i=>{await yt.transaction("rw",yt.books,yt.covers,async()=>{const p=new Set(i.map(C=>C.id)),f=await yt.books.toCollection().primaryKeys(),x=await yt.covers.toCollection().primaryKeys();for(const C of f){const y=String(C);p.has(y)||await yt.books.delete(y)}for(const C of x){const y=String(C);p.has(y)||await yt.covers.delete(y)}for(let C=0;C<i.length;C++){const y={...i[C],customOrder:C},_=await jp(y);await yt.books.put(_.meta),_.cover?await yt.covers.put(_.cover):await yt.covers.delete(y.id)}})},Xm=async i=>{await yt.transaction("rw",yt.books,async()=>{for(let p=0;p<i.length;p++){const f=i[p],x=await yt.books.get(f);x&&await yt.books.put({...x,customOrder:p,updatedAt:ic(),version:(x.version||0)+1})}})},Sp="legacy_idb_to_dexie_v1",Jm=i=>{const p=i.map(x=>`${x.id}|${x.updatedAt||""}|${x.addedAt}|${x.customOrder??""}`).sort().join("::");let f=0;for(let x=0;x<p.length;x++)f=f*31+p.charCodeAt(x)>>>0;return f.toString(16)},Zm=(i,p)=>{var x,C;const f={...i};return Array.isArray(f.sessions)||(f.sessions=[]),typeof f.customOrder!="number"&&(f.customOrder=p),f.updatedAt||(f.updatedAt=new Date().toISOString()),f.version||(f.version=1),(x=f.coverUrl)!=null&&x.startsWith("blob:")&&(f.coverUrl=""),(C=f.coverUrl)!=null&&C.startsWith("data:image")&&(f.coverBlob=wc(f.coverUrl),f.coverUrl=""),f},Bf=async(i,p)=>{await yt.meta.put({key:Sp,value:JSON.stringify({migrationVersion:1,migratedAt:new Date().toISOString(),sourceCount:i,checksum:p}),updatedAt:new Date().toISOString()})},eg=async()=>{if(await yt.meta.get(Sp))return{migrated:!1,reason:"already_done"};const p=await Vm(),f=await Wm(p);if(f.length===0)return await Bf(0,"0"),{migrated:!1,reason:"no_source_data"};const x=f.map((y,_)=>Zm(y,_)),C=Jm(x);await Np(x),await Bf(x.length,C);try{await qm()}catch{}return{migrated:!0,sourceCount:x.length,checksum:C}},Cp="booktracker_settings",_p=()=>{const i={accent:"indigo",bg:"cool",uiV2Enabled:!1,language:"en"};try{const p=localStorage.getItem(Cp);if(!p)return i;const f=JSON.parse(p),x=f.language==="uk"?"uk":"en";return{...i,...f,language:x}}catch{return i}},tg=i=>{localStorage.setItem(Cp,JSON.stringify(i))},qo=(i="booktracker_sort_prefs")=>{const p={key:"addedAt",direction:"desc"};try{const f=localStorage.getItem(i);return f?JSON.parse(f):p}catch{return p}},mi=(i,p,f)=>{localStorage.setItem(i,JSON.stringify({key:p,direction:f}))},Ep=()=>{alert("Warning: device storage is full.")},Pp=async()=>{const i=Date.now();try{await eg();const p=await kp();return await qa("loadLibrary",i),{books:p}}catch(p){return await Ha("loadLibrary",p),console.error("Failed to load library from Dexie",p),{books:[]}}},Tp=async i=>{const p=Date.now();try{await Np(i.books),await qa("saveLibrary",p)}catch(f){await Ha("saveLibrary",f),console.error("Failed to save library to Dexie",f),f instanceof DOMException&&f.name==="QuotaExceededError"&&Ep()}},rg=async i=>{const p=Date.now(),f=Rm("storage.saveBook","saveBook",{id:i.id,status:i.status,hasCoverBlob:!!i.coverBlob,coverUrlLen:(i.coverUrl||"").length});try{await Ym(i),await qa("saveBook",p),Ff(f,"info")}catch(x){await Ha("saveBook",x),Ff(f,"error",x),console.error("Failed to save book to Dexie",x),rr("error","storage.saveBook","saveBook failed",x),x instanceof DOMException&&x.name==="QuotaExceededError"&&Ep()}},ng=async i=>{const p=Date.now();try{await Xm(i),await qa("saveReorder",p)}catch(f){await Ha("saveReorder",f),console.error("Failed to save reorder in Dexie",f)}},sg=async i=>{const p=Date.now();try{await Gm(i),await qa("removeBook",p)}catch(f){await Ha("removeBook",f),console.error("Failed to remove book from Dexie",f)}},og=async()=>{try{const i=await kp(),f={books:await Promise.all(i.map(async E=>{const S={...E};return S.coverBlob&&(S.coverUrl=await mm(S.coverBlob),delete S.coverBlob),S}))},x=new Blob([JSON.stringify(f,null,2)],{type:"application/json"}),C=URL.createObjectURL(x),y=document.createElement("a"),_=new Date().toISOString().split("T")[0];y.href=C,y.download=`libra_library_${_}.json`,document.body.appendChild(y),y.click(),document.body.removeChild(y),URL.revokeObjectURL(C)}catch(i){throw console.error("Export failed",i),i}},Rp=j.createContext(void 0),pn=()=>{const i=j.useContext(Rp);if(!i)throw new Error("useLibrary must be used within a LibraryProvider");return i},ag=({children:i})=>{const[p,f]=j.useState({books:[]}),[x,C]=j.useState(!0),[y,_]=j.useState(""),E=j.useRef(Promise.resolve()),S=j.useRef(null),L=j.useRef(null),R=j.useRef(new Map),J=j.useCallback(async()=>{const oe=await Pp();f(oe),C(!1)},[]);j.useEffect(()=>{J()},[J]);const V=j.useCallback(oe=>{E.current=E.current.then(oe).catch(ce=>{console.error("Queued save failed",ce)})},[]),se=j.useCallback(()=>{const oe=Array.from(R.current.values());R.current.clear(),oe.length!==0&&V(async()=>{for(const ce of oe)await rg(ce)})},[V]),he=j.useCallback(oe=>{R.current.set(oe.id,oe),L.current&&clearTimeout(L.current),L.current=setTimeout(()=>{L.current=null,se()},120)},[V,se]);j.useEffect(()=>{const oe=()=>{document.visibilityState==="hidden"&&se()},ce=()=>{se()};return document.addEventListener("visibilitychange",oe),window.addEventListener("pagehide",ce),()=>{document.removeEventListener("visibilitychange",oe),window.removeEventListener("pagehide",ce),L.current&&clearTimeout(L.current),S.current&&clearTimeout(S.current),se()}},[se]);const fe=j.useCallback(oe=>{f(ce=>{const ie={...oe,customOrder:ce.books.length};try{he(ie)}catch(je){console.error("Failed to schedule save for new book",je)}return{...ce,books:[...ce.books,ie]}})},[he]),X=j.useCallback(oe=>{let ce={...oe};ce.status==="Reading"&&!ce.readingStartedAt&&(ce.readingStartedAt=new Date().toISOString()),(ce.status==="Wishlist"||ce.status==="Unread")&&(ce.readingStartedAt=void 0,ce.completedAt=void 0,ce.pagesRead=0,ce.sessions=[],ce.rating=void 0),f(ie=>{let je=null;const de=ie.books.map(Pe=>Pe.id!==ce.id?Pe:(je={...Pe,...ce,customOrder:Pe.customOrder},je));return je&&he(je),{...ie,books:de}})},[he]),Z=j.useCallback(oe=>{f(ce=>({...ce,books:ce.books.filter(ie=>ie.id!==oe)})),R.current.delete(oe),V(()=>sg(oe))},[V]),te=j.useCallback(oe=>{f(ce=>({...ce,books:oe})),S.current&&clearTimeout(S.current),S.current=setTimeout(()=>{se(),V(()=>ng(oe.map(ce=>ce.id))),S.current=null},250)},[V,se]);return n.jsx(Rp.Provider,{value:{books:p.books,isLoading:x,addBook:fe,updateBook:X,deleteBook:Z,reorderBooks:te,refreshLibrary:J,filterTag:y,setFilterTag:_},children:i})},Dp=j.createContext(void 0),Yo=()=>{const i=j.useContext(Dp);if(!i)throw new Error("useUI must be used within a UIProvider");return i},lg=({toasts:i,removeToast:p})=>n.jsx("div",{className:"fixed top-4 left-1/2 -translate-x-1/2 z-[150] flex flex-col gap-2 w-[90%] max-w-sm pointer-events-none",children:i.map(f=>n.jsxs("div",{className:"pointer-events-auto bg-white/90 backdrop-blur-md shadow-lg border border-gray-100 p-4 rounded-2xl flex items-center gap-3 animate-in slide-in-from-top-5 fade-in duration-300",children:[f.type==="success"&&n.jsx("div",{className:"p-1 bg-emerald-100 rounded-full text-emerald-600",children:n.jsx(ci,{size:16})}),f.type==="error"&&n.jsx("div",{className:"p-1 bg-red-100 rounded-full text-red-600",children:n.jsx(dc,{size:16})}),f.type==="info"&&n.jsx("div",{className:"p-1 bg-indigo-100 rounded-full text-indigo-600",children:n.jsx(np,{size:16})}),n.jsx("p",{className:"text-sm font-bold text-gray-800 flex-1",children:f.message}),n.jsx("button",{onClick:()=>p(f.id),className:"text-gray-400 hover:text-gray-600",children:n.jsx(Ur,{size:16})})]},f.id))}),ig=({isOpen:i,options:p,onClose:f})=>!i||!p?null:n.jsx("div",{className:"fixed inset-0 z-[200] flex items-center justify-center p-4 bg-black/40 backdrop-blur-sm animate-in fade-in duration-200",children:n.jsxs("div",{className:"bg-white w-full max-w-sm rounded-[2rem] p-6 shadow-2xl animate-in zoom-in-95 duration-200",children:[n.jsxs("div",{className:"flex flex-col items-center text-center mb-6",children:[p.type==="danger"?n.jsx("div",{className:"w-12 h-12 bg-red-50 rounded-full flex items-center justify-center mb-4 text-red-500",children:n.jsx(dc,{size:24})}):n.jsx("div",{className:"w-12 h-12 bg-indigo-50 rounded-full flex items-center justify-center mb-4 text-indigo-500",children:n.jsx(np,{size:24})}),n.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-2",children:p.title}),n.jsx("p",{className:"text-sm text-gray-500",children:p.message})]}),n.jsxs("div",{className:"flex gap-3",children:[n.jsx("button",{onClick:()=>f(!1),className:"flex-1 py-3 bg-gray-50 text-gray-700 font-bold rounded-xl hover:bg-gray-100 active:scale-95 transition-all",children:p.cancelText||"Cancel"}),n.jsx("button",{onClick:()=>f(!0),className:`flex-1 py-3 font-bold rounded-xl text-white shadow-lg active:scale-95 transition-all ${p.type==="danger"?"bg-red-500 shadow-red-200":"bg-indigo-600 shadow-indigo-200"}`,children:p.confirmText||"Confirm"})]})]})}),ug=({children:i})=>{const[p,f]=j.useState([]),[x,C]=j.useState({isOpen:!1,options:null,resolver:null}),y=j.useCallback((L,R="info")=>{const J=fn();f(V=>[...V,{id:J,message:L,type:R}]),setTimeout(()=>{f(V=>V.filter(se=>se.id!==J))},3e3)},[]),_=j.useCallback(L=>{f(R=>R.filter(J=>J.id!==L))},[]),E=j.useCallback(L=>new Promise(R=>{C({isOpen:!0,options:L,resolver:R})}),[]),S=L=>{x.resolver&&x.resolver(L),C({isOpen:!1,options:null,resolver:null})};return n.jsxs(Dp.Provider,{value:{toast:{show:y},confirm:E},children:[i,n.jsx(lg,{toasts:p,removeToast:_}),n.jsx(ig,{isOpen:x.isOpen,options:x.options,onClose:S})]})},cg=({className:i})=>n.jsx("div",{className:`animate-pulse bg-gray-200 rounded-xl ${i}`}),Jn={Paper:"Paper","E-book":"E-book",Audio:"Audio",Pirate:"Pirate",Expected:"Expected",Sold:"Sold"},gi={Reading:"Reading",Completed:"Completed",Unread:"Unread",Wishlist:"Wishlist"},Sc=["Winter","Spring","Summer","Autumn"],li={winter:"",spring:"",summer:"",autumn:""},Uf={summer:"",autumn:""},Zn=i=>{const p=i.trim().toLowerCase();return p?p==="winter"||p===li.winter||p==="zyma"?"Winter":p==="spring"||p===li.spring||p==="vesna"?"Spring":p==="summer"||p===li.summer||p===Uf.summer||p==="lito"?"Summer":p==="autumn"||p==="fall"||p===li.autumn||p===Uf.autumn||p==="osin"?"Autumn":i.trim():""},uo=i=>{switch(Zn(i)){case"Winter":return"bg-sky-100 text-sky-700";case"Spring":return"bg-violet-100 text-violet-700";case"Summer":return"bg-emerald-100 text-emerald-700";case"Autumn":return"bg-orange-100 text-orange-700";default:return"bg-gray-100 text-gray-700"}},$r=i=>i.readingPagesTotal||i.pagesTotal||0,Ho=(i,p)=>!i||!p?0:Math.min(100,Math.round(i/p*100)),dg=i=>{const p=Math.floor(i/3600),f=Math.floor(i%3600/60),x=i%60;return p>0?`${p}:${f.toString().padStart(2,"0")}:${x.toString().padStart(2,"0")}`:`${f.toString().padStart(2,"0")}:${x.toString().padStart(2,"0")}`},Ap=i=>i<=2?"#3E2723":i<=4?"#5D4037":i<=6?"#8D6E63":i<=8?"#FBC02D":"#FFD700",Cc=i=>{if(!i.sessions||i.sessions.length===0)return 0;const p=i.sessions.reduce((x,C)=>x+Number(C.pages),0),f=i.sessions.reduce((x,C)=>x+Number(C.duration),0);return f>0?Math.round(p/(f/3600)):0},Lp=i=>i.sessions?Math.round(i.sessions.reduce((p,f)=>p+Number(f.duration),0)/60):0,fg=i=>{const p=Cc(i),f=$r(i);if(p===0||!f)return"Unknown";const x=f-(i.pagesRead||0);if(x<=0)return"Completed";const C=x/p,y=Math.floor(C),_=Math.round((C-y)*60);return y>0?`${y} h ${_} min left`:`${_} min left`},Op={indigo:{label:"Indigo (Default)",hex:"#4f46e5",shades:{50:"#eef2ff",100:"#e0e7ff",200:"#c7d2fe",500:"#6366f1",600:"#4f46e5",700:"#4338ca"}},rose:{label:"Rose",hex:"#e11d48",shades:{50:"#fff1f2",100:"#ffe4e6",200:"#fecdd3",500:"#f43f5e",600:"#e11d48",700:"#be123c"}},pink:{label:"Pink",hex:"#ec4899",shades:{50:"#fdf2f8",100:"#fce7f3",200:"#fbcfe8",500:"#ec4899",600:"#db2777",700:"#be185d"}},amber:{label:"Amber",hex:"#d97706",shades:{50:"#fffbeb",100:"#fef3c7",200:"#fde68a",500:"#f59e0b",600:"#d97706",700:"#b45309"}},gold:{label:"Gold",hex:"#eab308",shades:{50:"#fefce8",100:"#fef9c3",200:"#fde047",500:"#eab308",600:"#ca8a04",700:"#a16207"}},emerald:{label:"Emerald",hex:"#059669",shades:{50:"#ecfdf5",100:"#d1fae5",200:"#a7f3d0",500:"#10b981",600:"#059669",700:"#047857"}},violet:{label:"Violet",hex:"#7c3aed",shades:{50:"#f5f3ff",100:"#ede9fe",200:"#ddd6fe",500:"#8b5cf6",600:"#7c3aed",700:"#6d28d9"}},sky:{label:"Sky",hex:"#0284c7",shades:{50:"#f0f9ff",100:"#e0f2fe",200:"#bae6fd",500:"#0ea5e9",600:"#0284c7",700:"#0369a1"}},black:{label:"Black",hex:"#18181b",shades:{50:"#f4f4f5",100:"#e4e4e7",200:"#d4d4d8",500:"#3f3f46",600:"#18181b",700:"#09090b"}},white:{label:"White",hex:"#ffffff",shades:{50:"#f9fafb",100:"#f3f4f6",200:"#e5e7eb",500:"#9ca3af",600:"#4b5563",700:"#374151"}}},Mp={cool:{label:"Cool",hex:"#f8fafc",vars:{main:"#f8fafc",card:"#f1f5f9",element:"#e2e8f0",surface:"#ffffff",border:"#cbd5e1",textPrimary:"#1e293b",textBody:"#334155",textSecondary:"#64748b",textLight:"#94a3b8"}},warm:{label:"Warm",hex:"#fafaf9",vars:{main:"#fafaf9",card:"#f5f5f4",element:"#e7e5e4",surface:"#ffffff",border:"#d6d3d1",textPrimary:"#1c1917",textBody:"#44403c",textSecondary:"#78716c",textLight:"#a8a29e"}},neutral:{label:"Neutral",hex:"#fafafa",vars:{main:"#fafafa",card:"#f4f4f5",element:"#e4e4e7",surface:"#ffffff",border:"#d4d4d8",textPrimary:"#18181b",textBody:"#3f3f46",textSecondary:"#71717a",textLight:"#a1a1aa"}},peach:{label:"Peach",hex:"#fff7ed",vars:{main:"#fff7ed",card:"#ffedd5",element:"#fed7aa",surface:"#ffffff",border:"#fdba74",textPrimary:"#431407",textBody:"#7c2d12",textSecondary:"#9a3412",textLight:"#c2410c"}},mint:{label:"Mint",hex:"#f0fdf4",vars:{main:"#f0fdf4",card:"#dcfce7",element:"#bbf7d0",surface:"#ffffff",border:"#86efac",textPrimary:"#022c22",textBody:"#064e3b",textSecondary:"#065f46",textLight:"#047857"}},dark:{label:"Dark",hex:"#0f172a",vars:{main:"#0f172a",card:"#1e293b",element:"#334155",surface:"#1e293b",border:"#334155",textPrimary:"#f8fafc",textBody:"#e2e8f0",textSecondary:"#94a3b8",textLight:"#64748b"}},midnight:{label:"Midnight",hex:"#020617",vars:{main:"#020617",card:"#0f172a",element:"#1e293b",surface:"#0f172a",border:"#1e293b",textPrimary:"#f8fafc",textBody:"#e2e8f0",textSecondary:"#94a3b8",textLight:"#64748b"}},forest:{label:"Forest",hex:"#022c22",vars:{main:"#022c22",card:"#064e3b",element:"#065f46",surface:"#064e3b",border:"#065f46",textPrimary:"#ecfdf5",textBody:"#d1fae5",textSecondary:"#6ee7b7",textLight:"#34d399"}}},Fp=(i,p)=>{const f=document.documentElement,x=Op[i],C=Mp[p];Object.entries(x.shades).forEach(([y,_])=>{f.style.setProperty(`--accent-${y}`,_)}),f.style.setProperty("--bg-main",C.vars.main),f.style.setProperty("--bg-card",C.vars.card),f.style.setProperty("--bg-element",C.vars.element),f.style.setProperty("--bg-surface",C.vars.surface),f.style.setProperty("--border-color",C.vars.border),f.style.setProperty("--text-primary",C.vars.textPrimary),f.style.setProperty("--text-body",C.vars.textBody),f.style.setProperty("--text-secondary",C.vars.textSecondary),f.style.setProperty("--text-light",C.vars.textLight)},pg=({label:i,active:p,onChange:f})=>n.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-2xl border border-gray-100",children:[n.jsx("span",{className:"text-xs font-bold text-gray-700",children:i}),n.jsx("button",{type:"button",onClick:()=>f(!p),className:`w-10 h-5 rounded-full transition-colors relative ${p?"bg-indigo-600":"bg-gray-200"}`,children:n.jsx("div",{className:`absolute top-0.5 w-4 h-4 bg-white rounded-full transition-all ${p?"left-5.5":"left-0.5"}`})})]}),hg=({onAddSuccess:i,onCancel:p})=>{const{addBook:f,books:x}=pn(),{toast:C}=Yo(),y=j.useRef(null),_=j.useRef(null),[E,S]=j.useState(!1),[L,R]=j.useState(!1),[J,V]=j.useState(!1),[se,he]=j.useState(!1),[fe,X]=j.useState(!1),Z=j.useRef(0),[te,oe]=j.useState({title:"",author:"",seasons:[],genre:"",publisher:"",series:"",seriesPart:"",pagesTotal:0,isbn:"",formats:["Paper"],status:"Unread",coverUrl:"",coverBlob:void 0,notes:"",comment:""}),ce=j.useCallback(ae=>{oe(G=>({...G,...ae}))},[]),ie=j.useCallback((ae,G)=>ae.replace(/[\u0000-\u0008\u000B\u000C\u000E-\u001F\u007F\u200B-\u200D\uFEFF]/g,"").slice(0,G),[]),je=j.useCallback(ae=>{const G=Date.now();G-Z.current<250||(Z.current=G,ae())},[]),de=j.useMemo(()=>{const ae=new Set;return x.forEach(G=>{G.publisher&&G.publisher.trim()&&ae.add(G.publisher.trim())}),Array.from(ae).sort()},[x]),Pe=j.useMemo(()=>te.publisher?de.filter(ae=>ae.toLowerCase().includes((te.publisher||"").toLowerCase())):de,[de,te.publisher]),Be=j.useMemo(()=>{const ae=new Set;return x.forEach(G=>{const T=(G.genre||"").trim();T&&ae.add(T)}),Array.from(ae).sort((G,T)=>G.localeCompare(T,"uk"))},[x]),Ye=j.useMemo(()=>{if(!te.genre)return Be;const ae=(te.genre||"").toLowerCase();return Be.filter(G=>G.toLowerCase().includes(ae))},[Be,te.genre]),We=j.useCallback(()=>{_.current&&(URL.revokeObjectURL(_.current),_.current=null)},[]);j.useEffect(()=>()=>We(),[We]);const Ge=async ae=>{var T;const G=(T=ae.target.files)==null?void 0:T[0];if(G){S(!0);try{const v=await jc(G),w=URL.createObjectURL(v);We(),_.current=w,ce({coverBlob:v,coverUrl:w}),C.show(" ","success")}catch(v){console.error("Image processing failed",v),C.show("   ","error")}finally{S(!1)}}},Te=async()=>{if(!te.title){C.show("    ","info");return}R(!0);try{const ae=await Qo(te.title,te.author||"");ae?(We(),ce({coverUrl:ae,coverBlob:void 0}),C.show(" ","success")):C.show("  ","info")}catch(ae){console.error(ae),C.show(" ","error")}finally{R(!1)}},et=ae=>{oe(G=>{const T=G.formats||[];return T.includes(ae)?T.length<=1?G:{...G,formats:T.filter(v=>v!==ae)}:{...G,formats:[...T,ae]}})},lt=ae=>{const G=Zn(ae),T=te.seasons||[],v=T.includes(G)?T.filter(w=>w!==G):[...T,G];ce({seasons:v})},it=ae=>{if(ae.preventDefault(),!J){if(!te.title||!te.author){C.show("   '","error");return}try{V(!0);const G={id:fn(),title:te.title,author:te.author,seasons:te.seasons||[],genre:te.genre,publisher:te.publisher,series:te.series,seriesPart:te.seriesPart,pagesTotal:Number(te.pagesTotal)||0,pagesRead:0,isbn:te.isbn,formats:te.formats||["Paper"],status:te.status,addedAt:new Date().toISOString(),readingStartedAt:te.status==="Reading"?new Date().toISOString():void 0,coverUrl:te.coverUrl||"",coverBlob:te.coverBlob,notes:te.notes,comment:te.comment,sessions:[]};f(G),i();try{C.show(" ","success")}catch(T){console.error("Add book success toast failed",T)}We(),oe({title:"",author:"",seasons:[],genre:"",publisher:"",series:"",seriesPart:"",pagesTotal:0,isbn:"",formats:["Paper"],status:"Unread",coverUrl:"",coverBlob:void 0,notes:"",comment:""})}catch(G){console.error("Add book submit failed",G),C.show("   ","error")}finally{V(!1)}}};return n.jsxs("div",{className:"h-[100dvh] overflow-y-auto overscroll-contain p-4 space-y-6 pb-24 text-gray-800",children:[n.jsxs("button",{onClick:p,className:"flex items-center gap-2 text-gray-400 hover:text-gray-600 transition-colors",children:[n.jsx(Ua,{size:20})," ",n.jsx("span",{className:"text-sm font-bold",children:""})]}),n.jsxs("header",{children:[n.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:" "}),n.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"     "})]}),n.jsxs("form",{onSubmit:it,className:"bg-white p-6 rounded-3xl shadow-sm space-y-5 border border-gray-100",children:[n.jsxs("div",{className:"flex justify-center mb-2 relative",children:[n.jsx("button",{type:"button",onClick:()=>{var ae;return(ae=y.current)==null?void 0:ae.click()},disabled:E||L,className:"relative w-28 aspect-[2/3] bg-gray-50 rounded-2xl border-2 border-dashed border-gray-200 flex flex-col items-center justify-center overflow-hidden hover:bg-gray-100 transition-colors disabled:opacity-50",children:E||L?n.jsx(cg,{className:"w-full h-full"}):te.coverUrl?n.jsx("img",{src:te.coverUrl,className:"w-full h-full object-cover"}):n.jsxs(n.Fragment,{children:[n.jsx(vi,{className:"text-gray-300 mb-2",size:28}),n.jsx("span",{className:"text-[9px] font-bold text-gray-400 uppercase",children:""})]})}),n.jsx("input",{type:"file",ref:y,className:"hidden",accept:"image/*",onChange:Ge}),n.jsx("button",{type:"button",onClick:Te,disabled:L||E,className:"absolute top-0 right-16 translate-x-full bg-white p-3 rounded-2xl text-indigo-600 shadow-lg border border-indigo-50 active:scale-95 transition-all disabled:opacity-50",title:" ",children:L?n.jsx(Xr,{className:"animate-spin",size:20}):n.jsx(Wa,{size:20})})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"space-y-1",children:[n.jsx("label",{className:"text-[10px] font-bold text-gray-400 uppercase ml-1",children:""}),n.jsx("input",{required:!0,maxLength:180,placeholder:" ",className:"w-full bg-gray-50 p-3 rounded-2xl outline-none focus:ring-1 focus:ring-indigo-500 border-none transition-all text-sm font-bold",value:te.title,onChange:ae=>ce({title:ie(ae.target.value,180)})})]}),n.jsxs("div",{className:"space-y-1",children:[n.jsx("label",{className:"text-[10px] font-bold text-gray-400 uppercase ml-1",children:""}),n.jsx("input",{required:!0,maxLength:140,placeholder:"' ",className:"w-full bg-gray-50 p-3 rounded-2xl outline-none focus:ring-1 focus:ring-indigo-500 border-none transition-all text-sm font-bold",value:te.author,onChange:ae=>ce({author:ie(ae.target.value,140)})})]}),n.jsxs("div",{className:"space-y-1",children:[n.jsx("label",{className:"text-[10px] font-bold text-gray-400 uppercase ml-1",children:"URL "}),n.jsxs("div",{className:"relative",children:[n.jsx(gc,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-300",size:14}),n.jsx("input",{placeholder:"https://example.com/image.jpg",className:"w-full bg-gray-50 pl-9 pr-3 py-3 rounded-2xl text-xs font-bold border-none outline-none",maxLength:1024,value:te.coverUrl||"",onChange:ae=>{We(),ce({coverUrl:ie(ae.target.value,1024),coverBlob:void 0})}})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsxs("div",{className:"space-y-1 relative",children:[n.jsx("label",{className:"text-[10px] font-bold text-gray-400 uppercase ml-1",children:""}),n.jsxs("div",{className:"relative",children:[n.jsx(xi,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-300",size:14}),n.jsx("input",{placeholder:"",className:"w-full bg-gray-50 pl-9 pr-3 py-3 rounded-2xl text-xs font-bold border-none outline-none focus:ring-1 focus:ring-indigo-500",maxLength:120,value:te.publisher,onChange:ae=>{ce({publisher:ie(ae.target.value,120)}),he(!0)},onFocus:()=>he(!0),onBlur:()=>setTimeout(()=>he(!1),200)}),se&&Pe.length>0&&n.jsx("div",{className:"absolute top-full left-0 right-0 mt-1 bg-white border border-gray-100 rounded-xl shadow-xl z-50 max-h-40 overflow-y-auto",children:Pe.map((ae,G)=>n.jsx("button",{type:"button",onTouchStart:T=>{T.preventDefault(),je(()=>{ce({publisher:ae}),he(!1)})},onPointerDown:T=>{T.preventDefault(),je(()=>{ce({publisher:ae}),he(!1)})},onClick:()=>je(()=>{ce({publisher:ae}),he(!1)}),className:"w-full text-left px-4 py-2 text-xs font-bold text-gray-700 hover:bg-gray-50 border-b border-gray-50 last:border-none",children:ae},G))})]})]}),n.jsxs("div",{className:"space-y-1",children:[n.jsx("label",{className:"text-[10px] font-bold text-gray-400 uppercase ml-1",children:" / "}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs("div",{className:"relative flex-1",children:[n.jsx(mc,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-300",size:14}),n.jsx("input",{maxLength:120,placeholder:" ",className:"w-full bg-gray-50 pl-9 pr-2 py-3 rounded-2xl text-xs font-bold border-none outline-none",value:te.series,onChange:ae=>ce({series:ie(ae.target.value,120)})})]}),n.jsx("div",{className:"w-16",children:n.jsx("input",{type:"text",maxLength:60,placeholder:"#",className:"w-full bg-gray-50 px-2 py-3 rounded-2xl text-xs font-bold border-none outline-none text-center",value:te.seriesPart,onChange:ae=>ce({seriesPart:ie(ae.target.value,60)})})})]})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsxs("div",{className:"space-y-1 relative",children:[n.jsx("label",{className:"text-[10px] font-bold text-gray-400 uppercase ml-1",children:""}),n.jsx("input",{placeholder:"",className:"w-full bg-gray-50 p-3 rounded-2xl text-xs font-bold border-none outline-none",value:te.genre,maxLength:160,onChange:ae=>{ce({genre:ie(ae.target.value,160)}),X(!0)},onFocus:()=>X(!0),onBlur:()=>setTimeout(()=>X(!1),200)}),fe&&Ye.length>0&&n.jsx("div",{className:"absolute top-full left-0 right-0 mt-1 bg-white border border-gray-100 rounded-xl shadow-xl z-50 max-h-40 overflow-y-auto",children:Ye.map((ae,G)=>n.jsx("button",{type:"button",onTouchStart:T=>{T.preventDefault(),je(()=>{ce({genre:ae}),X(!1)})},onPointerDown:T=>{T.preventDefault(),je(()=>{ce({genre:ae}),X(!1)})},onClick:()=>je(()=>{ce({genre:ae}),X(!1)}),className:"w-full text-left px-4 py-2 text-xs font-bold text-gray-700 hover:bg-gray-50 border-b border-gray-50 last:border-none",children:ae},`${ae}-${G}`))})]}),n.jsxs("div",{className:"space-y-1",children:[n.jsx("label",{className:"text-[10px] font-bold text-gray-400 uppercase ml-1",children:""}),n.jsx("input",{inputMode:"numeric",pattern:"[0-9]*",type:"number",placeholder:"0",className:"w-full bg-gray-50 p-3 rounded-2xl text-xs font-bold border-none outline-none",value:te.pagesTotal||"",onChange:ae=>ce({pagesTotal:parseInt(ae.target.value)||0})})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx("label",{className:"text-[10px] font-bold text-gray-400 uppercase ml-1",children:""}),n.jsx("div",{className:"grid grid-cols-2 gap-2",children:Sc.map(ae=>{const G=(te.seasons||[]).includes(ae);return n.jsxs("button",{type:"button",onClick:()=>lt(ae),className:`px-3 py-2 rounded-xl text-xs font-bold border transition-all flex items-center justify-between ${G?"border-transparent":"bg-gray-50 text-gray-500 border-gray-100"}`,children:[n.jsx("span",{className:`px-2 py-0.5 rounded-full ${uo(ae)}`,children:ae}),n.jsx("span",{className:`w-3 h-3 rounded-full border-2 ${G?"border-indigo-600 bg-indigo-600":"border-gray-300 bg-transparent"}`})]},ae)})})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx("label",{className:"text-[10px] font-bold text-gray-400 uppercase ml-1",children:""}),n.jsx("div",{className:"grid grid-cols-2 gap-2",children:["Paper","E-book","Audio","Pirate","Expected","Sold"].map(ae=>{var G;return n.jsx(pg,{label:ae,active:((G=te.formats)==null?void 0:G.includes(ae))||!1,onChange:()=>et(ae)},ae)})})]}),n.jsxs("div",{className:"space-y-1",children:[n.jsx("label",{className:"text-[10px] font-bold text-gray-400 uppercase ml-1",children:" ()"}),n.jsx("input",{placeholder:" ",className:"w-full bg-gray-50 p-3 rounded-2xl outline-none border-none text-xs font-medium placeholder:text-gray-300",maxLength:80,value:te.notes||"",onChange:ae=>ce({notes:ie(ae.target.value,80)})})]}),n.jsxs("div",{className:"space-y-1",children:[n.jsx("label",{className:"text-[10px] font-bold text-gray-400 uppercase ml-1",children:""}),n.jsx("textarea",{placeholder:"   ...",className:"w-full bg-gray-50 p-3 rounded-2xl outline-none border-none text-sm font-medium resize-none h-20 placeholder:text-gray-300 placeholder:text-xs",maxLength:2e3,value:te.comment||"",onChange:ae=>ce({comment:ie(ae.target.value,2e3)})})]}),n.jsxs("div",{className:"space-y-1",children:[n.jsx("label",{className:"text-[10px] font-bold text-gray-400 uppercase ml-1",children:""}),n.jsxs("select",{className:"w-full bg-gray-50 p-3 rounded-2xl outline-none text-xs font-bold appearance-none",value:te.status,onChange:ae=>ce({status:ae.target.value}),children:[n.jsx("option",{value:"Unread",children:" "}),n.jsx("option",{value:"Reading",children:""}),n.jsx("option",{value:"Completed",children:""})]})]}),n.jsxs("button",{type:"submit",disabled:J,className:"w-full bg-indigo-600 text-white py-4 rounded-2xl font-bold shadow-lg shadow-indigo-100 mt-2 active:scale-95 transition-all flex items-center justify-center gap-2 disabled:opacity-70 disabled:cursor-not-allowed",children:[n.jsx(Ka,{size:18}),"  "]})]})]})]})},Or=Nr.memo(({book:i,className:p,iconSize:f=24})=>{const[x,C]=j.useState(null),[y,_]=j.useState(!1);return j.useEffect(()=>{let E=null;return _(!1),i.coverBlob?(E=URL.createObjectURL(i.coverBlob),C(E)):i.coverUrl?C(i.coverUrl):C(null),()=>{E&&URL.revokeObjectURL(E)}},[i.coverBlob,i.coverUrl,i.id]),x&&!y?n.jsx("img",{src:x,className:`object-cover ${p}`,alt:i.title,loading:"lazy",onError:()=>_(!0)}):n.jsx("div",{className:`flex items-center justify-center bg-gray-50 text-gray-300 ${p}`,children:n.jsx(Zf,{size:f})})}),mg=({book:i,onClose:p,onOpenReadingMode:f,onEdit:x,onDelete:C,onTagClick:y,onStartReadingWishlist:_})=>{const{confirm:E,toast:S}=Yo(),L=se=>rr("info","bookView.tap",se),R=Nr.useRef(0),J=Nr.useCallback(se=>{const he=Date.now();he-R.current<350||(R.current=he,se())},[]),V=async()=>{await E({title:" ?",message:` ,    "${i.title}"?    .`,type:"danger",confirmText:"",cancelText:""})&&(C(),S.show(" ","info"))};return n.jsxs("div",{className:"flex flex-col h-full bg-white sm:rounded-[2.5rem] overflow-hidden",children:[n.jsxs("div",{className:"sticky top-0 z-40 bg-white p-6 border-b border-gray-100 shadow-sm",children:[n.jsx("button",{onPointerDownCapture:()=>L("close:pointerdown"),onTouchStartCapture:()=>L("close:touchstart"),onClick:()=>J(p),onTouchEnd:()=>J(p),className:"absolute top-4 right-4 p-2 bg-gray-50 hover:bg-gray-100 rounded-full text-gray-400 hover:text-gray-600 transition-colors z-50 touch-manipulation",children:n.jsx(Ur,{size:20})}),n.jsxs("div",{className:"flex gap-5",children:[n.jsx("div",{className:"w-32 aspect-[2/3] bg-gray-50 rounded-2xl shadow-lg overflow-hidden border border-gray-100 flex-shrink-0 relative",children:n.jsx(Or,{book:i,className:"w-full h-full",iconSize:32})}),n.jsxs("div",{className:"flex-1 min-w-0 flex flex-col justify-end pb-1",children:[i.status==="Wishlist"?n.jsxs("button",{onPointerDownCapture:()=>L("startWishlist:pointerdown"),onTouchStartCapture:()=>L("startWishlist:touchstart"),onClick:()=>J(_),onTouchEnd:()=>J(_),className:"w-full bg-indigo-600 text-white py-3 rounded-2xl font-bold flex items-center justify-center gap-2 mb-4 shadow-lg shadow-indigo-500/40 active:scale-95 transition-all touch-manipulation",children:[n.jsx(Sr,{size:16,fill:"currentColor"})," ",n.jsx("span",{className:"text-sm",children:" "})]}):n.jsxs("button",{onPointerDownCapture:()=>L("openReading:pointerdown"),onTouchStartCapture:()=>L("openReading:touchstart"),onClick:()=>J(f),onTouchEnd:()=>J(f),className:"w-full bg-indigo-600 text-white py-3 rounded-2xl font-bold flex items-center justify-center gap-2 mb-4 shadow-lg shadow-indigo-500/40 active:scale-95 transition-all touch-manipulation",children:[n.jsx(ap,{size:16,fill:"currentColor"})," ",n.jsx("span",{className:"text-sm",children:""})]}),n.jsx("div",{className:"mb-2",children:n.jsx("span",{className:`inline-block px-2.5 py-1 rounded-lg text-[10px] font-bold uppercase tracking-wider ${i.status==="Completed"?"bg-emerald-50 text-emerald-600":i.status==="Wishlist"?"bg-pink-50 text-pink-600":"bg-indigo-50 text-indigo-600"}`,children:gi[i.status]})}),n.jsx("h2",{className:"text-xl font-bold text-gray-800 leading-tight line-clamp-3 mb-1",children:i.title}),n.jsx("button",{onClick:()=>y(i.author),className:"text-sm font-medium text-gray-400 truncate hover:text-indigo-600 transition-colors text-left active:scale-95",children:i.author})]})]})]}),n.jsx("div",{className:"px-6 py-6 overflow-y-auto no-scrollbar flex-1",children:n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsxs("button",{onClick:()=>y(i.publisher),className:"bg-gray-50 p-3 rounded-2xl border border-gray-100 flex items-center gap-3 text-left hover:bg-indigo-50 hover:border-indigo-100 transition-all active:scale-95",children:[n.jsx(xi,{size:16,className:"text-gray-400"}),n.jsxs("div",{className:"min-w-0",children:[n.jsx("p",{className:"text-[8px] text-gray-400 uppercase font-bold",children:""}),n.jsx("p",{className:"text-[10px] font-bold text-gray-700 truncate",children:i.publisher||""})]})]}),n.jsxs("button",{onClick:()=>y(i.genre),className:"bg-gray-50 p-3 rounded-2xl border border-gray-100 flex items-center gap-3 text-left hover:bg-indigo-50 hover:border-indigo-100 transition-all active:scale-95",children:[n.jsx(up,{size:16,className:"text-gray-400"}),n.jsxs("div",{className:"min-w-0",children:[n.jsx("p",{className:"text-[8px] text-gray-400 uppercase font-bold",children:""}),n.jsx("p",{className:"text-[10px] font-bold text-gray-700 truncate",children:i.genre||""})]})]}),n.jsxs("button",{onClick:()=>{var se;return y((se=i.seasons)==null?void 0:se.join(", "))},className:"col-span-2 bg-gray-50 p-3 rounded-2xl border border-gray-100 flex items-center gap-3 text-left hover:bg-indigo-50 hover:border-indigo-100 transition-all active:scale-95",children:[n.jsx(Ia,{size:16,className:"text-gray-400"}),n.jsxs("div",{className:"min-w-0",children:[n.jsx("p",{className:"text-[8px] text-gray-400 uppercase font-bold",children:""}),i.seasons&&i.seasons.length>0?n.jsx("div",{className:"flex flex-wrap gap-1.5 mt-1",children:i.seasons.map(se=>n.jsx("span",{className:`text-[9px] px-2 py-0.5 rounded-full font-bold ${uo(se)}`,children:se},se))}):n.jsx("p",{className:"text-[10px] font-bold text-gray-700 truncate",children:""})]})]}),n.jsxs("button",{onClick:()=>y(i.series),className:"col-span-2 bg-gray-50 p-3 rounded-2xl border border-gray-100 flex items-center gap-3 text-left hover:bg-indigo-50 hover:border-indigo-100 transition-all active:scale-95",children:[n.jsx(mc,{size:16,className:"text-gray-400"}),n.jsxs("div",{className:"min-w-0 flex-1 flex justify-between items-center",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-[8px] text-gray-400 uppercase font-bold",children:""}),n.jsx("p",{className:"text-[10px] font-bold text-gray-700 truncate",children:i.series||""})]}),i.seriesPart&&n.jsxs("div",{className:"bg-white px-2 py-1 rounded-lg border border-gray-200 text-[10px] font-black text-indigo-600",children:["#",i.seriesPart]})]})]})]}),n.jsxs("div",{className:"bg-gray-50 p-4 rounded-2xl border border-gray-100 space-y-2",children:[n.jsxs("div",{className:"flex justify-between items-center border-b border-gray-200 pb-2",children:[n.jsx("span",{className:"text-[10px] font-bold text-gray-400 uppercase",children:""}),n.jsx("span",{className:`text-xs font-bold ${i.status==="Completed"?"text-emerald-600":i.status==="Wishlist"?"text-pink-600":"text-indigo-600"}`,children:gi[i.status]})]}),(i.rating||0)>0&&n.jsxs("div",{className:"flex justify-between items-center border-b border-gray-200 pb-2",children:[n.jsx("span",{className:"text-[10px] font-bold text-gray-400 uppercase",children:""}),n.jsxs("span",{className:"text-xs font-black px-2 py-0.5 rounded bg-white border border-gray-100 shadow-sm",style:{color:Ap(i.rating||0)},children:[i.rating,"/10"]})]}),n.jsxs("div",{className:"flex justify-between items-center border-b border-gray-200 pb-2",children:[n.jsx("span",{className:"text-[10px] font-bold text-gray-400 uppercase",children:""}),n.jsx("span",{className:"text-xs font-bold text-gray-700",children:$r(i)||""})]}),n.jsxs("div",{className:"flex justify-between items-center border-b border-gray-200 pb-2",children:[n.jsx("span",{className:"text-[10px] font-bold text-gray-400 uppercase",children:""}),n.jsx("span",{className:"text-xs font-bold text-gray-700",children:new Date(i.addedAt).toLocaleDateString("uk-UA")})]}),n.jsxs("div",{className:"flex justify-between items-center pt-1",children:[n.jsx("span",{className:"text-[10px] font-bold text-gray-400 uppercase",children:""}),n.jsx("span",{className:"text-xs font-bold text-gray-700 text-right",children:i.formats.map(se=>Jn[se]).join(", ")})]})]}),i.status==="Completed"?n.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[n.jsxs("div",{className:"bg-emerald-50/50 p-3 rounded-2xl border border-emerald-100 flex flex-col items-center",children:[n.jsx($a,{size:16,className:"text-emerald-500 mb-1"}),n.jsx("span",{className:"text-[8px] font-bold text-emerald-400 uppercase text-center",children:""}),n.jsx("span",{className:"text-[10px] font-bold text-emerald-700",children:i.completedAt?new Date(i.completedAt).toLocaleDateString("uk-UA"):""})]}),n.jsxs("div",{className:"bg-indigo-50/50 p-3 rounded-2xl border border-indigo-100 flex flex-col items-center",children:[n.jsx(io,{size:16,className:"text-indigo-500 mb-1"}),n.jsx("span",{className:"text-[8px] font-bold text-indigo-400 uppercase",children:""}),n.jsxs("span",{className:"text-[10px] font-bold text-indigo-700",children:[Lp(i)," "]})]}),n.jsxs("div",{className:"bg-amber-50/50 p-3 rounded-2xl border border-amber-100 flex flex-col items-center",children:[n.jsx(bc,{size:16,className:"text-amber-500 mb-1"}),n.jsx("span",{className:"text-[8px] font-bold text-amber-400 uppercase",children:""}),n.jsxs("span",{className:"text-[10px] font-bold text-amber-700",children:[Cc(i)," /"]})]})]}):i.status==="Wishlist"?n.jsxs("div",{className:"bg-pink-50/50 p-4 rounded-3xl border border-pink-100 flex items-center gap-3",children:[n.jsx("div",{className:"p-2 bg-pink-100 rounded-full text-pink-500",children:n.jsx(Ia,{size:20})}),n.jsxs("div",{children:[n.jsx("p",{className:"text-[10px] font-bold text-pink-400 uppercase",children:"  "}),n.jsx("p",{className:"text-xs font-bold text-pink-700",children:new Date(i.addedAt).toLocaleDateString("uk-UA")})]})]}):n.jsxs("div",{className:"bg-gray-50 p-4 rounded-3xl border border-gray-100",children:[n.jsxs("div",{className:"flex justify-between items-center mb-2",children:[n.jsx("h4",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-widest",children:""}),n.jsxs("span",{className:"text-xs font-bold text-indigo-600",children:[Ho(i.pagesRead,$r(i)),"%"]})]}),n.jsx("div",{className:"w-full h-2 bg-gray-200 rounded-full overflow-hidden",children:n.jsx("div",{className:"h-full bg-indigo-600 transition-all duration-500",style:{width:`${Ho(i.pagesRead,$r(i))}%`}})})]}),(i.notes||i.comment)&&n.jsxs("div",{className:"space-y-3 pt-2",children:[i.notes&&n.jsxs("div",{className:"bg-gray-50 p-4 rounded-3xl border border-gray-100",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx(ip,{size:14,className:"text-gray-400"}),n.jsx("span",{className:"text-[10px] font-bold text-gray-400 uppercase",children:""})]}),n.jsx("div",{className:"text-2xl tracking-widest leading-relaxed text-gray-800",children:i.notes})]}),i.comment&&n.jsxs("div",{className:"bg-gray-50 p-4 rounded-3xl border border-gray-100",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx(sp,{size:14,className:"text-gray-400"}),n.jsx("span",{className:"text-[10px] font-bold text-gray-400 uppercase",children:""})]}),n.jsx("p",{className:"text-sm text-gray-700 whitespace-pre-wrap leading-relaxed",children:i.comment})]})]}),n.jsxs("div",{className:"flex gap-2 mt-4 pb-8",children:[n.jsxs("button",{onPointerDownCapture:()=>L("edit:pointerdown"),onTouchStartCapture:()=>L("edit:touchstart"),onClick:()=>J(x),onTouchEnd:()=>J(x),className:"flex-1 bg-gray-100 text-gray-800 py-4 rounded-2xl font-bold flex items-center justify-center gap-2 active:scale-95 transition-all touch-manipulation",children:[n.jsx(op,{size:18})," "]}),n.jsx("button",{onClick:V,className:"p-4 bg-red-50 text-red-500 rounded-2xl active:scale-95 transition-all",children:n.jsx(Va,{size:20})})]})]})})]})},gg=({label:i,active:p,onChange:f})=>n.jsxs("button",{type:"button",onClick:f,className:`flex items-center justify-between p-2 rounded-xl border transition-all ${p?"bg-indigo-600 text-white border-indigo-600":"bg-gray-50 text-gray-500 border-gray-100"}`,children:[n.jsx("span",{className:"text-[10px] font-bold",children:i}),n.jsx("div",{className:`w-3 h-3 rounded-full border-2 border-white ${p?"bg-white":"bg-transparent"}`})]}),xg=({book:i,onClose:p,onSave:f,uniquePublishers:x,uniqueGenres:C})=>{const[y,_]=j.useState(i),[E,S]=j.useState(!1),[L,R]=j.useState(!1),[J,V]=j.useState(!1),[se,he]=j.useState(!1),[fe,X]=j.useState(!1),Z=j.useRef(!1),te=j.useRef(0),oe=j.useRef(0),ce=j.useRef(null),ie=j.useCallback(v=>{_(w=>({...w,...v}))},[]),je=j.useCallback((v,w)=>v.replace(/[\u0000-\u0008\u000B\u000C\u000E-\u001F\u007F\u200B-\u200D\uFEFF]/g,"").slice(0,w),[]),de=j.useCallback(()=>{const v=document.activeElement;if(!v)return;const w=v.tagName;(w==="INPUT"||w==="TEXTAREA"||v.getAttribute("contenteditable")==="true")&&v.blur()},[]),[Pe,Be]=j.useState(y.coverUrl||null);j.useEffect(()=>{let v=null;return y.coverBlob&&!y.coverUrl?(v=URL.createObjectURL(y.coverBlob),Be(v)):Be(y.coverUrl||null),()=>{v&&URL.revokeObjectURL(v)}},[y.coverBlob,y.coverUrl]);const Ye=j.useMemo(()=>y.publisher?x.filter(v=>v.toLowerCase().includes((y.publisher||"").toLowerCase())):x,[x,y.publisher]),We=j.useMemo(()=>y.genre?C.filter(v=>v.toLowerCase().includes((y.genre||"").toLowerCase())):C,[C,y.genre]),Ge=async v=>{var N;const w=(N=v.target.files)==null?void 0:N[0];if(w&&y){S(!0);try{const re=await jc(w);ie({coverBlob:re,coverUrl:""})}catch(re){console.error(re),alert("  ")}finally{S(!1)}}},Te=async()=>{if(!y||!y.title){alert(" ,     .");return}R(!0);try{const v=await Qo(y.title,y.author||"");v?ie({coverUrl:v,coverBlob:void 0}):alert("  .")}catch(v){console.error(v),alert(" ")}finally{R(!1)}},et=v=>{const w=v.target.value;try{const N=w.replace(/[^\p{Extended_Pictographic}\s]/gu,"");ie({notes:N})}catch{ie({notes:w})}},lt=()=>{if(!(Z.current||fe))try{rr("info","bookEdit.save","save button tapped"),de(),Z.current=!0,X(!0),V(!1),he(!1),f({...y})}catch(v){console.error("BookEdit save click failed",v),rr("error","bookEdit.save","save handler failed",v),Z.current=!1,X(!1),alert("   ")}},it=()=>{rr("info","bookEdit.close","close button tapped"),de(),Z.current=!1,X(!1),p()},ae=j.useCallback(v=>{const w=Date.now();w-te.current<350||(te.current=w,v())},[]),G=j.useCallback(v=>{const w=Date.now();w-oe.current<250||(oe.current=w,v())},[]);j.useEffect(()=>{if(!fe)return;const v=window.setTimeout(()=>{rr("warn","bookEdit.save","save is still pending after 4s")},4e3);return()=>window.clearTimeout(v)},[fe]);const T=v=>{const w=Zn(v),N=y.seasons||[],re=N.includes(w)?N.filter(pe=>pe!==w):[...N,w];ie({seasons:re})};return n.jsxs("div",{className:"flex flex-col h-full bg-white sm:rounded-[2.5rem] overflow-hidden",children:[n.jsxs("div",{className:"sticky top-0 z-40 bg-white p-6 border-b border-gray-100 shadow-sm",children:[n.jsx("button",{onClick:()=>ae(it),onTouchEnd:()=>ae(it),className:"absolute top-4 right-4 p-2 bg-gray-50 hover:bg-gray-100 rounded-full text-gray-400 hover:text-gray-600 transition-colors z-50",children:n.jsx(Ur,{size:20})}),n.jsxs("div",{className:"flex gap-5",children:[n.jsxs("div",{onClick:()=>{var v;return(v=ce.current)==null?void 0:v.click()},className:"w-32 aspect-[2/3] bg-gray-50 rounded-2xl shadow-lg overflow-hidden border border-gray-100 flex-shrink-0 relative cursor-pointer group",children:[E?n.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gray-50",children:n.jsx(Xr,{className:"animate-spin text-indigo-600"})}):Pe?n.jsx("img",{src:Pe,className:"w-full h-full object-cover opacity-80"}):n.jsx("div",{className:"w-full h-full bg-gray-50"}),!E&&n.jsx("div",{className:"absolute inset-0 bg-black/20 flex items-center justify-center group-hover:bg-black/30 transition-colors",children:n.jsx(cp,{className:"text-white",size:24})}),n.jsx("button",{type:"button",onClick:v=>{v.stopPropagation(),Te()},disabled:L,className:"absolute top-2 right-2 bg-white/90 backdrop-blur-sm p-1.5 rounded-full text-indigo-600 shadow-sm border border-indigo-50 active:scale-95 transition-all disabled:opacity-50 z-20",children:L?n.jsx(Xr,{className:"animate-spin",size:14}):n.jsx(Wa,{size:14})}),n.jsx("input",{type:"file",ref:ce,className:"hidden",accept:"image/*",onChange:Ge})]}),n.jsxs("div",{className:"flex-1 min-w-0 flex flex-col justify-end pb-1",children:[n.jsx("div",{className:"mb-2",children:n.jsx("span",{className:`inline-block px-2.5 py-1 rounded-lg text-[10px] font-bold uppercase tracking-wider ${y.status==="Completed"?"bg-emerald-50 text-emerald-600":y.status==="Wishlist"?"bg-pink-50 text-pink-600":"bg-indigo-50 text-indigo-600"}`,children:gi[y.status]})}),n.jsxs("div",{className:"space-y-2",children:[n.jsx("input",{maxLength:180,className:"w-full text-lg font-bold bg-gray-50 border-none p-2 rounded-xl focus:ring-2 focus:ring-indigo-500 outline-none",value:y.title,onChange:v=>ie({title:je(v.target.value,180)}),placeholder:" "}),n.jsx("input",{maxLength:140,className:"w-full text-sm text-gray-500 bg-gray-50 border-none p-2 rounded-xl focus:ring-2 focus:ring-indigo-500 outline-none",value:y.author,onChange:v=>ie({author:je(v.target.value,140)}),placeholder:""})]})]})]})]}),n.jsx("div",{className:"px-6 py-6 overflow-y-auto no-scrollbar flex-1",children:n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"space-y-1",children:[n.jsx("label",{className:"text-[8px] font-bold text-gray-400 uppercase ml-1",children:"URL "}),n.jsxs("div",{className:"relative",children:[n.jsx(gc,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-300",size:12}),n.jsx("input",{maxLength:1024,placeholder:"https://...",className:"w-full bg-gray-50 pl-9 pr-3 py-2 rounded-2xl text-xs font-bold border-none outline-none",value:y.coverUrl||"",onChange:v=>ie({coverUrl:je(v.target.value,1024),coverBlob:void 0})})]})]}),n.jsxs("div",{className:"space-y-1 relative",children:[n.jsx("label",{className:"text-[8px] font-bold text-gray-400 uppercase ml-1",children:""}),n.jsx("input",{className:"w-full bg-gray-50 p-3 rounded-2xl text-xs font-bold border-none outline-none focus:ring-2 focus:ring-indigo-500",value:y.publisher||"",onChange:v=>{ie({publisher:je(v.target.value,120)}),V(!0)},onFocus:()=>V(!0),onBlur:()=>setTimeout(()=>V(!1),200),placeholder:""}),J&&Ye.length>0&&n.jsx("div",{className:"absolute top-full left-0 right-0 mt-1 bg-white border border-gray-100 rounded-xl shadow-xl z-50 max-h-32 overflow-y-auto",children:Ye.map((v,w)=>n.jsx("button",{type:"button",onTouchStart:N=>{N.preventDefault(),G(()=>{ie({publisher:v}),V(!1)})},onPointerDown:N=>{N.preventDefault(),G(()=>{ie({publisher:v}),V(!1)})},onClick:()=>G(()=>{ie({publisher:v}),V(!1)}),className:"w-full text-left px-4 py-2 text-[10px] font-bold text-gray-700 hover:bg-gray-50 border-b border-gray-50 last:border-none",children:v},w))})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsxs("div",{className:"space-y-1",children:[n.jsx("label",{className:"text-[8px] font-bold text-gray-400 uppercase ml-1",children:""}),n.jsx("input",{maxLength:120,className:"w-full bg-gray-50 p-3 rounded-2xl text-xs font-bold border-none outline-none",value:y.series||"",onChange:v=>ie({series:je(v.target.value,120)}),placeholder:".  "})]}),n.jsxs("div",{className:"space-y-1",children:[n.jsx("label",{className:"text-[8px] font-bold text-gray-400 uppercase ml-1",children:""}),n.jsx("input",{type:"text",maxLength:60,className:"w-full bg-gray-50 p-3 rounded-2xl text-xs font-bold border-none outline-none",value:y.seriesPart||"",onChange:v=>ie({seriesPart:je(v.target.value,60)}),placeholder:".  1 /  II"})]})]}),n.jsxs("div",{className:"space-y-1 relative",children:[n.jsx("label",{className:"text-[8px] font-bold text-gray-400 uppercase ml-1",children:""}),n.jsx("input",{className:"w-full bg-gray-50 p-3 rounded-2xl text-xs font-bold border-none outline-none",value:y.genre||"",maxLength:160,onChange:v=>{ie({genre:je(v.target.value,160)}),he(!0)},onFocus:()=>he(!0),onBlur:()=>setTimeout(()=>he(!1),200),placeholder:". "}),se&&We.length>0&&n.jsx("div",{className:"absolute top-full left-0 right-0 mt-1 bg-white border border-gray-100 rounded-xl shadow-xl z-50 max-h-32 overflow-y-auto",children:We.map((v,w)=>n.jsx("button",{type:"button",onTouchStart:N=>{N.preventDefault(),G(()=>{ie({genre:v}),he(!1)})},onPointerDown:N=>{N.preventDefault(),G(()=>{ie({genre:v}),he(!1)})},onClick:()=>G(()=>{ie({genre:v}),he(!1)}),className:"w-full text-left px-4 py-2 text-[10px] font-bold text-gray-700 hover:bg-gray-50 border-b border-gray-50 last:border-none",children:v},`${v}-${w}`))})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx("label",{className:"text-[8px] font-bold text-gray-400 uppercase ml-1",children:""}),n.jsx("div",{className:"grid grid-cols-2 gap-2",children:Sc.map(v=>{const w=(y.seasons||[]).includes(v);return n.jsxs("button",{type:"button",onClick:()=>T(v),className:`px-3 py-2 rounded-xl text-xs font-bold border transition-all flex items-center justify-between ${w?"border-transparent":"bg-gray-50 text-gray-500 border-gray-100"}`,children:[n.jsx("span",{className:`px-2 py-0.5 rounded-full ${uo(v)}`,children:v}),n.jsx("span",{className:`w-3 h-3 rounded-full border-2 ${w?"border-indigo-600 bg-indigo-600":"border-gray-300 bg-transparent"}`})]},v)})})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsxs("div",{className:"space-y-1",children:[n.jsx("label",{className:"text-[8px] font-bold text-gray-400 uppercase ml-1",children:" ."}),n.jsx("input",{inputMode:"numeric",pattern:"[0-9]*",type:"number",className:"w-full bg-gray-50 p-3 rounded-2xl text-xs font-bold border-none outline-none",value:y.pagesTotal||0,onChange:v=>ie({pagesTotal:parseInt(v.target.value)||0})})]}),n.jsxs("div",{className:"space-y-1",children:[n.jsx("label",{className:"text-[8px] font-bold text-gray-400 uppercase ml-1",children:""}),n.jsxs("select",{className:"w-full bg-gray-50 p-3 rounded-2xl text-xs font-bold border-none outline-none appearance-none",value:y.status,onChange:v=>ie({status:v.target.value}),children:[n.jsx("option",{value:"Unread",children:" "}),n.jsx("option",{value:"Reading",children:""}),n.jsx("option",{value:"Completed",children:""}),n.jsx("option",{value:"Wishlist",children:""})]})]})]}),n.jsxs("div",{className:"space-y-1",children:[n.jsx("label",{className:"text-[8px] font-bold text-gray-400 uppercase ml-1",children:" "}),n.jsx("input",{type:"date",className:"w-full bg-gray-50 p-3 rounded-2xl text-xs font-bold border-none outline-none",value:y.addedAt?y.addedAt.substring(0,10):"",onChange:v=>ie({addedAt:v.target.value?new Date(v.target.value).toISOString():new Date().toISOString()})})]}),y.status==="Completed"&&n.jsxs("div",{className:"grid grid-cols-2 gap-3 animate-in fade-in slide-in-from-top-1",children:[n.jsxs("div",{className:"space-y-1",children:[n.jsx("label",{className:"text-[8px] font-bold text-gray-400 uppercase ml-1",children:" "}),n.jsx("input",{type:"date",className:"w-full bg-gray-50 p-3 rounded-2xl text-xs font-bold border-none outline-none",value:y.completedAt?y.completedAt.substring(0,10):"",onChange:v=>ie({completedAt:v.target.value?new Date(v.target.value).toISOString():void 0})})]}),n.jsxs("div",{className:"space-y-1",children:[n.jsx("label",{className:"text-[8px] font-bold text-gray-400 uppercase ml-1",children:""}),n.jsxs("select",{className:"w-full bg-gray-50 p-3 rounded-2xl text-xs font-bold border-none outline-none appearance-none",value:y.rating||0,onChange:v=>ie({rating:parseInt(v.target.value)}),children:[n.jsx("option",{value:0,children:" "}),[10,9,8,7,6,5,4,3,2,1].map(v=>n.jsx("option",{value:v,children:v},v))]})]})]}),n.jsxs("div",{className:"space-y-1",children:[n.jsx("label",{className:"text-[8px] font-bold text-gray-400 uppercase ml-1",children:""}),n.jsx("input",{className:"w-full bg-gray-50 p-3 rounded-2xl text-xs font-medium border-none outline-none placeholder:text-gray-300",value:y.notes||"",onChange:et,placeholder:" "})]}),n.jsxs("div",{className:"space-y-1",children:[n.jsx("label",{className:"text-[8px] font-bold text-gray-400 uppercase ml-1",children:""}),n.jsx("textarea",{maxLength:2e3,className:"w-full bg-gray-50 p-3 rounded-2xl text-xs font-medium border-none outline-none resize-none h-24",value:y.comment||"",onChange:v=>ie({comment:je(v.target.value,2e3)}),placeholder:"  ..."})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx("label",{className:"text-[8px] font-bold text-gray-400 uppercase ml-1",children:""}),n.jsx("div",{className:"grid grid-cols-3 gap-2",children:Object.keys(Jn).map(v=>n.jsx(gg,{label:Jn[v],active:y.formats.includes(v),onChange:()=>{const w=y.formats||[],N=w.includes(v)?w.filter(re=>re!==v):[...w,v];N.length>0&&ie({formats:N})}},v))})]})]}),n.jsx("div",{className:"flex gap-2 mt-4 pb-8",children:n.jsxs("button",{type:"button",disabled:fe,onClick:()=>ae(lt),onTouchEnd:()=>ae(lt),className:"flex-1 bg-indigo-600 text-white py-4 rounded-2xl font-bold flex items-center justify-center gap-2 active:scale-95 transition-all shadow-lg disabled:opacity-70",children:[n.jsx(Ka,{size:18})," ",fe?"...":""]})})]})})]})},wi=({book:i,onClose:p,onOpenReadingMode:f})=>{const{updateBook:x,deleteBook:C,books:y,setFilterTag:_}=pn(),[E,S]=j.useState(!1),L=j.useMemo(()=>y.find(fe=>fe.id===i.id)||i,[y,i]),R=j.useMemo(()=>{const fe=new Set;return y.forEach(X=>{X.publisher&&X.publisher.trim()&&fe.add(X.publisher.trim())}),Array.from(fe).sort()},[y]),J=j.useMemo(()=>{const fe=new Set;return y.forEach(X=>{const Z=(X.genre||"").trim();Z&&fe.add(Z)}),Array.from(fe).sort((X,Z)=>X.localeCompare(Z,"uk"))},[y]);j.useEffect(()=>{const fe=navigator.userAgent||"";if(/iP(ad|hone|od)/.test(fe)||fe.includes("Mac")&&"ontouchend"in document)return;const Z=window.scrollY||window.pageYOffset||0,te={position:document.body.style.position,top:document.body.style.top,left:document.body.style.left,right:document.body.style.right,width:document.body.style.width,overflow:document.body.style.overflow};return document.body.style.position="fixed",document.body.style.top=`-${Z}px`,document.body.style.left="0",document.body.style.right="0",document.body.style.width="100%",document.body.style.overflow="hidden",()=>{document.body.style.position=te.position,document.body.style.top=te.top,document.body.style.left=te.left,document.body.style.right=te.right,document.body.style.width=te.width,document.body.style.overflow=te.overflow,window.scrollTo(0,Z)}},[]),j.useEffect(()=>{y.some(fe=>fe.id===i.id)||p()},[y,i.id,p]),j.useEffect(()=>{rr("info","bookDetails.mode",E?"editing":"view")},[E]);const V=fe=>{try{rr("info","bookDetails.save","onSave received from edit form",{bookId:fe.id});let X={...fe};if(X.status==="Completed"){X.completedAt||(X.completedAt=new Date().toISOString());const Z=$r(X);if((!X.pagesRead||X.pagesRead<Z)&&Z>0&&(X.pagesRead=Z),(!X.sessions||X.sessions.length===0)&&Z>0){const te=Math.round(Z*72),oe=X.completedAt.split("T")[0];X.sessions=[{id:fn(),date:oe,duration:te,pages:Z}]}}S(!1),requestAnimationFrame(()=>{try{x(X),rr("info","bookDetails.save","book saved and edit mode closed",{bookId:X.id})}catch(Z){rr("error","bookDetails.save","deferred save failed",Z),console.error("Deferred save failed in details view",Z)}})}catch(X){console.error("Book save failed in details view",X),rr("error","bookDetails.save","save failed in details view",X),alert("   .   .")}},se=()=>{x({...L,status:"Reading",readingStartedAt:new Date().toISOString()}),p()},he=fe=>{fe&&(_(fe),p())};return n.jsx("div",{className:"fixed inset-0 z-[60] flex items-end sm:items-center justify-center sm:p-4 bg-black/40 backdrop-blur-sm",children:n.jsx("div",{className:"w-full max-w-lg h-full sm:h-auto sm:max-h-[90vh] rounded-none sm:rounded-[2.5rem] shadow-2xl animate-in slide-in-from-bottom duration-300 bg-white overflow-hidden",children:E?n.jsx(xg,{book:L,onClose:()=>S(!1),onSave:V,uniquePublishers:R,uniqueGenres:J}):n.jsx(mg,{book:L,onClose:p,onOpenReadingMode:f,onEdit:()=>S(!0),onDelete:()=>{C(L.id),p()},onTagClick:he,onStartReadingWishlist:se})})})},ji=({book:i,onClose:p})=>{const{updateBook:f}=pn(),[x,C]=j.useState(i.sessions||[]),[y,_]=j.useState(()=>{const N=localStorage.getItem(`libra_session_${i.id}`);if(N)try{const re=JSON.parse(N);let pe=re.accumulatedTime;return!re.isPaused&&re.startTime&&(pe+=Math.floor((Date.now()-re.startTime)/1e3)),{...re,displaySeconds:pe}}catch(re){console.error("Failed to restore session",re)}return{isActive:!1,isPaused:!1,startPage:i.pagesRead||0,startTime:null,accumulatedTime:0,displaySeconds:0}}),[E,S]=j.useState(null),[L,R]=j.useState(""),[J,V]=j.useState(null),[se,he]=j.useState(!1),[fe,X]=j.useState(10),[Z,te]=j.useState("none"),[oe,ce]=j.useState(null),[ie,je]=j.useState(i.pagesTotal||0);j.useEffect(()=>{C(i.sessions||[])},[i.id,i.sessions]),j.useEffect(()=>(document.body.style.overflow="hidden",()=>{document.body.style.overflow=""}),[]),j.useEffect(()=>{if(y.isActive){const{displaySeconds:N,...re}=y;localStorage.setItem(`libra_session_${i.id}`,JSON.stringify(re))}else localStorage.removeItem(`libra_session_${i.id}`)},[y,i.id]),j.useEffect(()=>{i.formats.length>1&&!i.selectedReadingFormat&&i.status!=="Completed"&&te("select-format")},[i.formats,i.selectedReadingFormat,i.status]),j.useEffect(()=>{let N;return y.isActive&&!y.isPaused&&y.startTime&&(N=setInterval(()=>{_(re=>{if(!re.startTime)return re;const pe=Date.now(),be=Math.floor((pe-re.startTime)/1e3);return{...re,displaySeconds:re.accumulatedTime+be}})},500)),()=>clearInterval(N)},[y.isActive,y.isPaused,y.startTime]),j.useEffect(()=>{const N=()=>{if(document.visibilityState==="visible"&&y.isActive&&!y.isPaused&&y.startTime){const re=Date.now(),pe=Math.floor((re-y.startTime)/1e3);_(be=>({...be,displaySeconds:be.accumulatedTime+pe}))}};return document.addEventListener("visibilitychange",N),()=>document.removeEventListener("visibilitychange",N)},[y.isActive,y.isPaused,y.startTime,y.accumulatedTime]);const de=N=>{ce(N),je(i.pagesTotal||0),te("confirm-pages")},Pe=()=>{oe&&ie>0&&f({...i,selectedReadingFormat:oe,readingPagesTotal:ie}),te("none")},Be=()=>{i.status!=="Completed"&&(R((i.pagesRead||0).toString()),S("start"))},Ye=()=>{y.isPaused?_(N=>({...N,isPaused:!1,startTime:Date.now()})):_(N=>{if(!N.startTime)return{...N,isPaused:!0};const re=Date.now(),pe=Math.floor((re-N.startTime)/1e3);return{...N,isPaused:!0,startTime:null,accumulatedTime:N.accumulatedTime+pe,displaySeconds:N.accumulatedTime+pe}})},We=()=>{R((i.pagesRead||y.startPage).toString()),S("stop"),_(N=>{if(N.isPaused)return N;if(!N.startTime)return{...N,isPaused:!0};const re=Date.now(),pe=Math.floor((re-N.startTime)/1e3);return{...N,isPaused:!0,startTime:null,accumulatedTime:N.accumulatedTime+pe,displaySeconds:N.accumulatedTime+pe}})},Ge=N=>{R(re=>re==="0"?N.toString():re+N.toString())},Te=()=>{R(N=>N.slice(0,-1)||"")},et=()=>{const N=parseInt(L)||0;E==="start"?(_({isActive:!0,isPaused:!1,startPage:N,startTime:Date.now(),accumulatedTime:0,displaySeconds:0}),S(null)):E==="stop"&&lt(N)},lt=N=>{const re=$r(i),pe=re>0&&N>=re,be=Math.max(0,N-y.startPage),Oe=new Date().toISOString().split("T")[0],Ke=y.accumulatedTime,qe={id:fn(),date:Oe,duration:Ke,pages:be};C(Se=>[...Se,qe]);let tt={...i,pagesRead:N,status:pe?"Completed":"Reading",sessions:[...i.sessions||[],qe]};pe&&(tt.completedAt=new Date().toISOString()),f(tt),localStorage.removeItem(`libra_session_${i.id}`),_({isActive:!1,isPaused:!1,startPage:0,startTime:null,accumulatedTime:0,displaySeconds:0}),S(null),pe&&he(!0)},it=(N,re,pe)=>{const be=x.map(Oe=>Oe.id===N?{...Oe,[re]:pe}:Oe);C(be),f({...i,sessions:be})},ae=(N,re)=>{if(N.stopPropagation(),!window.confirm("  ?"))return;const pe=x.find(tt=>tt.id===re),be=x.filter(tt=>tt.id!==re);C(be);let Oe=i.pagesRead||0;pe&&(Oe=Math.max(0,Oe-(pe.pages||0)));const Ke=$r(i),qe={...i,sessions:be,pagesRead:Oe};i.status==="Completed"&&Ke>0&&Oe<Ke&&(qe.status="Reading",qe.completedAt=void 0),f(qe)},G=()=>{f({...i,rating:fe}),he(!1)},T=({icon:N,label:re,value:pe,colorClass:be})=>n.jsxs("div",{className:"flex flex-col items-center justify-center bg-gray-50 rounded-xl p-1.5 flex-1 min-w-0",children:[n.jsxs("div",{className:"flex items-center gap-1 mb-0.5",children:[n.jsx(N,{size:10,className:"text-gray-400"}),n.jsx("span",{className:"text-[9px] text-gray-400 uppercase font-bold truncate",children:re})]}),n.jsx("span",{className:`text-xs font-black truncate ${be}`,children:pe})]}),v=N=>{switch(N){case"Paper":return n.jsx(Sr,{size:24});case"E-book":return n.jsx(bi,{size:24});case"Audio":return n.jsx(yi,{size:24});case"Pirate":return n.jsx(ec,{size:24});default:return n.jsx(Sr,{size:24})}},w=$r(i);return n.jsxs("div",{className:"fixed inset-0 z-[100] bg-[#323238] flex flex-col animate-in fade-in duration-300",children:[n.jsxs("div",{className:"flex-none flex flex-col items-center px-4 pt-4 pb-2 w-full h-[55%] min-h-[300px]",children:[n.jsx("div",{className:"w-full flex justify-end items-center mb-2",children:n.jsx("button",{onClick:p,className:"p-2 bg-white/10 rounded-full text-white hover:bg-white/20 transition-colors",children:n.jsx(Ur,{size:20})})}),n.jsx("div",{className:"flex flex-col items-center justify-center flex-1 w-full gap-3",children:n.jsxs("div",{className:"flex items-center gap-6 w-full max-w-sm justify-center",children:[n.jsxs("div",{className:"w-20 h-28 rounded-lg overflow-hidden shadow-2xl relative flex-shrink-0 border border-white/10",children:[n.jsx(Or,{book:i,className:"w-full h-full",iconSize:32}),i.selectedReadingFormat&&n.jsx("div",{className:"absolute top-1 right-1 bg-black/60 backdrop-blur rounded p-1 text-white",children:v(i.selectedReadingFormat)})]}),n.jsxs("div",{className:"flex flex-col justify-center",children:[n.jsxs("div",{className:"text-4xl font-bold text-white leading-none mb-2",children:[Ho(i.pagesRead,w),"%"]}),n.jsx("p",{className:"text-xs font-medium text-gray-400 mb-3 max-w-[140px] leading-tight",children:fg(i)}),n.jsx("div",{className:"w-32 h-1.5 bg-gray-600 rounded-full overflow-hidden",children:n.jsx("div",{className:"h-full bg-indigo-500 rounded-full transition-all duration-300",style:{width:`${Ho(i.pagesRead,w)}%`}})})]})]})}),n.jsx("div",{className:"w-full flex justify-center pb-4",children:y.isActive?n.jsxs("div",{className:"flex items-center gap-4 bg-black/30 p-2 rounded-[2.5rem] backdrop-blur-md border border-white/5",children:[n.jsx("button",{onClick:Ye,className:"w-14 h-14 rounded-full bg-amber-400 flex items-center justify-center text-white shadow-lg active:scale-95 transition-all",children:y.isPaused?n.jsx(ap,{size:20,fill:"currentColor"}):n.jsx(lm,{size:20,fill:"currentColor"})}),n.jsx("div",{className:"text-white font-mono text-2xl font-bold w-24 text-center tracking-wider",children:dg(y.displaySeconds)}),n.jsx("button",{onClick:We,className:"w-14 h-14 rounded-full bg-red-600 flex items-center justify-center text-white shadow-lg active:scale-95 transition-all",children:n.jsx(pm,{size:18,fill:"currentColor"})})]}):n.jsx("button",{onClick:Be,disabled:i.status==="Completed",className:`w-20 h-20 rounded-full border-[4px] border-white/10 flex items-center justify-center shadow-xl active:scale-95 transition-all ${i.status==="Completed"?"bg-gray-500 opacity-50 cursor-not-allowed":"bg-red-600 hover:bg-red-500"}`,children:i.status==="Completed"?n.jsx(ci,{size:28,className:"text-white"}):n.jsx("div",{className:"w-6 h-6 bg-white rounded-full"})})})]}),n.jsxs("div",{className:"flex-1 bg-white rounded-t-[2rem] shadow-[0_-8px_30px_rgba(0,0,0,0.5)] overflow-hidden flex flex-col w-full",children:[n.jsx("div",{className:"px-6 py-4 border-b border-gray-100 flex-shrink-0 bg-white z-10",children:n.jsxs("h3",{className:"text-lg font-bold text-gray-800 flex items-center gap-2",children:[n.jsx(Sr,{size:18,className:"text-indigo-600"})," "]})}),n.jsx("div",{className:"flex-1 overflow-y-auto no-scrollbar p-4 space-y-2.5",children:x.length>0?[...x].reverse().map(N=>{const re=N.duration>0?Math.round(N.pages/(N.duration/3600)):0,pe=J===N.id;return n.jsxs("div",{className:"bg-white border border-gray-100 rounded-2xl p-2 shadow-sm flex items-stretch gap-2",children:[n.jsxs("div",{className:"flex-1 grid grid-cols-4 gap-2",children:[n.jsxs("div",{className:"flex flex-col items-center justify-center bg-gray-50 rounded-xl p-1.5 min-w-0",children:[n.jsxs("div",{className:"flex items-center gap-1 mb-0.5",children:[n.jsx($a,{size:10,className:"text-gray-400"}),n.jsx("span",{className:"text-[9px] text-gray-400 uppercase font-bold truncate",children:""})]}),pe?n.jsx("input",{type:"date",className:"w-full bg-white text-[10px] rounded border border-gray-200 p-0.5",value:N.date,onChange:be=>it(N.id,"date",be.target.value)}):n.jsx("span",{className:"text-xs font-bold text-gray-700 truncate",children:new Date(N.date).toLocaleDateString("uk-UA",{day:"2-digit",month:"2-digit"})})]}),n.jsxs("div",{className:"flex flex-col items-center justify-center bg-gray-50 rounded-xl p-1.5 min-w-0",children:[n.jsxs("div",{className:"flex items-center gap-1 mb-0.5",children:[n.jsx(ec,{size:10,className:"text-gray-400"}),n.jsx("span",{className:"text-[9px] text-gray-400 uppercase font-bold truncate",children:""})]}),pe?n.jsx("input",{inputMode:"numeric",pattern:"[0-9]*",type:"number",className:"w-full text-center bg-white text-xs rounded border border-gray-200 p-0.5",value:N.pages,onChange:be=>it(N.id,"pages",parseInt(be.target.value)||0)}):n.jsx("span",{className:"text-xs font-black text-indigo-600",children:N.pages})]}),n.jsxs("div",{className:"flex flex-col items-center justify-center bg-gray-50 rounded-xl p-1.5 min-w-0",children:[n.jsxs("div",{className:"flex items-center gap-1 mb-0.5",children:[n.jsx(io,{size:10,className:"text-gray-400"}),n.jsx("span",{className:"text-[9px] text-gray-400 uppercase font-bold truncate",children:""})]}),pe?n.jsx("input",{inputMode:"numeric",pattern:"[0-9]*",type:"number",className:"w-full text-center bg-white text-xs rounded border border-gray-200 p-0.5",value:Math.round(N.duration/60),onChange:be=>it(N.id,"duration",(parseInt(be.target.value)||0)*60)}):n.jsx("span",{className:"text-xs font-black text-gray-700",children:Math.round(N.duration/60)})]}),n.jsx(T,{icon:bc,label:"",value:`${re}`,colorClass:"text-amber-500"})]}),n.jsxs("div",{className:"flex flex-col gap-1 w-8 flex-shrink-0",children:[n.jsx("button",{onClick:be=>{be.stopPropagation(),V(pe?null:N.id)},className:`flex-1 flex items-center justify-center rounded-lg transition-colors ${pe?"bg-indigo-600 text-white shadow-md":"bg-gray-50 text-gray-400 hover:text-indigo-600"}`,children:pe?n.jsx(Ka,{size:14}):n.jsx(op,{size:14})}),n.jsx("button",{onClick:be=>ae(be,N.id),className:"flex-1 flex items-center justify-center bg-red-50 text-red-400 hover:text-red-600 hover:bg-red-100 rounded-lg transition-colors",children:n.jsx(Va,{size:14})})]})]},N.id)}):n.jsxs("div",{className:"flex flex-col items-center justify-center py-10 text-gray-300 gap-2",children:[n.jsx(io,{size:32,opacity:.2}),n.jsx("p",{className:"text-xs font-medium",children:"  "})]})})]}),Z==="select-format"&&n.jsx("div",{className:"fixed inset-0 z-[120] flex items-center justify-center p-6 bg-black/80 backdrop-blur-md",children:n.jsxs("div",{className:"bg-white w-full max-w-sm rounded-[2.5rem] p-8 shadow-2xl animate-in zoom-in-95 duration-300",children:[n.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-2 text-center",children:" "}),n.jsx("p",{className:"text-gray-500 text-sm mb-6 text-center",children:",         ."}),n.jsx("div",{className:"space-y-3",children:i.formats.map(N=>n.jsxs("button",{onClick:()=>de(N),className:"w-full p-4 bg-gray-50 hover:bg-indigo-50 active:bg-indigo-100 rounded-2xl flex items-center gap-4 transition-all border border-gray-100 hover:border-indigo-200",children:[n.jsx("div",{className:"p-2.5 bg-white rounded-xl text-indigo-600 shadow-sm",children:v(N)}),n.jsx("span",{className:"font-bold text-gray-700",children:Jn[N]})]},N))})]})}),Z==="confirm-pages"&&n.jsx("div",{className:"fixed inset-0 z-[120] flex items-center justify-center p-6 bg-black/80 backdrop-blur-md",children:n.jsxs("div",{className:"bg-white w-full max-w-sm rounded-[2.5rem] p-8 shadow-2xl animate-in zoom-in-95 duration-300",children:[n.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-2 text-center",children:" "}),n.jsxs("p",{className:"text-gray-500 text-sm mb-6 text-center",children:["    ",n.jsx("span",{className:"text-indigo-600 font-bold",children:oe&&Jn[oe]}),"?"]}),n.jsxs("div",{className:"mb-6",children:[n.jsx("input",{inputMode:"numeric",pattern:"[0-9]*",type:"number",className:"w-full text-center text-4xl font-black text-gray-800 bg-gray-50 border-2 border-gray-100 rounded-2xl py-4 focus:ring-4 focus:ring-indigo-100 focus:border-indigo-500 outline-none transition-all",value:ie,onChange:N=>je(parseInt(N.target.value)||0)}),n.jsxs("p",{className:"text-center text-xs text-gray-400 mt-2",children:[" : ",i.pagesTotal]})]}),n.jsx("button",{onClick:Pe,className:"w-full bg-indigo-600 text-white py-4 rounded-2xl font-bold text-lg shadow-xl shadow-indigo-200 active:scale-95 transition-all",children:""})]})}),E&&n.jsx("div",{className:"fixed inset-0 z-[110] flex items-end sm:items-center justify-center bg-black/60 backdrop-blur-sm p-4",children:n.jsxs("div",{className:"bg-white w-full max-w-sm rounded-[2rem] p-6 shadow-2xl animate-in slide-in-from-bottom duration-300",children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800 text-center mb-6",children:E==="start"?"   ?":"   ?"}),n.jsx("div",{className:"flex justify-center mb-6",children:n.jsxs("div",{className:"text-5xl font-black text-gray-800 flex items-center tracking-tight",children:[L||"0",n.jsx("span",{className:"animate-pulse text-indigo-500 ml-1",children:"|"})]})}),n.jsxs("div",{className:"grid grid-cols-3 gap-3 mb-4",children:[[1,2,3,4,5,6,7,8,9].map(N=>n.jsx("button",{onClick:()=>Ge(N),className:"h-14 rounded-2xl text-xl font-bold text-gray-800 bg-gray-50 hover:bg-gray-100 active:bg-gray-200 transition-colors shadow-sm",children:N},N)),n.jsx("div",{}),n.jsx("button",{onClick:()=>Ge(0),className:"h-14 rounded-2xl text-xl font-bold text-gray-800 bg-gray-50 hover:bg-gray-100 active:bg-gray-200 transition-colors shadow-sm",children:"0"}),n.jsx("button",{onClick:Te,className:"h-14 rounded-2xl flex items-center justify-center text-gray-800 bg-gray-50 hover:bg-gray-100 active:bg-gray-200 transition-colors shadow-sm",children:n.jsx(tm,{size:20})})]}),n.jsxs("div",{className:"flex gap-3",children:[n.jsx("button",{onClick:()=>S(null),className:"flex-1 py-4 bg-gray-100 rounded-2xl font-bold text-gray-600 active:scale-95 transition-all",children:""}),n.jsx("button",{onClick:et,className:"flex-[2] py-4 bg-black text-white rounded-2xl font-bold shadow-lg active:scale-95 transition-all",children:"OK"})]})]})}),se&&n.jsx("div",{className:"fixed inset-0 z-[120] flex items-center justify-center p-6 bg-slate-900/90 backdrop-blur-xl",children:n.jsxs("div",{className:"bg-white w-full max-w-sm rounded-[3rem] p-8 shadow-2xl flex flex-col items-center",children:[n.jsx(vc,{size:48,className:"text-emerald-500 mb-4"}),n.jsx("h3",{className:"text-2xl font-bold mb-2",children:"!"}),n.jsx("p",{className:"text-gray-500 text-sm mb-8 text-center",children:" .   ?"}),n.jsx("div",{className:"grid grid-cols-5 gap-2 mb-10",children:[1,2,3,4,5,6,7,8,9,10].map(N=>n.jsx("button",{onClick:()=>X(N),className:`w-12 h-12 rounded-2xl text-sm font-bold transition-all ${fe===N?"bg-indigo-600 text-white shadow-lg":"bg-gray-50 text-gray-400"}`,children:N},N))}),n.jsx("button",{onClick:G,className:"w-full bg-indigo-600 text-white py-5 rounded-[2rem] font-bold shadow-xl active:scale-95",children:""})]})})]})},_c=(i,p=20,f=[])=>{const[x,C]=j.useState(p),y=j.useRef(null);j.useEffect(()=>{C(p)},[p,...f]);const _=j.useMemo(()=>i.slice(0,x),[i,x]),E=x<i.length;return j.useEffect(()=>{const S=new IntersectionObserver(L=>{L[0].isIntersecting&&E&&C(R=>Math.min(R+p,i.length))},{threshold:.1,rootMargin:"300px"});return y.current&&S.observe(y.current),()=>S.disconnect()},[E,i.length,p,...f]),{visibleItems:_,observerTarget:y,hasMore:E}},$f=()=>{const{books:i}=pn(),[p,f]=j.useState(new Date),[x,C]=j.useState("month"),[y,_]=j.useState(null),[E,S]=j.useState(!1),[L,R]=j.useState(null),[J,V]=j.useState(null),[se,he]=j.useState(null),fe=50,X=T=>{he(null),V(T.targetTouches[0].clientX)},Z=T=>{he(T.targetTouches[0].clientX)},te=()=>{if(!J||!se)return;const T=J-se,v=T>fe,w=T<-fe;v&&We(),w&&Ye()},oe=new Date(p.getFullYear(),p.getMonth()+1,0).getDate(),ie=(new Date(p.getFullYear(),p.getMonth(),1).getDay()+6)%7,je=p.toLocaleString("uk-UA",{month:"long"}),de=p.getFullYear(),Pe=(T,v,w)=>{var be;const N=`${v}-${String(w+1).padStart(2,"0")}`,re=(be=T.sessions)==null?void 0:be.some(Oe=>Oe.date.startsWith(N)),pe=T.completedAt&&T.completedAt.startsWith(N);return re||pe},Be=j.useMemo(()=>{const T={},v=`${de}-${String(p.getMonth()+1).padStart(2,"0")}`;return i.forEach(w=>{var N;(N=w.sessions)==null||N.forEach(re=>{re.date.startsWith(v)&&(T[re.date]||(T[re.date]=[]),T[re.date].some(pe=>pe.id===w.id)||T[re.date].push(w))})}),T},[i,p,de]),Ye=()=>{R(null),f(x==="month"?new Date(de,p.getMonth()-1,1):new Date(de-1,p.getMonth(),1))},We=()=>{R(null),f(x==="month"?new Date(de,p.getMonth()+1,1):new Date(de+1,p.getMonth(),1))},Ge=T=>{f(new Date(de,T,1)),C("month"),R(null)},Te=j.useMemo(()=>{const T=L?`${de}-${String(p.getMonth()+1).padStart(2,"0")}-${String(L).padStart(2,"0")}`:null;let v=0,w=0,N=new Set,re=[];if(x==="month"&&!T){const pe=`${de}-${String(p.getMonth()+1).padStart(2,"0")}`;i.forEach(be=>{var Ke;let Oe=!1;(Ke=be.sessions)==null||Ke.forEach(qe=>{qe.date.startsWith(pe)&&(v+=Number(qe.pages)||0,w+=Number(qe.duration)||0,Oe||(N.add(be.id),re.push(be),Oe=!0))})})}else if(x==="month"&&T)i.forEach(pe=>{var Oe;let be=!1;(Oe=pe.sessions)==null||Oe.forEach(Ke=>{Ke.date===T&&(v+=Number(Ke.pages)||0,w+=Number(Ke.duration)||0,be||(N.add(pe.id),re.push(pe),be=!0))})});else{const pe=`${de}-`;i.forEach(be=>{var Ke;let Oe=!1;(Ke=be.sessions)==null||Ke.forEach(qe=>{qe.date.startsWith(pe)&&(Oe||(N.add(be.id),re.push(be),Oe=!0))})})}return{count:N.size,pages:v,time:w,list:re}},[i,x,p,de,L]),{visibleItems:et,observerTarget:lt,hasMore:it}=_c(Te.list,10,[x,p.toISOString(),L]),ae=()=>{const T=Array.from({length:oe},(w,N)=>N+1),v=Array.from({length:ie},(w,N)=>null);return n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"grid grid-cols-7 gap-1 mb-2",children:["","","","","","",""].map(w=>n.jsx("div",{className:"text-center text-[10px] font-bold text-gray-400 uppercase",children:w},w))}),n.jsxs("div",{className:"grid grid-cols-7 gap-1",children:[v.map((w,N)=>n.jsx("div",{className:"aspect-square"},`p-${N}`)),T.map(w=>{const N=`${de}-${String(p.getMonth()+1).padStart(2,"0")}-${String(w).padStart(2,"0")}`,re=Be[N]||[],pe=L===w;return n.jsxs("div",{onClick:()=>R(pe?null:w),className:`aspect-square relative rounded-xl overflow-hidden border flex flex-col items-center justify-center transition-all cursor-pointer ${pe?"ring-2 ring-indigo-500 border-indigo-500 z-10 scale-105 shadow-md":re.length>0?"border-indigo-200 bg-white shadow-sm hover:border-indigo-300":"border-gray-50 bg-gray-50/50"}`,children:[n.jsx("span",{className:`text-[10px] absolute top-1 left-1 font-bold z-10 ${re.length>0?"text-indigo-700 bg-white/90 backdrop-blur-[1px] px-1 rounded-md shadow-sm":"text-gray-300"}`,children:w}),re.length>0&&n.jsxs("div",{className:"w-full h-full relative",children:[n.jsx(Or,{book:re[0],className:"w-full h-full",iconSize:12}),re.length>1&&n.jsxs("div",{className:"absolute bottom-0 right-0 bg-indigo-600 px-1 rounded-tl-lg text-[8px] font-bold text-white shadow-sm",children:["+",re.length-1]})]})]},w)})]})]})},G=()=>{const T=["","","","","","","","","","","",""];return n.jsx("div",{className:"grid grid-cols-3 gap-3",children:T.map((v,w)=>{const N=i.filter(pe=>Pe(pe,de,w)),re=new Date().getMonth()===w&&new Date().getFullYear()===de;return n.jsxs("button",{onClick:()=>Ge(w),className:`aspect-[4/5] bg-gray-50 rounded-2xl border flex flex-col items-center p-2 relative overflow-hidden transition-all hover:border-indigo-300 active:scale-95 ${re?"border-indigo-500 ring-1 ring-indigo-500 bg-indigo-50/30":"border-gray-100"}`,children:[n.jsx("span",{className:`text-[10px] font-bold uppercase mb-2 ${re?"text-indigo-700":"text-gray-500"}`,children:v}),N.length>0?n.jsx("div",{className:"grid grid-cols-2 gap-1 w-full flex-1 content-start",children:N.slice(0,4).map(pe=>n.jsx("div",{className:"aspect-[2/3] bg-white rounded-md overflow-hidden shadow-sm",children:n.jsx(Or,{book:pe,className:"w-full h-full",iconSize:12})},pe.id))}):n.jsx("div",{className:"flex-1 flex items-center justify-center",children:n.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-gray-200"})}),N.length>0&&n.jsx("div",{className:"absolute bottom-2 right-2 bg-white/90 backdrop-blur rounded-md px-1.5 py-0.5 text-[8px] font-black text-gray-800 shadow-sm border border-gray-100",children:N.length})]},v)})})};return n.jsxs("div",{className:"p-4 space-y-6 pb-24 text-gray-800 animate-in fade-in",children:[n.jsxs("header",{className:"flex justify-between items-center",children:[n.jsx("h1",{className:"text-3xl font-bold",children:""}),n.jsx("button",{onClick:()=>C(x==="month"?"year":"month"),className:"p-3 bg-white rounded-2xl border border-gray-100 text-gray-500 shadow-sm active:scale-95 transition-all",children:x==="month"?n.jsx(sm,{size:20}):n.jsx($a,{size:20})})]}),n.jsxs("div",{onTouchStart:X,onTouchMove:Z,onTouchEnd:te,className:"bg-white rounded-[2rem] p-6 shadow-sm border border-gray-100 transition-all duration-300 select-none",children:[n.jsxs("div",{className:"flex justify-between items-center mb-6",children:[n.jsx("button",{onClick:Ye,className:"p-3 hover:bg-gray-50 rounded-2xl transition-colors text-gray-600",children:n.jsx(ep,{size:20})}),n.jsxs("button",{onClick:()=>C(x==="month"?"year":"month"),className:"text-lg font-bold capitalize flex items-center gap-2 px-4 py-2 rounded-xl hover:bg-gray-50 transition-colors",children:[x==="month"&&n.jsx("span",{className:"text-gray-400 font-normal",children:de}),n.jsx("span",{className:"text-indigo-900",children:x==="month"?je:de})]}),n.jsx("button",{onClick:We,className:"p-3 hover:bg-gray-50 rounded-2xl transition-colors text-gray-600",children:n.jsx(Zu,{size:20})})]}),x==="month"?ae():G()]}),n.jsxs("div",{className:"bg-white p-6 rounded-[2rem] shadow-sm border border-gray-100 transition-all duration-300",children:[n.jsxs("div",{className:"flex justify-between items-end mb-4",children:[n.jsxs("div",{children:[n.jsx("h3",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-widest mb-1",children:" "}),n.jsx("p",{className:"text-xs font-medium text-gray-500 flex items-center gap-1",children:L?n.jsxs("span",{className:"text-indigo-600 font-bold",children:[L," ",je]}):n.jsx("span",{children:x==="month"?` ${je.toLowerCase()}`:` ${de} `})})]}),n.jsxs("div",{className:"flex items-baseline gap-1",children:[n.jsx("span",{className:"text-4xl font-black text-indigo-600 tracking-tighter",children:Te.count}),n.jsx("span",{className:"text-xs font-bold text-gray-400 uppercase",children:""})]})]}),Te.pages>0&&n.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-4 animate-in fade-in slide-in-from-bottom-2",children:[n.jsxs("div",{className:"bg-emerald-50 p-3 rounded-2xl flex items-center gap-3",children:[n.jsx("div",{className:"p-2 bg-emerald-100 text-emerald-600 rounded-full",children:n.jsx(ec,{size:16})}),n.jsxs("div",{children:[n.jsx("p",{className:"text-[10px] font-bold text-emerald-400 uppercase",children:""}),n.jsxs("p",{className:"text-lg font-black text-emerald-700 leading-none",children:[Te.pages," ",n.jsx("span",{className:"text-[10px] font-medium opacity-70",children:"."})]})]})]}),n.jsxs("div",{className:"bg-amber-50 p-3 rounded-2xl flex items-center gap-3",children:[n.jsx("div",{className:"p-2 bg-amber-100 text-amber-600 rounded-full",children:n.jsx(io,{size:16})}),n.jsxs("div",{children:[n.jsx("p",{className:"text-[10px] font-bold text-amber-400 uppercase",children:""}),n.jsxs("p",{className:"text-lg font-black text-amber-700 leading-none",children:[Te.time>0?Math.round(Te.time/60):0," ",n.jsx("span",{className:"text-[10px] font-medium opacity-70",children:"."})]})]})]})]}),n.jsx("div",{className:"space-y-3",children:Te.list.length===0?n.jsxs("div",{className:"text-center py-6 text-gray-300 flex flex-col items-center",children:[n.jsx(Sr,{size:32,className:"mb-2 opacity-20"}),n.jsx("p",{className:"text-xs italic",children:"    "})]}):n.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[et.map(T=>n.jsxs("div",{onClick:()=>_(T),className:"flex items-center gap-4 p-2.5 bg-gray-50 rounded-2xl group cursor-pointer active:scale-95 transition-all hover:bg-indigo-50 border border-transparent hover:border-indigo-100",children:[n.jsx("div",{className:"w-10 h-14 bg-white rounded-xl overflow-hidden flex-shrink-0 shadow-sm border border-gray-100 group-hover:scale-105 transition-transform",children:n.jsx(Or,{book:T,className:"w-full h-full",iconSize:16})}),n.jsxs("div",{className:"min-w-0 flex-1",children:[n.jsx("h4",{className:"font-bold text-xs text-gray-800 truncate",children:T.title}),n.jsx("p",{className:"text-[10px] text-gray-500 truncate",children:T.author})]}),(T.rating||0)>0&&n.jsx("div",{className:"px-2 py-1 bg-white rounded-lg shadow-sm text-[10px] font-black text-indigo-600 border border-gray-100",children:T.rating})]},T.id)),it&&n.jsx("div",{ref:lt,className:"flex justify-center py-2",children:n.jsx(Xr,{className:"animate-spin text-gray-300",size:16})})]})})]}),y&&!E&&n.jsx(wi,{book:y,onClose:()=>_(null),onOpenReadingMode:()=>S(!0)}),E&&y&&n.jsx(ji,{book:y,onClose:()=>S(!1)})]})};class yg extends j.Component{constructor(){super(...arguments),this.state={hasError:!1,error:null},this.handleReload=()=>{window.location.reload()},this.handleReset=()=>{if(window.confirm("!        .       . ?"))try{localStorage.clear();const p=indexedDB.deleteDatabase("LibraDB");p.onsuccess=()=>window.location.reload(),p.onerror=()=>{alert("    .       ."),window.location.reload()},p.onblocked=()=>{alert(" ,         .")}}catch(p){console.error("Reset failed",p),window.location.reload()}}}static getDerivedStateFromError(p){return{hasError:!0,error:p}}componentDidCatch(p,f){console.error("Uncaught error:",p,f)}render(){return this.state.hasError?n.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center p-6 bg-gray-50 text-center font-sans",children:[n.jsx("div",{className:"bg-red-50 p-6 rounded-full text-red-500 mb-6 shadow-sm border border-red-100 animate-bounce",children:n.jsx(dc,{size:48})}),n.jsx("h1",{className:"text-2xl font-bold text-gray-800 mb-2",children:",    "}),n.jsx("p",{className:"text-gray-500 mb-8 max-w-xs text-sm leading-relaxed",children:"  .     ( ).   ."}),n.jsxs("div",{className:"flex flex-col gap-3 w-full max-w-xs",children:[n.jsxs("button",{onClick:this.handleReload,className:"w-full py-4 bg-indigo-600 text-white rounded-2xl font-bold flex items-center justify-center gap-2 active:scale-95 transition-transform shadow-lg shadow-indigo-200",children:[n.jsx(um,{size:20}),"  "]}),n.jsxs("button",{onClick:this.handleReset,className:"w-full py-4 bg-white border border-gray-200 text-gray-500 hover:text-red-500 hover:border-red-200 rounded-2xl font-bold flex items-center justify-center gap-2 active:scale-95 transition-all",children:[n.jsx(Va,{size:20}),"  "]})]}),this.state.error&&n.jsx("div",{className:"mt-8 p-4 bg-gray-100 rounded-xl text-left w-full max-w-sm overflow-auto border border-gray-200",children:n.jsx("p",{className:"text-[10px] font-mono text-gray-500 break-all",children:this.state.error.toString()})})]}):this.props.children}}const vg=({onAdd:i,onCancel:p})=>{const f=j.useRef(null),x=j.useRef(null),[C,y]=j.useState(!1),[_,E]=j.useState(!1),[S,L]=j.useState({title:"",author:"",coverUrl:"",coverBlob:void 0}),R=j.useCallback(X=>{L(Z=>({...Z,...X}))},[]),J=j.useCallback((X,Z)=>X.replace(/[\u0000-\u0008\u000B\u000C\u000E-\u001F\u007F\u200B-\u200D\uFEFF]/g,"").slice(0,Z),[]),V=j.useCallback(()=>{x.current&&(URL.revokeObjectURL(x.current),x.current=null)},[]);j.useEffect(()=>()=>V(),[V]);const se=async X=>{var te;const Z=(te=X.target.files)==null?void 0:te[0];if(Z){y(!0);try{const oe=await jc(Z),ce=URL.createObjectURL(oe);V(),x.current=ce,R({coverBlob:oe,coverUrl:ce})}catch(oe){console.error("Image processing failed",oe),alert("   ")}finally{y(!1)}}},he=async()=>{if(!S.title){alert(" ,    .");return}E(!0);try{const X=await Qo(S.title,S.author||"");X?(V(),R({coverUrl:X,coverBlob:void 0})):alert("  .")}catch(X){console.error(X),alert(" ")}finally{E(!1)}},fe=X=>{if(X.preventDefault(),!S.title||!S.author){alert("    '");return}try{const Z={id:fn(),title:S.title,author:S.author,genre:"",publisher:"",seriesPart:"",pagesTotal:0,pagesRead:0,isbn:"",formats:["Paper"],status:"Wishlist",addedAt:new Date().toISOString(),coverUrl:S.coverUrl||"",coverBlob:S.coverBlob,sessions:[]};i(Z),V()}catch(Z){console.error("Add wishlist submit failed",Z),alert("   ")}};return n.jsx("div",{className:"h-[100dvh] overflow-y-auto overscroll-contain space-y-6 pb-24 text-gray-800 animate-in slide-in-from-right duration-300",children:n.jsxs("div",{className:"space-y-4",children:[n.jsxs("button",{onClick:p,className:"flex items-center gap-2 text-gray-400 hover:text-gray-600 transition-colors",children:[n.jsx(Ua,{size:20})," ",n.jsx("span",{className:"text-sm font-bold",children:""})]}),n.jsxs("form",{onSubmit:fe,className:"bg-white p-6 rounded-3xl shadow-sm space-y-5 border border-gray-100",children:[n.jsxs("div",{className:"flex justify-center mb-2 relative",children:[n.jsx("button",{type:"button",onClick:()=>{var X;return(X=f.current)==null?void 0:X.click()},disabled:C,className:"relative w-28 aspect-[2/3] bg-gray-50 rounded-2xl border-2 border-dashed border-gray-200 flex flex-col items-center justify-center overflow-hidden hover:bg-gray-100 transition-colors disabled:opacity-50",children:C?n.jsx(Xr,{className:"animate-spin text-indigo-600"}):S.coverUrl?n.jsx("img",{src:S.coverUrl,className:"w-full h-full object-cover"}):n.jsxs(n.Fragment,{children:[n.jsx(vi,{className:"text-gray-300 mb-2",size:28}),n.jsx("span",{className:"text-[9px] font-bold text-gray-400 uppercase",children:""})]})}),n.jsx("input",{type:"file",ref:f,className:"hidden",accept:"image/*",onChange:se}),n.jsx("button",{type:"button",onClick:he,disabled:_,className:"absolute top-0 right-16 translate-x-full bg-white p-3 rounded-2xl text-indigo-600 shadow-lg border border-indigo-50 active:scale-95 transition-all disabled:opacity-50",title:" ",children:_?n.jsx(Xr,{className:"animate-spin",size:20}):n.jsx(Wa,{size:20})})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"space-y-1",children:[n.jsx("label",{className:"text-[10px] font-bold text-gray-400 uppercase ml-1",children:""}),n.jsx("input",{required:!0,maxLength:180,placeholder:" ",className:"w-full bg-gray-50 p-3 rounded-2xl outline-none focus:ring-1 focus:ring-indigo-500 border-none transition-all text-sm font-bold",value:S.title,onChange:X=>R({title:J(X.target.value,180)})})]}),n.jsxs("div",{className:"space-y-1",children:[n.jsx("label",{className:"text-[10px] font-bold text-gray-400 uppercase ml-1",children:""}),n.jsx("input",{required:!0,maxLength:140,placeholder:"' ",className:"w-full bg-gray-50 p-3 rounded-2xl outline-none focus:ring-1 focus:ring-indigo-500 border-none transition-all text-sm font-bold",value:S.author,onChange:X=>R({author:J(X.target.value,140)})})]}),n.jsxs("div",{className:"space-y-1",children:[n.jsx("label",{className:"text-[10px] font-bold text-gray-400 uppercase ml-1",children:"URL "}),n.jsxs("div",{className:"relative",children:[n.jsx(gc,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-300",size:14}),n.jsx("input",{placeholder:"https://example.com/image.jpg",className:"w-full bg-gray-50 pl-9 pr-3 py-3 rounded-2xl text-xs font-bold border-none outline-none",maxLength:1024,value:S.coverUrl||"",onChange:X=>{V(),R({coverUrl:J(X.target.value,1024),coverBlob:void 0})}})]})]}),n.jsxs("button",{type:"submit",className:"w-full bg-indigo-600 text-white py-4 rounded-2xl font-bold shadow-lg shadow-indigo-100 mt-2 active:scale-95 transition-all flex items-center justify-center gap-2",children:[n.jsx(Ka,{size:18}),"  "]})]})]})]})})},zp=(i,p=[],f=[])=>{const[x,C]=j.useState(""),[y,_]=j.useState(""),[E,S]=j.useState(""),[L,R]=j.useState(p),[J,V]=j.useState(f);return{filteredBooks:j.useMemo(()=>i.filter(Z=>{var te,oe,ce,ie;if(L.length>0&&!L.includes(Z.status)||J.length>0&&!Z.formats.some(je=>J.includes(je)))return!1;if(x){const je=x.toLowerCase();if(!(Z.title.toLowerCase().includes(je)||Z.author.toLowerCase().includes(je)||((te=Z.publisher)==null?void 0:te.toLowerCase().includes(je))||((oe=Z.genre)==null?void 0:oe.toLowerCase().includes(je))||((ce=Z.series)==null?void 0:ce.toLowerCase().includes(je))||((ie=Z.seriesPart)==null?void 0:ie.toLowerCase().includes(je))))return!1}if(y.trim()){const je=y.toLowerCase().trim();if(!(Z.publisher||"").toLowerCase().includes(je))return!1}if(E.trim()){const je=E.toLowerCase().trim();if(!(Z.genre||"").toLowerCase().includes(je))return!1}return!0}),[i,x,L,J,y,E]),search:x,setSearch:C,publisherFilter:y,setPublisherFilter:_,genreFilter:E,setGenreFilter:S,selectedStatuses:L,setSelectedStatuses:R,selectedFormats:J,setSelectedFormats:V,toggleStatusFilter:Z=>{R(te=>te.includes(Z)?te.filter(oe=>oe!==Z):[...te,Z])},toggleFormatFilter:Z=>{V(te=>te.includes(Z)?te.filter(oe=>oe!==Z):[...te,Z])},clearFilters:()=>{C(""),_(""),S(""),R(p),V(f)}}},Ip=(i,p,f)=>{const x=(_,E)=>(_||"").trim().toLowerCase().localeCompare((E||"").trim().toLowerCase(),"uk"),C=(_,E)=>{const S=Number((_||"").replace(",",".")),L=Number((E||"").replace(",",".")),R=Number.isFinite(S),J=Number.isFinite(L);return R&&J?S-L:R?-1:J?1:x(_,E)};return{sortedBooks:j.useMemo(()=>p==="custom"?i:[...i].sort((_,E)=>{let S=0;switch(p){case"title":S=x(_.title,E.title);break;case"author":S=x(_.author,E.author);break;case"addedAt":S=new Date(_.addedAt).getTime()-new Date(E.addedAt).getTime();break;case"genre":const L=!!(_.genre||"").trim(),R=!!(E.genre||"").trim();if(L!==R)return L?-1:1;S=x(_.genre,E.genre)||x(_.author,E.author)||x(_.series,E.series)||C(_.seriesPart,E.seriesPart)||x(_.title,E.title);break}return f==="asc"?S:-S}),[i,p,f])}},Bp=({itemId:i,children:p,showHandle:f,performanceMode:x=!1,isDragging:C=!1,onHandlePointerDown:y,setItemRef:_})=>n.jsxs("div",{ref:E=>_==null?void 0:_(i,E),className:`relative mb-3 ${x?"will-change-transform":""}`,style:{touchAction:"pan-y",willChange:"transform"},children:[n.jsx("div",{className:`w-full relative z-0 ${C?"opacity-60 grayscale":""}`,children:p}),f&&n.jsx("div",{onPointerDown:E=>y==null?void 0:y(E,i),className:`absolute right-4 top-1/2 -translate-y-1/2 z-20 p-3 rounded-xl text-gray-400 border border-gray-100 cursor-grab active:cursor-grabbing touch-none ${x?"bg-white text-gray-500":"bg-white/80 backdrop-blur-sm shadow-sm active:text-indigo-600 active:scale-110 transition-all"}`,style:{touchAction:"none"},children:n.jsx(om,{size:20})})]}),bg=({search:i,onSearchChange:p,suggestions:f,onAddClick:x,sortKey:C,sortDirection:y,onSortChange:_,isReordering:E,onToggleReorder:S})=>{const[L,R]=j.useState(!1),[J,V]=j.useState(!1);return n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex gap-2 h-12",children:[n.jsx("button",{onClick:x,className:"h-12 w-12 flex-shrink-0 bg-indigo-600 text-white rounded-xl flex items-center justify-center shadow-lg shadow-indigo-200 active:scale-95 transition-all",children:n.jsx(xc,{size:24})}),n.jsxs("div",{className:"relative flex-1",children:[n.jsx(yc,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:18}),n.jsx("input",{type:"text",placeholder:"...",className:"w-full h-full pl-10 pr-10 bg-white rounded-xl border-none shadow-sm focus:ring-2 focus:ring-indigo-500 outline-none text-sm font-medium",value:i,onChange:se=>{p(se.target.value),V(!0)},onBlur:()=>setTimeout(()=>V(!1),200)}),i.length>0&&n.jsx("button",{onClick:()=>p(""),className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 p-1.5",children:n.jsx(Ur,{size:16})}),J&&f.length>0&&n.jsx("div",{className:"absolute top-full left-0 right-0 mt-2 bg-white rounded-2xl shadow-xl z-50 overflow-hidden border border-gray-100",children:f.map((se,he)=>n.jsx("button",{onClick:()=>{p(se),V(!1)},className:"w-full text-left px-4 py-3 text-xs font-bold text-gray-700 hover:bg-gray-50 border-b border-gray-50 last:border-none",children:se},he))})]}),n.jsx("button",{onClick:()=>R(se=>!se),className:"h-12 w-12 flex-shrink-0 rounded-xl flex items-center justify-center shadow-sm active:scale-95 transition-all bg-indigo-600 text-white shadow-indigo-200",children:n.jsx(fc,{size:20})})]}),L&&n.jsxs("div",{className:"bg-white p-4 rounded-[1.5rem] shadow-sm border border-gray-100 space-y-3 animate-in slide-in-from-top-2",children:[n.jsx("h3",{className:"text-[11px] font-bold text-gray-400 uppercase tracking-widest ml-1",children:" "}),n.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[["title","author","addedAt"].map(se=>{const he=C===se&&!E&&C!=="custom";return n.jsxs("button",{onClick:()=>_(se),className:`py-2.5 rounded-xl font-bold text-xs transition-all flex items-center justify-center gap-1.5 ${he?"bg-indigo-600 text-white shadow-lg shadow-indigo-200":"bg-gray-50 text-gray-600 hover:bg-gray-100"}`,children:[se==="title"?"":se==="author"?"":"",he&&(y==="asc"?n.jsx(hc,{size:14}):n.jsx(pc,{size:14}))]},se)}),n.jsx("button",{onClick:S,className:`py-2.5 rounded-xl font-bold text-xs transition-all ${E||C==="custom"?"bg-indigo-600 text-white shadow-lg shadow-indigo-200":"bg-gray-50 text-gray-600 hover:bg-gray-100"}`,children:" "})]})]})]})},wg=()=>{const{books:i,updateBook:p,reorderBooks:f,addBook:x}=pn(),C=j.useMemo(()=>i.filter(we=>we.status==="Wishlist"),[i]),{filteredBooks:y,search:_,setSearch:E}=zp(C,[],[]),S=qo("wishlist_sort_prefs"),[L,R]=j.useState(S.key),[J,V]=j.useState(S.direction||"desc"),[se,he]=j.useState(!1),[fe,X]=j.useState([]),Z=j.useRef([]),te=j.useRef(null),oe=j.useRef(null),ce=j.useRef(null),ie=j.useRef(new Map),[je,de]=j.useState(null),[Pe,Be]=j.useState(null),Ye=j.useRef(null),[We,Ge]=j.useState(null);j.useEffect(()=>{se||mi("wishlist_sort_prefs",L,J)},[L,J,se]);const{sortedBooks:Te}=Ip(y,se?"custom":L,J);j.useEffect(()=>{Z.current=fe},[fe]),j.useEffect(()=>{se&&X(Te)},[se,Te]);const et=120,lt=22,{visibleItems:it,observerTarget:ae,hasMore:G}=_c(Te,20,[_,L,J,se]),T=se?fe:it,v=j.useMemo(()=>{if(_.length<2)return[];const we=_.toLowerCase(),Ze=new Set;return C.forEach(Ct=>{Ct.title.toLowerCase().includes(we)&&Ze.add(Ct.title),Ct.author.toLowerCase().includes(we)&&Ze.add(Ct.author)}),Array.from(Ze).slice(0,5)},[_,C]),[w,N]=j.useState(null),[re,pe]=j.useState(null),[be,Oe]=j.useState(["Paper"]),[Ke,qe]=j.useState(!1),tt=()=>{re&&(p({...re,status:"Reading",formats:be,readingStartedAt:new Date().toISOString()}),pe(null))},Se=j.useCallback(()=>{if(!se)return;const we=Z.current;if(we.length===0)return;const Ze=i.filter(rt=>rt.status==="Wishlist");if(we.length===Ze.length&&we.every((rt,Ft)=>{var Tt;return rt.id===((Tt=Ze[Ft])==null?void 0:Tt.id)}))return;const ft=i.filter(rt=>rt.status!=="Wishlist");f([...ft,...we])},[i,se,f]),Ht=j.useCallback(()=>{ce.current!==null&&(cancelAnimationFrame(ce.current),ce.current=null)},[]),ct=j.useCallback((we,Ze)=>{const ft=Z.current.filter(vt=>vt.id!==Ze);if(ft.length===0){Be(0),Ge(0);return}const rt=ft.map(vt=>{const $t=ie.current.get(vt.id);return $t?{id:vt.id,rect:$t.getBoundingClientRect()}:null}).filter(Boolean);if(rt.length===0)return;const Ft=12;let Tt=rt.length,Qt=rt[rt.length-1].rect.bottom+Ft/2;for(let vt=0;vt<rt.length;vt++){const{rect:$t}=rt[vt];if(we<$t.top+$t.height/2){Tt=vt,vt===0?Qt=$t.top-Ft/2:Qt=(rt[vt-1].rect.bottom+$t.top)/2;break}}Ye.current=Tt,Be(vt=>vt===Tt?vt:Tt),Ge(vt=>vt===Qt?vt:Qt)},[]),Mt=j.useCallback(()=>{const we=oe.current,Ze=te.current;if(we===null||!Ze){Ht();return}const Ct=window.innerHeight;let ft=0;if(we<et){const rt=(et-we)/et;ft=-Math.ceil(lt*Math.min(1,rt))}else if(we>Ct-et){const rt=(we-(Ct-et))/et;ft=Math.ceil(lt*Math.min(1,rt))}ft!==0&&(window.scrollBy(0,ft),ct(we,Ze)),ce.current=requestAnimationFrame(Mt)},[ct,Ht]),fr=j.useCallback(()=>{const we=te.current,Ze=Ye.current;if(we!==null&&Ze!==null){const Ct=Z.current,ft=Ct.find(rt=>rt.id===we);if(ft){const rt=Ct.filter(Qt=>Qt.id!==we),Ft=Math.max(0,Math.min(Ze,rt.length)),Tt=[...rt.slice(0,Ft),ft,...rt.slice(Ft)];Z.current=Tt,X(Tt),Se()}}te.current=null,oe.current=null,de(null),Be(null),Ye.current=null,Ge(null),window.removeEventListener("pointermove",Me),window.removeEventListener("pointerup",fr),Ht()},[Se,Ht]),Me=j.useCallback(we=>{const Ze=te.current;Ze&&(oe.current=we.clientY,ct(we.clientY,Ze))},[ct]),Vt=j.useCallback((we,Ze)=>{se&&(we.preventDefault(),we.stopPropagation(),te.current=Ze,oe.current=we.clientY,de(Ze),ct(we.clientY,Ze),window.addEventListener("pointermove",Me,{passive:!0}),window.addEventListener("pointerup",fr),ce.current===null&&(ce.current=requestAnimationFrame(Mt)))},[Mt,ct,fr,Me,se]),Cr=j.useCallback((we,Ze)=>{Ze?ie.current.set(we,Ze):ie.current.delete(we)},[]);j.useEffect(()=>()=>{window.removeEventListener("pointermove",Me),window.removeEventListener("pointerup",fr),Ht()},[fr,Me,Ht]);const Mr=()=>{se?(Se(),he(!1),R("custom")):(he(!0),R("custom"),X(Te),Z.current=Te,E(""))},_r=we=>{se&&he(!1),L===we?V(Ze=>Ze==="asc"?"desc":"asc"):(R(we),V(we==="addedAt"?"desc":"asc"))},Xt=j.useCallback(we=>{},[]);if(Ke)return n.jsx(vg,{onAdd:we=>{try{x(we)}catch(Ze){console.error("Failed to add wishlist item",Ze),alert("   ")}finally{qe(!1)}},onCancel:()=>qe(!1)});const Nt=({book:we,onClick:Ze,performanceMode:Ct=!1})=>n.jsxs("div",{onClick:Ze,className:`bg-white p-3 rounded-2xl border flex gap-4 items-center cursor-pointer select-none ${Ct?"border-gray-100":"shadow-sm border-transparent active:scale-95 transition-all"}`,children:[n.jsx("div",{className:`w-12 h-16 bg-gray-50 rounded-lg overflow-hidden flex-shrink-0 relative ${Ct?"border border-gray-100":"shadow-sm"}`,children:n.jsx(Or,{book:we,className:"w-full h-full",iconSize:16})}),n.jsxs("div",{className:"min-w-0 flex-1",children:[n.jsx("h3",{className:"font-bold text-gray-800 text-sm truncate",children:we.title}),n.jsx("p",{className:"text-[10px] text-gray-400 truncate mt-0.5",children:we.author}),!Ct&&n.jsx("p",{className:"text-[9px] text-indigo-300 font-bold mt-1",children:new Date(we.addedAt).toLocaleDateString("uk-UA")})]}),!se&&n.jsx("div",{className:"flex gap-2 pr-2",children:n.jsx("button",{onClick:ft=>{ft.stopPropagation(),pe(we),Oe(we.formats||["Paper"])},className:"p-2.5 bg-indigo-50 text-indigo-600 rounded-xl active:scale-90 transition-all hover:bg-indigo-100",children:n.jsx(Gh,{size:18})})})]});return n.jsxs("div",{className:"text-gray-800 space-y-4",children:[n.jsx("div",{className:"sticky top-[56px] z-20 -mx-4 mt-4 px-4 pt-0 pb-2 bg-slate-50/95 backdrop-blur-sm border-b border-gray-100",children:n.jsx(bg,{search:_,onSearchChange:E,suggestions:v,onAddClick:()=>qe(!0),sortKey:L,sortDirection:J,onSortChange:_r,isReordering:se,onToggleReorder:Mr})}),se?n.jsxs("div",{className:"space-y-3 select-none relative",children:[T.map(we=>n.jsx(Bp,{itemId:we.id,showHandle:!0,performanceMode:!0,isDragging:je===we.id,onHandlePointerDown:Vt,setItemRef:Cr,children:n.jsx(Nt,{book:we,performanceMode:!0,onClick:()=>Xt(we)})},we.id)),je&&We!==null&&n.jsx("div",{className:"pointer-events-none fixed z-40 h-1.5 rounded-full",style:{left:"1.25rem",right:"1.25rem",top:`${Math.round(We)}px`,transform:"translateY(calc(-50% - 12px))",backgroundColor:"var(--accent-600)",boxShadow:"0 0 0 3px var(--bg-main), 0 0 12px var(--accent-600)"}})]}):n.jsx("div",{className:"space-y-3",children:T.map(we=>n.jsx("div",{children:n.jsx(Nt,{book:we,onClick:()=>N(we)})},we.id))}),Te.length===0&&n.jsxs("div",{className:"flex flex-col items-center justify-center py-24 space-y-4 text-gray-300",children:[n.jsx(fm,{size:64,opacity:.2}),n.jsx("p",{className:"text-lg font-medium",children:_?"  ":"   "})]}),!se&&G&&n.jsx("div",{ref:ae,className:"flex justify-center py-4",children:n.jsx(Xr,{className:"animate-spin text-gray-300",size:20})}),w&&n.jsx(wi,{book:w,onClose:()=>N(null),onOpenReadingMode:()=>{}}),re&&n.jsx("div",{className:"fixed inset-0 z-[60] flex items-end sm:items-center justify-center p-4 bg-black/40 backdrop-blur-sm",children:n.jsx("div",{className:"bg-white w-full max-w-sm rounded-[2.5rem] overflow-hidden shadow-2xl animate-in slide-in-from-bottom duration-300",children:n.jsxs("div",{className:"p-8 space-y-6",children:[n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("h3",{className:"text-lg font-bold",children:" "}),n.jsx("button",{onClick:()=>pe(null),className:"p-2 bg-gray-50 rounded-full",children:n.jsx(Ur,{size:20})})]}),n.jsx("div",{className:"space-y-3",children:[{id:"Paper",label:"",icon:n.jsx(Sr,{size:18})},{id:"E-book",label:"",icon:n.jsx(bi,{size:18})},{id:"Audio",label:"",icon:n.jsx(yi,{size:18})}].map(we=>n.jsxs("button",{onClick:()=>{be.includes(we.id)?be.length>1&&Oe(be.filter(Ze=>Ze!==we.id)):Oe([...be,we.id])},className:`w-full flex justify-between items-center p-4 rounded-2xl font-bold text-sm border transition-all ${be.includes(we.id)?"bg-indigo-600 text-white border-indigo-600 shadow-lg":"bg-gray-50 text-gray-500 border-gray-100"}`,children:[n.jsxs("div",{className:"flex items-center gap-3",children:[we.icon,n.jsx("span",{children:we.label})]}),be.includes(we.id)&&n.jsx("div",{className:"w-2.5 h-2.5 bg-white rounded-full"})]},we.id))}),n.jsx("button",{onClick:tt,className:"w-full bg-indigo-600 text-white py-4 rounded-2xl font-bold shadow-xl active:scale-95 transition-all",children:" "})]})})})]})},jg=({search:i,onSearchChange:p,suggestions:f,onAddClick:x,sortKey:C,sortDirection:y,onSortChange:_,isReordering:E,onToggleReorder:S,selectedStatuses:L,selectedFormats:R,onToggleStatus:J,onToggleFormat:V,onClearFilters:se,publisherFilter:he,onPublisherFilterChange:fe,genreFilter:X,onGenreFilterChange:Z,publisherSuggestions:te,genreSuggestions:oe})=>{const[ce,ie]=j.useState(!1),[je,de]=j.useState(!1),[Pe,Be]=j.useState(!1),[Ye,We]=j.useState(!1),[Ge,Te]=j.useState(!1),et=j.useRef(0),lt=T=>{const v=Date.now();v-et.current<250||(et.current=v,T())},it=j.useMemo(()=>{if(!he.trim())return te.slice(0,8);const T=he.toLowerCase().trim();return te.filter(v=>v.toLowerCase().includes(T)).slice(0,8)},[he,te]),ae=j.useMemo(()=>{if(!X.trim())return oe.slice(0,8);const T=X.toLowerCase().trim();return oe.filter(v=>v.toLowerCase().includes(T)).slice(0,8)},[X,oe]),G=R.length>0||L.length!==3||he.trim().length>0||X.trim().length>0;return n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex gap-2 h-12",children:[n.jsx("button",{onClick:x,className:"h-12 w-12 flex-shrink-0 bg-indigo-600 text-white rounded-xl flex items-center justify-center shadow-lg shadow-indigo-200 active:scale-95 transition-all",children:n.jsx(xc,{size:24})}),n.jsxs("div",{className:"relative flex-1",children:[n.jsx(yc,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:18}),n.jsx("input",{type:"text",placeholder:"...",className:"w-full h-full pl-10 pr-10 bg-white rounded-xl border-none shadow-sm focus:ring-2 focus:ring-indigo-500 outline-none text-sm font-medium",value:i,onChange:T=>{p(T.target.value),ie(!0)},onBlur:()=>setTimeout(()=>ie(!1),200)}),i.length>0&&n.jsx("button",{onClick:()=>p(""),className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 p-1.5",children:n.jsx(Ur,{size:16})}),ce&&f.length>0&&n.jsx("div",{className:"absolute top-full left-0 right-0 mt-2 bg-white rounded-2xl shadow-xl z-50 overflow-hidden border border-gray-100",children:f.map((T,v)=>n.jsx("button",{onClick:()=>{p(T),ie(!1)},className:"w-full text-left px-4 py-3 text-xs font-bold text-gray-700 hover:bg-gray-50 border-b border-gray-50 last:border-none",children:T},v))})]}),n.jsx("button",{onClick:()=>{Te(!Ge),We(!1)},className:"h-12 w-12 flex-shrink-0 rounded-xl flex items-center justify-center shadow-sm active:scale-95 transition-all bg-indigo-600 text-white shadow-indigo-200",children:n.jsx(fc,{size:20})}),n.jsxs("button",{onClick:()=>{We(!Ye),Te(!1)},className:`relative h-12 w-12 flex-shrink-0 border rounded-xl flex items-center justify-center shadow-sm active:scale-95 transition-all ${Ye||G?"bg-white text-indigo-600 border-indigo-200":"bg-white text-gray-400 border-gray-100"}`,children:[n.jsx(tp,{size:20}),G&&!Ye&&n.jsx("div",{className:"absolute top-3 right-3 w-2 h-2 bg-indigo-600 rounded-full border border-white"})]})]}),Ge&&n.jsxs("div",{className:"bg-white p-4 rounded-[1.5rem] shadow-sm border border-gray-100 space-y-3 animate-in slide-in-from-top-2",children:[n.jsx("h3",{className:"text-[11px] font-bold text-gray-400 uppercase tracking-widest ml-1",children:" "}),n.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[["title","author","addedAt","genre"].map(T=>{const v=C===T&&!E&&C!=="custom";return n.jsxs("button",{onClick:()=>_(T),className:`py-2.5 rounded-xl font-bold text-xs transition-all flex items-center justify-center gap-1.5 ${v?"bg-indigo-600 text-white shadow-lg shadow-indigo-200":"bg-gray-50 text-gray-600 hover:bg-gray-100"}`,children:[T==="title"?"":T==="author"?"":T==="addedAt"?"":"",v&&(y==="asc"?n.jsx(hc,{size:14}):n.jsx(pc,{size:14}))]},T)}),n.jsx("button",{onClick:S,className:`py-2.5 rounded-xl font-bold text-xs transition-all ${E||C==="custom"?"bg-indigo-600 text-white shadow-lg shadow-indigo-200":"bg-gray-50 text-gray-600 hover:bg-gray-100"}`,children:" "})]})]}),Ye&&n.jsxs("div",{className:"bg-white p-5 rounded-[2rem] shadow-sm border border-gray-100 space-y-5 animate-in slide-in-from-top-2",children:[n.jsxs("div",{className:"space-y-3",children:[n.jsx("span",{className:"text-xs font-bold text-gray-400 uppercase tracking-widest ml-1",children:""}),n.jsx("div",{className:"flex flex-wrap gap-2",children:["Reading","Unread","Completed"].map(T=>n.jsx("button",{onClick:()=>J(T),className:`px-4 py-2 rounded-xl text-xs font-bold transition-all border ${L.includes(T)?"bg-indigo-100 text-indigo-700 border-indigo-200":"bg-gray-50 text-gray-400 border-gray-100"}`,children:gi[T]},T))})]}),n.jsxs("div",{className:"space-y-3",children:[n.jsx("span",{className:"text-xs font-bold text-gray-400 uppercase tracking-widest ml-1",children:""}),n.jsx("div",{className:"flex flex-wrap gap-2",children:Object.keys(Jn).map(T=>n.jsx("button",{onClick:()=>V(T),className:`px-4 py-2 rounded-xl text-xs font-bold transition-all border ${R.includes(T)?"bg-indigo-100 text-indigo-700 border-indigo-200":"bg-gray-50 text-gray-400 border-gray-100"}`,children:Jn[T]},T))})]}),n.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[n.jsxs("div",{className:"relative space-y-2",children:[n.jsx("span",{className:"text-xs font-bold text-gray-400 uppercase tracking-widest ml-1",children:""}),n.jsx("input",{type:"text",value:he,onChange:T=>{fe(T.target.value),de(!0)},onFocus:()=>de(!0),onBlur:()=>setTimeout(()=>de(!1),200),placeholder:"  ",className:"w-full bg-gray-50 px-3 py-2.5 rounded-xl text-xs font-bold border border-gray-100 outline-none focus:ring-2 focus:ring-indigo-500"}),je&&it.length>0&&n.jsx("div",{className:"absolute left-0 right-0 top-full mt-1 bg-white rounded-xl shadow-xl z-50 overflow-hidden border border-gray-100 max-h-36 overflow-y-auto",children:it.map((T,v)=>n.jsx("button",{type:"button",onTouchStart:w=>{w.preventDefault(),lt(()=>{fe(T),de(!1)})},onPointerDown:w=>{w.preventDefault(),lt(()=>{fe(T),de(!1)})},onClick:()=>lt(()=>{fe(T),de(!1)}),className:"w-full text-left px-3 py-2 text-xs font-bold text-gray-700 hover:bg-gray-50 border-b border-gray-50 last:border-none",children:T},v))})]}),n.jsxs("div",{className:"relative space-y-2",children:[n.jsx("span",{className:"text-xs font-bold text-gray-400 uppercase tracking-widest ml-1",children:""}),n.jsx("input",{type:"text",value:X,onChange:T=>{Z(T.target.value),Be(!0)},onFocus:()=>Be(!0),onBlur:()=>setTimeout(()=>Be(!1),200),placeholder:"  ",className:"w-full bg-gray-50 px-3 py-2.5 rounded-xl text-xs font-bold border border-gray-100 outline-none focus:ring-2 focus:ring-indigo-500"}),Pe&&ae.length>0&&n.jsx("div",{className:"absolute left-0 right-0 top-full mt-1 bg-white rounded-xl shadow-xl z-50 overflow-hidden border border-gray-100 max-h-36 overflow-y-auto",children:ae.map((T,v)=>n.jsx("button",{type:"button",onTouchStart:w=>{w.preventDefault(),lt(()=>{Z(T),Be(!1)})},onPointerDown:w=>{w.preventDefault(),lt(()=>{Z(T),Be(!1)})},onClick:()=>lt(()=>{Z(T),Be(!1)}),className:"w-full text-left px-3 py-2 text-xs font-bold text-gray-700 hover:bg-gray-50 border-b border-gray-50 last:border-none",children:T},v))})]})]}),G&&n.jsxs("button",{onClick:se,className:"w-full py-3 flex items-center justify-center gap-2 text-sm font-bold text-red-500 bg-red-50 rounded-2xl hover:bg-red-100 transition-colors",children:[n.jsx(Ur,{size:18}),"  "]})]})]})},kg=({format:i})=>{switch(i){case"Paper":return n.jsx(Sr,{size:14});case"Audio":return n.jsx(yi,{size:14});case"E-book":return n.jsx(bi,{size:14});case"Pirate":return n.jsx(rp,{size:14});case"Expected":return n.jsx(io,{size:14});case"Sold":return n.jsx(lp,{size:14});default:return null}},Ng=j.memo(({book:i,onClick:p,isDragging:f})=>{const x=Nr.useRef(0),C=Nr.useRef(null),y=Nr.useCallback(()=>{const _=Date.now();_-x.current<300||(x.current=_,p(i))},[i,p]);return n.jsxs("div",{onClick:y,onTouchStart:_=>{const E=_.changedTouches[0];E&&(C.current={x:E.clientX,y:E.clientY,id:E.identifier})},onTouchEnd:_=>{const E=C.current;if(C.current=null,!E)return;let S=null;for(let R=0;R<_.changedTouches.length;R+=1){const J=_.changedTouches.item(R);if(J&&J.identifier===E.id){S=J;break}}if(S||(S=_.changedTouches.item(0)),!S)return;Math.abs(S.clientX-E.x)+Math.abs(S.clientY-E.y)<=10&&y()},className:`bg-white p-4 rounded-3xl shadow-sm border border-gray-100 flex gap-4 items-center active:scale-95 transition-all cursor-pointer select-none ${f?"opacity-50 scale-95 ring-2 ring-indigo-500 shadow-xl":""}`,children:[n.jsx("div",{className:"w-12 h-16 bg-gray-50 rounded-xl overflow-hidden flex-shrink-0 shadow-sm border border-gray-100 relative",children:n.jsx(Or,{book:i,className:"w-full h-full",iconSize:20})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("h3",{className:"font-bold text-gray-800 text-sm truncate",children:i.title}),n.jsx("p",{className:"text-[10px] text-gray-500 truncate",children:i.author}),i.seasons&&i.seasons.length>0&&n.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:i.seasons.map(_=>n.jsx("span",{className:`text-[9px] px-1.5 py-0.5 rounded-full font-bold ${uo(_)}`,children:_},_))}),n.jsxs("div",{className:"flex gap-2 mt-1.5 items-center",children:[i.formats.map(_=>n.jsx("span",{className:_==="Sold"?"text-red-500":"text-gray-400",children:n.jsx(kg,{format:_})},_)),i.notes&&n.jsx("span",{className:"text-base leading-none truncate max-w-[120px]",children:i.notes}),(i.rating||0)>0&&n.jsxs("span",{className:"ml-auto text-[10px] font-black px-1.5 py-0.5 bg-gray-50 rounded text-gray-600 flex-shrink-0",children:[" ",i.rating]})]})]}),n.jsx("div",{className:`w-2 h-2 rounded-full flex-shrink-0 ${i.status==="Completed"?"bg-emerald-500":i.status==="Reading"?"bg-indigo-600":"bg-gray-200"}`})]})}),Sg=({onAddClick:i})=>{const{books:p,reorderBooks:f,filterTag:x,setFilterTag:C}=pn(),[y,_]=j.useState("library"),E=j.useRef({library:0,wishlist:0}),S=j.useMemo(()=>p.filter(Re=>Re.status!=="Wishlist"),[p]),L=["Paper","E-book","Audio","Pirate","Expected"],{filteredBooks:R,search:J,setSearch:V,publisherFilter:se,setPublisherFilter:he,genreFilter:fe,setGenreFilter:X,selectedStatuses:Z,selectedFormats:te,toggleStatusFilter:oe,toggleFormatFilter:ce,clearFilters:ie}=zp(S,["Reading","Unread","Completed"],L),je=qo("library_sort_prefs"),[de,Pe]=j.useState(je.key),[Be,Ye]=j.useState(je.direction||"desc"),[We,Ge]=j.useState(!1),{sortedBooks:Te}=Ip(R,We?"custom":de,Be),[et,lt]=j.useState(null),[it,ae]=j.useState(!1),[G,T]=j.useState([]),v=j.useRef([]),w=j.useRef(null),N=j.useRef(null),re=j.useRef(null),pe=j.useRef(new Map),[be,Oe]=j.useState(null),[Ke,qe]=j.useState(null),tt=j.useRef(null),[Se,Ht]=j.useState(null);j.useEffect(()=>{x!==J&&V(x)},[x]),j.useEffect(()=>{const Re=()=>{E.current[y]=window.scrollY};return window.addEventListener("scroll",Re,{passive:!0}),()=>window.removeEventListener("scroll",Re)},[y]);const ct=Re=>{Re!==y&&(E.current[y]=window.scrollY,_(Re),requestAnimationFrame(()=>{window.scrollTo({top:E.current[Re]||0,behavior:"auto"})}))};j.useEffect(()=>{We||mi("library_sort_prefs",de,Be)},[de,Be,We]),j.useEffect(()=>{v.current=G},[G]),j.useEffect(()=>{We&&T(Te)},[We,Te]);const Mt=120,fr=22,Me=Re=>{V(Re),Re===""&&C(""),Re&&We&&Ge(!1)},Vt=j.useMemo(()=>{if(J.length<2)return[];const Re=J.toLowerCase(),nt=new Set;return p.forEach(Ce=>{Ce.title.toLowerCase().includes(Re)&&nt.add(Ce.title),Ce.author.toLowerCase().includes(Re)&&nt.add(Ce.author)}),Array.from(nt).slice(0,5)},[J,p]),Cr=j.useMemo(()=>{const Re=new Set;return S.forEach(nt=>{const Ce=(nt.publisher||"").trim();Ce&&Re.add(Ce)}),Array.from(Re).sort((nt,Ce)=>nt.localeCompare(Ce,"uk"))},[S]),Mr=j.useMemo(()=>{const Re=new Set;return S.forEach(nt=>{const Ce=(nt.genre||"").trim();Ce&&Re.add(Ce)}),Array.from(Re).sort((nt,Ce)=>nt.localeCompare(Ce,"uk"))},[S]),_r=()=>{We?(Nt(),Ge(!1),Pe("custom")):(Ge(!0),Pe("custom"),T(Te),v.current=Te,V(""),ie())},Xt=Re=>{We&&Ge(!1),de===Re?Ye(nt=>nt==="asc"?"desc":"asc"):(Pe(Re),Ye(Re==="addedAt"?"desc":"asc"))},Nt=j.useCallback(()=>{if(!We)return;const Re=v.current;if(Re.length===0)return;const nt=p.filter(Fe=>Fe.status!=="Wishlist");if(Re.length===nt.length&&Re.every((Fe,ue)=>{var ut;return Fe.id===((ut=nt[ue])==null?void 0:ut.id)}))return;const W=p.filter(Fe=>Fe.status==="Wishlist"),ne=[...Re,...W];f(ne)},[p,We,f]),we=j.useCallback(()=>{re.current!==null&&(cancelAnimationFrame(re.current),re.current=null)},[]),Ze=j.useCallback((Re,nt)=>{const W=v.current.filter(st=>st.id!==nt);if(W.length===0){qe(0),Ht(0);return}const ne=W.map(st=>{const Rt=pe.current.get(st.id);return Rt?{id:st.id,rect:Rt.getBoundingClientRect()}:null}).filter(Boolean);if(ne.length===0)return;const Fe=12;let ue=ne.length,ut=ne[ne.length-1].rect.bottom+Fe/2;for(let st=0;st<ne.length;st++){const{rect:Rt}=ne[st];if(Re<Rt.top+Rt.height/2){ue=st,st===0?ut=Rt.top-Fe/2:ut=(ne[st-1].rect.bottom+Rt.top)/2;break}}tt.current=ue,qe(st=>st===ue?st:ue),Ht(st=>st===ut?st:ut)},[]),Ct=j.useCallback(()=>{const Re=N.current,nt=w.current;if(Re===null||!nt){we();return}const Ce=window.innerHeight;let W=0;if(Re<Mt){const ne=(Mt-Re)/Mt;W=-Math.ceil(fr*Math.min(1,ne))}else if(Re>Ce-Mt){const ne=(Re-(Ce-Mt))/Mt;W=Math.ceil(fr*Math.min(1,ne))}W!==0&&(window.scrollBy(0,W),Ze(Re,nt)),re.current=requestAnimationFrame(Ct)},[Ze,we]),ft=j.useCallback(()=>{const Re=w.current,nt=tt.current;if(Re!==null&&nt!==null){const Ce=v.current,W=Ce.find(ne=>ne.id===Re);if(W){const ne=Ce.filter(ut=>ut.id!==Re),Fe=Math.max(0,Math.min(nt,ne.length)),ue=[...ne.slice(0,Fe),W,...ne.slice(Fe)];v.current=ue,T(ue),Nt()}}w.current=null,N.current=null,Oe(null),qe(null),tt.current=null,Ht(null),window.removeEventListener("pointermove",rt),window.removeEventListener("pointerup",ft),we()},[Nt,we]),rt=j.useCallback(Re=>{const nt=w.current;nt&&(N.current=Re.clientY,Ze(Re.clientY,nt))},[Ze]),Ft=j.useCallback((Re,nt)=>{We&&(Re.preventDefault(),Re.stopPropagation(),w.current=nt,N.current=Re.clientY,Oe(nt),Ze(Re.clientY,nt),window.addEventListener("pointermove",rt,{passive:!0}),window.addEventListener("pointerup",ft),re.current===null&&(re.current=requestAnimationFrame(Ct)))},[Ct,Ze,ft,rt,We]),Tt=j.useCallback((Re,nt)=>{nt?pe.current.set(Re,nt):pe.current.delete(Re)},[]);j.useEffect(()=>()=>{window.removeEventListener("pointermove",rt),window.removeEventListener("pointerup",ft),we()},[ft,rt,we]);const Qt=j.useCallback(Re=>{},[]),{visibleItems:vt,observerTarget:$t,hasMore:pr}=_c(Te,20,[J,Z,te,de,Be,We,y]),Er=We?G:vt;return n.jsxs("div",{className:`p-4 pb-24 text-gray-800 ${y==="library"?"space-y-6":"space-y-0"}`,children:[n.jsxs("div",{className:`sticky top-0 z-30 -mx-4 px-4 bg-slate-50/95 backdrop-blur-sm ${y==="library"?"py-2 border-b border-gray-100":"pt-2 pb-0"}`,children:[n.jsx("header",{className:"flex justify-between items-center",children:n.jsxs("div",{className:"flex items-baseline gap-4",children:[n.jsx("h1",{onClick:()=>ct("library"),className:`text-3xl font-bold cursor-pointer transition-colors ${y==="library"?"text-gray-800":"text-gray-300"}`,children:""}),n.jsx("h1",{onClick:()=>ct("wishlist"),className:`text-3xl font-bold cursor-pointer transition-colors ${y==="wishlist"?"text-gray-800":"text-gray-300"}`,children:""})]})}),y==="library"&&n.jsx("div",{className:"mt-4",children:n.jsx(jg,{search:J,onSearchChange:Me,suggestions:Vt,onAddClick:i,sortKey:de,sortDirection:Be,onSortChange:Xt,isReordering:We,onToggleReorder:_r,selectedStatuses:Z,selectedFormats:te,onToggleStatus:oe,onToggleFormat:ce,onClearFilters:ie,publisherFilter:se,onPublisherFilterChange:he,genreFilter:fe,onGenreFilterChange:X,publisherSuggestions:Cr,genreSuggestions:Mr})})]}),y==="library"?n.jsxs(n.Fragment,{children:[We?n.jsxs("div",{className:"space-y-3 relative",children:[Er.map(Re=>n.jsx(Bp,{itemId:Re.id,showHandle:!0,performanceMode:!0,isDragging:be===Re.id,onHandlePointerDown:Ft,setItemRef:Tt,children:n.jsxs("div",{onClick:()=>Qt(Re),className:"bg-white p-4 rounded-3xl shadow-sm border border-gray-100 flex gap-4 items-center select-none",children:[n.jsx("div",{className:"w-12 h-16 bg-gray-50 rounded-xl overflow-hidden flex-shrink-0 shadow-sm border border-gray-100 relative",children:n.jsx(Or,{book:Re,className:"w-full h-full",iconSize:20})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("h3",{className:"font-bold text-gray-800 text-sm truncate",children:Re.title}),n.jsx("p",{className:"text-[10px] text-gray-500 truncate",children:Re.author})]}),n.jsx("div",{className:`w-2 h-2 rounded-full flex-shrink-0 ${Re.status==="Completed"?"bg-emerald-500":Re.status==="Reading"?"bg-indigo-600":"bg-gray-200"}`})]})},Re.id)),be&&Se!==null&&n.jsx("div",{className:"pointer-events-none fixed z-40 h-1.5 rounded-full",style:{left:"1.25rem",right:"1.25rem",top:`${Math.round(Se)}px`,transform:"translateY(calc(-50% - 12px))",backgroundColor:"var(--accent-600)",boxShadow:"0 0 0 3px var(--bg-main), 0 0 12px var(--accent-600)"}})]}):n.jsx("div",{className:"space-y-3",children:Er.map(Re=>n.jsx("div",{children:n.jsx(Ng,{book:Re,onClick:lt})},Re.id))}),Te.length===0&&n.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-gray-300",children:[n.jsx(Sr,{size:48,className:"mb-2 opacity-20"}),n.jsx("p",{className:"text-sm",children:"  "})]}),!We&&pr&&n.jsx("div",{ref:$t,className:"flex justify-center py-4",children:n.jsx(Xr,{className:"animate-spin text-gray-300",size:20})})]}):n.jsx(wg,{}),et&&!it&&n.jsx(wi,{book:et,onClose:()=>lt(null),onOpenReadingMode:()=>ae(!0)}),it&&et&&n.jsx(ji,{book:et,onClose:()=>ae(!1)})]})},Kf=()=>{const{books:i}=pn(),[p,f]=j.useState(null),[x,C]=j.useState(!1),y=i.filter(_=>_.status==="Reading");return n.jsxs("div",{className:"p-4 space-y-6 pb-24 text-gray-800",children:[n.jsxs("header",{children:[n.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:""}),n.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"  "})]}),y.length===0?n.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-gray-300",children:[n.jsx(Sr,{size:64,className:"mb-4 opacity-20"}),n.jsx("p",{className:"text-lg font-medium",children:"    "}),n.jsx("p",{className:"text-xs mt-2",children:"   "})]}):n.jsx("div",{className:"space-y-4",children:y.map(_=>{const E=Ho(_.pagesRead,$r(_));return n.jsxs("div",{onClick:()=>f(_),className:"bg-white p-4 rounded-3xl shadow-sm border border-gray-100 flex gap-4 items-start active:scale-95 transition-all cursor-pointer",children:[n.jsx("div",{className:"w-20 h-28 bg-gray-50 rounded-xl overflow-hidden flex-shrink-0 shadow-sm border border-gray-100",children:n.jsx(Or,{book:_,className:"w-full h-full",iconSize:24})}),n.jsxs("div",{className:"flex-1 min-w-0 py-1 flex flex-col justify-between h-28",children:[n.jsxs("div",{children:[n.jsx("h3",{className:"font-bold text-gray-800 text-lg leading-tight line-clamp-2 mb-1",children:_.title}),n.jsx("p",{className:"text-xs text-gray-500 truncate",children:_.author})]}),n.jsxs("div",{className:"space-y-1.5",children:[n.jsxs("div",{className:"flex justify-between items-end",children:[n.jsx("span",{className:"text-[10px] font-bold text-gray-400 uppercase",children:""}),n.jsxs("span",{className:"text-sm font-black text-indigo-600",children:[E,"%"]})]}),n.jsx("div",{className:"w-full h-2 bg-gray-100 rounded-full overflow-hidden",children:n.jsx("div",{className:"h-full bg-indigo-600 rounded-full transition-all duration-500",style:{width:`${E}%`}})}),n.jsxs("p",{className:"text-[10px] text-gray-400 text-right font-medium",children:[_.pagesRead," / ",$r(_)," ."]})]})]})]},_.id)})}),p&&!x&&n.jsx(wi,{book:p,onClose:()=>f(null),onOpenReadingMode:()=>C(!0)}),x&&p&&n.jsx(ji,{book:p,onClose:()=>C(!1)})]})},Cg={"app.loading":"Loading...","nav.library":"Library","nav.reading":"Reading","nav.calendar":"Calendar","nav.statistics":"Stats","nav.settings":"Settings","common.back":"Back","common.save":"Save","common.cancel":"Cancel","common.delete":"Delete","common.edit":"Edit","common.clear":"Clear","common.enabled":"Enabled","common.disabled":"Disabled","common.unknown":"-","status.Reading":"Reading","status.Completed":"Completed","status.Unread":"Unread","status.Wishlist":"Wishlist","format.Paper":"Paper","format.E-book":"E-book","format.Audio":"Audio","format.Pirate":"Pirate","format.Expected":"Expected","format.Sold":"Sold","season.Winter":"Winter","season.Spring":"Spring","season.Summer":"Summer","season.Autumn":"Autumn","sort.sortBy":"Sort by","sort.title":"Title","sort.author":"Author","sort.date":"Date","sort.genre":"Genre","sort.customOrder":"Custom order","library.tab.library":"Library","library.tab.wishlist":"Wishlist","library.searchPlaceholder":"Search...","library.addBook":"Add book","library.addWishlist":"Add wishlist","library.sort":"Sort","library.filters":"Filters","library.clearSearch":"Clear search","library.filter.status":"Status","library.filter.format":"Format","library.filter.publisher":"Publisher","library.filter.genre":"Genre","library.filter.publisherPlaceholder":"Filter publisher","library.filter.genrePlaceholder":"Filter genre","library.clearFilters":"Clear filters","library.reorder.clearSearch":"Clear search to reorder items","library.reorder.clearFilters":"Clear filters to reorder items","library.empty":"No books found.","library.failedReorder":"Failed to reorder","library.saved":"Saved","library.failedSave":"Failed to save","library.bookAdded":"Book added","library.failedAddBook":"Failed to add book","library.wishlistAdded":"Wishlist item added","library.failedAddWishlist":"Failed to add wishlist item","library.bookNotFound":"Book was not found. Returning to list...","library.bookDeleted":"Book deleted","library.failedDelete":"Failed to delete book","library.deleteTitle":"Delete book?","library.deleteMessage":'Delete "{title}"? This action cannot be undone.',"library.movedToReading":"Moved to reading","library.failedUpdateStatus":"Failed to update status","bookForm.touchSafe":"Touch-safe form. No modal overlay, no custom touch handlers.","bookForm.preview":"Preview","bookForm.cover":"Cover","bookForm.title":"Title","bookForm.author":"Author","bookForm.coverUrl":"Cover URL","bookForm.coverUrlPlaceholder":"https://example.com/cover.jpg","bookForm.publisher":"Publisher","bookForm.genre":"Genre","bookForm.series":"Series","bookForm.seriesPart":"Series Part","bookForm.pages":"Pages","bookForm.status":"Status","bookForm.seasons":"Seasons","bookForm.formats":"Formats","bookForm.notes":"Notes","bookForm.notesPlaceholder":"Emoji or short marks","bookForm.comment":"Comment","bookForm.addBookTitle":"Add Book","bookForm.editBookTitle":"Edit Book","bookForm.addBookSubmit":"Add book","bookForm.saveSubmit":"Save","bookForm.addWishlistTitle":"Add Wishlist","bookForm.addWishlistSubtitle":"Simple touch-safe wishlist form.","bookForm.saveWishlist":"Save wishlist","bookForm.magicSearch":"Find cover by title and author","bookForm.toast.coverNeedTitle":"Enter a title to search cover","bookForm.toast.coverFound":"Cover found","bookForm.toast.coverNotFound":"Cover was not found","bookForm.toast.coverSearchError":"Cover search failed","details.publisher":"Publisher","details.genre":"Genre","details.seasons":"Seasons","details.series":"Series","details.status":"Status","details.rating":"Rating","details.pages":"Pages","details.added":"Added","details.formats":"Formats","details.completed":"Completed","details.time":"Time","details.speed":"Speed","details.inWishlistSince":"In wishlist since","details.progress":"Progress","details.notes":"Notes","details.comment":"Comment","details.openReading":"Open reading","details.startReading":"Start reading","details.deleteAria":"Delete book","details.unit.minutes":"min","details.unit.pagesPerHour":"p/h","settings.title":"Settings","settings.subtitle":"Data and appearance","settings.interface":"Interface","settings.language":"App language","settings.lang.en":"English","settings.lang.uk":"Ukrainian","settings.accent":"Accent color","settings.background":"Background tone","settings.uiV2":"UI V2 (beta)","settings.uiV2Help":"Experimental route-based library flow without BookDetails modal overlay.","settings.backupTitle":"Backup and Import","settings.backupSubtitle":"Export JSON backup or import books from Excel/Google Sheets CSV.","settings.export":"Export (JSON)","settings.exporting":"Exporting...","settings.importJson":"Import (JSON)","settings.importCsv":"Import from Excel / CSV","settings.importingCovers":"Loading covers...","settings.debugTitle":"Debug mode","settings.debugHelp":"Temporary diagnostics mode for iPhone. Stores local logs.","settings.openLogs":"Open logs","settings.aboutTitle":"About","settings.localStorageTitle":"Local storage","settings.localStorageDesc":"All data and covers are stored in your browser.","settings.versionDesc":"Your reading companion","settings.logsTitle":"Debug logs","settings.logsCount":"Entries: {count}","settings.logsCopy":"Copy","settings.logsClear":"Clear","settings.logsEmpty":"Logs are empty.","settings.toast.uiV2On":"UI V2 beta enabled","settings.toast.uiV2Off":"UI V2 beta disabled","settings.toast.exportOk":"Export completed","settings.toast.exportFail":"Export failed","settings.toast.importOk":"Library restored","settings.toast.importInvalid":"Invalid file format","settings.toast.importCount":"Imported {count} books","settings.toast.csvFail":"CSV import failed","settings.toast.debugOn":"Debug mode enabled","settings.toast.debugOff":"Debug mode disabled","settings.toast.logsCleared":"Logs cleared","settings.toast.logsCopied":"Logs copied","settings.toast.logsCopyFail":"Could not copy logs","settings.confirmReplaceTitle":"Replace library?","settings.confirmReplaceMessage":"Importing JSON will fully replace your current library. This action cannot be undone.","settings.confirmReplace":"Replace","accent.indigo":"Indigo (Default)","accent.rose":"Rose","accent.pink":"Pink","accent.amber":"Amber","accent.gold":"Gold","accent.emerald":"Emerald","accent.violet":"Violet","accent.sky":"Sky","accent.black":"Black","accent.white":"White","bg.cool":"Cool","bg.warm":"Warm","bg.neutral":"Neutral","bg.peach":"Peach","bg.mint":"Mint","bg.dark":"Dark","bg.midnight":"Midnight","bg.forest":"Forest"},_g={"app.loading":"...","nav.library":"","nav.reading":"","nav.calendar":"","nav.statistics":"","nav.settings":"","common.back":"","common.save":"","common.cancel":"","common.delete":"","common.edit":"","common.clear":"","common.enabled":"","common.disabled":"","common.unknown":"-","status.Reading":"","status.Completed":"","status.Unread":" ","status.Wishlist":"","format.Paper":"","format.E-book":"","format.Audio":"","format.Pirate":"","format.Expected":"","format.Sold":"","season.Winter":"","season.Spring":"","season.Summer":"","season.Autumn":"","sort.sortBy":" ","sort.title":"","sort.author":"","sort.date":"","sort.genre":"","sort.customOrder":" ","library.tab.library":"","library.tab.wishlist":"","library.searchPlaceholder":"...","library.addBook":" ","library.addWishlist":" ","library.sort":"","library.filters":"","library.clearSearch":" ","library.filter.status":"","library.filter.format":"","library.filter.publisher":"","library.filter.genre":"","library.filter.publisherPlaceholder":"  ","library.filter.genrePlaceholder":"  ","library.clearFilters":" ","library.reorder.clearSearch":" ,   ","library.reorder.clearFilters":" ,   ","library.empty":"  .","library.failedReorder":"   ","library.saved":"","library.failedSave":"  ","library.bookAdded":" ","library.failedAddBook":"   ","library.wishlistAdded":" ","library.failedAddWishlist":"   ","library.bookNotFound":"  .   ...","library.bookDeleted":" ","library.failedDelete":"   ","library.deleteTitle":" ?","library.deleteMessage":' "{title}"?    .',"library.movedToReading":"  ","library.failedUpdateStatus":"   ","bookForm.touchSafe":"   touch-.      touch-.","bookForm.preview":"","bookForm.cover":"","bookForm.title":"","bookForm.author":"","bookForm.coverUrl":"URL ","bookForm.coverUrlPlaceholder":"https://example.com/cover.jpg","bookForm.publisher":"","bookForm.genre":"","bookForm.series":"","bookForm.seriesPart":" ","bookForm.pages":"","bookForm.status":"","bookForm.seasons":"","bookForm.formats":"","bookForm.notes":"","bookForm.notesPlaceholder":"    ","bookForm.comment":"","bookForm.addBookTitle":" ","bookForm.editBookTitle":" ","bookForm.addBookSubmit":" ","bookForm.saveSubmit":"","bookForm.addWishlistTitle":" ","bookForm.addWishlistSubtitle":" touch-safe  .","bookForm.saveWishlist":" ","bookForm.magicSearch":"     ","bookForm.toast.coverNeedTitle":"    ","bookForm.toast.coverFound":" ","bookForm.toast.coverNotFound":"  ","bookForm.toast.coverSearchError":"  ","details.publisher":"","details.genre":"","details.seasons":"","details.series":"","details.status":"","details.rating":"","details.pages":"","details.added":"","details.formats":"","details.completed":"","details.time":"","details.speed":"","details.inWishlistSince":"  ","details.progress":"","details.notes":"","details.comment":"","details.openReading":" ","details.startReading":" ","details.deleteAria":" ","details.unit.minutes":"","details.unit.pagesPerHour":"/","settings.title":"","settings.subtitle":"   ","settings.interface":"","settings.language":" ","settings.lang.en":"","settings.lang.uk":"","settings.accent":" ","settings.background":" ","settings.uiV2":"UI V2 (beta)","settings.uiV2Help":" route-based     BookDetails.","settings.backupTitle":"   ","settings.backupSubtitle":" JSON     Excel/Google Sheets CSV.","settings.export":" (JSON)","settings.exporting":"...","settings.importJson":" (JSON)","settings.importCsv":"  Excel / CSV","settings.importingCovers":" ...","settings.debugTitle":"Debug mode","settings.debugHelp":"    iPhone.   .","settings.openLogs":" ","settings.aboutTitle":" ","settings.localStorageTitle":" ","settings.localStorageDesc":"       .","settings.versionDesc":"   ","settings.logsTitle":"Debug ","settings.logsCount":": {count}","settings.logsCopy":"","settings.logsClear":"","settings.logsEmpty":" .","settings.toast.uiV2On":"UI V2 beta ","settings.toast.uiV2Off":"UI V2 beta ","settings.toast.exportOk":" ","settings.toast.exportFail":" ","settings.toast.importOk":" ","settings.toast.importInvalid":"  ","settings.toast.importCount":" {count} ","settings.toast.csvFail":"  CSV","settings.toast.debugOn":"Debug mode ","settings.toast.debugOff":"Debug mode ","settings.toast.logsCleared":" ","settings.toast.logsCopied":" ","settings.toast.logsCopyFail":"   ","settings.confirmReplaceTitle":" ?","settings.confirmReplaceMessage":" JSON     .    .","settings.confirmReplace":"","accent.indigo":" ()","accent.rose":"","accent.pink":"","accent.amber":"","accent.gold":"","accent.emerald":"","accent.violet":"","accent.sky":"","accent.black":"","accent.white":"","bg.cool":"","bg.warm":"","bg.neutral":"","bg.peach":"","bg.mint":"","bg.dark":"","bg.midnight":"","bg.forest":""},za={en:Cg,uk:_g},Up=j.createContext(void 0),Eg=(i,p)=>p?i.replace(/\{(\w+)\}/g,(f,x)=>String(p[x]??"")):i,Pg=({language:i,children:p})=>{const f=j.useMemo(()=>{const x=za[i]||za.en;return{language:i,locale:i==="uk"?"uk-UA":"en-US",t:(C,y)=>{const _=x,E=za.en,S=_[C]||E[C]||C;return Eg(S,y)}}},[i]);return n.jsx(Up.Provider,{value:f,children:p})},Rs=()=>{const i=j.useContext(Up);if(!i)throw new Error("useI18n must be used within an I18nProvider");return i},$p=i=>{if(Array.isArray(i)){const f=i.map(x=>String(x).trim()).filter(Boolean).map(x=>Zn(x));return Array.from(new Set(f))}if(typeof i!="string")return[];const p=i.split(/[,;/\n]+/g).map(f=>f.trim()).filter(Boolean).map(f=>Zn(f));return Array.from(new Set(p))},Tg=async i=>new Promise((p,f)=>{const x=new FileReader;x.onload=async C=>{var y;try{const _=(y=C.target)==null?void 0:y.result,E=JSON.parse(_);if(!E||!Array.isArray(E.books))throw new Error("   Libra");const S=E.books.map(L=>(L.coverUrl&&L.coverUrl.startsWith("data:image")&&(L.coverBlob=wc(L.coverUrl),L.coverUrl=""),L.seasons!==void 0&&(L.seasons=$p(L.seasons)),L.sessions||(L.sessions=[]),L));await Tp({books:S}),p(!0)}catch(_){console.error("Import failed",_),f(_)}},x.onerror=()=>f(x.error),x.readAsText(i)}),Vf=(i,p)=>{const f=[];let x="",C=!1;for(let y=0;y<i.length;y++){const _=i[y],E=i[y+1];_==='"'?C&&E==='"'?(x+='"',y++):C=!C:_===p&&!C?(f.push(x.trim()),x=""):x+=_}return f.push(x.trim()),f},Rg=async i=>new Promise((p,f)=>{const x=new FileReader;x.onload=async C=>{var y;try{let _=(y=C.target)==null?void 0:y.result;_.charCodeAt(0)===65279&&(_=_.slice(1));const E=_.split(/\r?\n/).filter(X=>X.trim()!=="");if(E.length<2)throw new Error("     ");const S=E[0],L=(S.match(/,/g)||[]).length,J=(S.match(/;/g)||[]).length>L?";":",",V=Vf(S,J).map(X=>X.toLowerCase().replace(/^\ufeff/,"")),se=[];for(let X=1;X<E.length;X++){const Z=E[X];if(!Z.trim())continue;const te=Vf(Z,J);if(te.length<1)continue;const oe={id:fn(),addedAt:new Date().toISOString(),formats:["Paper"],status:"Unread",sessions:[]};let ce=!1;if(V.forEach((ie,je)=>{const de=te[je];if(de){if(ie.includes("title")||ie.includes("")||ie.includes("")||ie.includes("name"))oe.title=de,ce=!0;else if(ie.includes("author")||ie.includes(""))oe.author=de;else if(ie.includes("publisher")||ie.includes(""))oe.publisher=de;else if(ie.includes("series")||ie.includes(""))oe.seriesPart=de;else if(ie.includes("pages")||ie.includes(""))oe.pagesTotal=parseInt(de.replace(/\D/g,""))||0;else if(ie.includes("rating")||ie.includes("")){const Pe=parseInt(de);isNaN(Pe)||(oe.rating=Pe*2)}else if(ie.includes("isbn"))oe.isbn=de;else if(ie.includes("genre")||ie.includes(""))oe.genre=de;else if(ie.includes("season")||ie.includes(""))oe.seasons=$p(de);else if(ie.includes("cover")||ie.includes(""))oe.coverUrl=de;else if(ie.includes("date")||ie.includes("")||ie.includes("finished")){let Pe=de.trim(),Be=null;const Ye=Pe.match(/^(\d{1,2})[./-](\d{1,2})[./-](\d{4})$/);if(Ye)Be=new Date(parseInt(Ye[3]),parseInt(Ye[2])-1,parseInt(Ye[1]));else{const We=new Date(Pe);isNaN(We.getTime())||(Be=We)}Be&&!isNaN(Be.getTime())&&(oe.completedAt=Be.toISOString(),oe.status="Completed")}else if(ie.includes("status")||ie.includes("")){const Pe=de.toLowerCase();Pe.includes("read")||Pe.includes("")||Pe.includes("completed")?(oe.status="Completed",oe.completedAt||(oe.completedAt=new Date().toISOString())):Pe.includes("reading")||Pe.includes("")?oe.status="Reading":Pe.includes("wish")||Pe.includes("")?oe.status="Wishlist":oe.status="Unread"}else if(ie.includes("format")||ie.includes("")){const Pe=de.toLowerCase(),Be=[];(Pe.includes("paper")||Pe.includes(""))&&Be.push("Paper"),(Pe.includes("ebook")||Pe.includes(""))&&Be.push("E-book"),(Pe.includes("audio")||Pe.includes(""))&&Be.push("Audio"),Be.length>0&&(oe.formats=Be)}}}),oe.status==="Completed"){oe.completedAt||(oe.completedAt=new Date().toISOString()),!oe.pagesTotal&&oe.pagesRead&&(oe.pagesTotal=oe.pagesRead),oe.pagesTotal?oe.pagesRead=oe.pagesTotal:oe.pagesRead=0;const ie=oe.pagesTotal||0,je=ie>0?Math.round(ie*72):0,de=oe.completedAt?oe.completedAt.split("T")[0]:new Date().toISOString().split("T")[0];oe.sessions=[{id:fn(),date:de,duration:je,pages:ie}]}else oe.status==="Reading"&&oe.pagesTotal&&!oe.pagesRead&&(oe.pagesRead=0);ce&&(oe.author||(oe.author=" "),se.push(oe))}for(const X of se)if(!X.coverUrl||!X.coverUrl.trim())try{const Z=await Qo(X.title,X.author,X.isbn);Z&&(X.coverUrl=Z)}catch(Z){console.warn(Z)}if(se.length===0)throw new Error("   .");const fe={books:[...(await Pp()).books,...se]};await Tp(fe),p(se.length)}catch(_){console.error("Import CSV failed",_),f(_)}},x.onerror=()=>f(x.error),x.readAsText(i)}),Wf=({onSettingsChange:i})=>{const{t:p,locale:f}=Rs(),{toast:x,confirm:C}=Yo(),{refreshLibrary:y}=pn(),_=j.useRef(null),E=j.useRef(null),[S,L]=j.useState(!1),[R,J]=j.useState(!1),[V,se]=j.useState({accent:"indigo",bg:"cool",uiV2Enabled:!1,language:"en"}),[he,fe]=j.useState(!1),[X,Z]=j.useState(!1),[te,oe]=j.useState([]);j.useEffect(()=>{se(_p()),fe(xp())},[]),j.useEffect(()=>{X&&oe(Mf())},[X,he]);const ce=T=>{se(T),tg(T),i==null||i(T),Fp(T.accent,T.bg)},ie=T=>{ce({...V,accent:T})},je=T=>{ce({...V,bg:T})},de=T=>{ce({...V,language:T})},Pe=()=>{const T={...V,uiV2Enabled:!V.uiV2Enabled};ce(T),x.show(T.uiV2Enabled?p("settings.toast.uiV2On"):p("settings.toast.uiV2Off"),"info")},Be=async()=>{J(!0);try{await og(),x.show(p("settings.toast.exportOk"),"success")}catch(T){console.error("Failed to export library:",T),x.show(p("settings.toast.exportFail"),"error")}finally{J(!1)}},Ye=async()=>{var v;await C({title:p("settings.confirmReplaceTitle"),message:p("settings.confirmReplaceMessage"),confirmText:p("settings.confirmReplace"),type:"danger"})&&((v=_.current)==null||v.click())},We=()=>{var T;(T=E.current)==null||T.click()},Ge=async T=>{var w;const v=(w=T.target.files)==null?void 0:w[0];if(v){L(!0);try{await Tg(v),await y(),x.show(p("settings.toast.importOk"),"success")}catch{x.show(p("settings.toast.importInvalid"),"error")}finally{L(!1),_.current&&(_.current.value="")}}},Te=async T=>{var w;const v=(w=T.target.files)==null?void 0:w[0];if(v){L(!0);try{const N=await Rg(v);await y(),x.show(p("settings.toast.importCount",{count:N}),"success")}catch(N){console.error(N),x.show(p("settings.toast.csvFail"),"error")}finally{L(!1),E.current&&(E.current.value="")}}},et=()=>{const T=!he;fe(T),Pm(T),x.show(p(T?"settings.toast.debugOn":"settings.toast.debugOff"),"info")},lt=()=>{Tm(),oe([]),x.show(p("settings.toast.logsCleared"),"success")},it=async()=>{const T=JSON.stringify(Mf(),null,2);try{await navigator.clipboard.writeText(T),x.show(p("settings.toast.logsCopied"),"success")}catch{x.show(p("settings.toast.logsCopyFail"),"error")}},ae=T=>p(`accent.${T}`),G=T=>p(`bg.${T}`);return n.jsxs("div",{className:"p-4 space-y-6 pb-24 text-gray-800",children:[n.jsxs("header",{children:[n.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:p("settings.title")}),n.jsx("p",{className:"text-gray-500",children:p("settings.subtitle")})]}),n.jsxs("div",{className:"bg-white rounded-3xl p-6 shadow-sm border border-gray-100 space-y-5",children:[n.jsxs("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-widest flex items-center gap-2",children:[n.jsx(am,{size:14})," ",p("settings.interface")]}),n.jsxs("div",{className:"space-y-3",children:[n.jsx("label",{className:"text-sm font-bold text-gray-700",children:p("settings.language")}),n.jsx("div",{className:"grid grid-cols-2 gap-2",children:["en","uk"].map(T=>{const v=(V.language||"en")===T;return n.jsx("button",{type:"button",onClick:()=>de(T),className:`h-11 rounded-xl border text-xs font-bold transition-all ${v?"border-indigo-500 ring-1 ring-indigo-500 text-indigo-700 bg-indigo-50":"border-gray-100 text-gray-500 hover:border-gray-300"}`,children:p(T==="en"?"settings.lang.en":"settings.lang.uk")},T)})})]}),n.jsxs("div",{className:"space-y-3",children:[n.jsx("label",{className:"text-sm font-bold text-gray-700",children:p("settings.accent")}),n.jsx("div",{className:"flex flex-wrap gap-3",children:Object.entries(Op).map(([T,v])=>n.jsx("button",{onClick:()=>ie(T),className:`w-10 h-10 rounded-full flex items-center justify-center transition-all ${V.accent===T?"ring-4 ring-gray-200 scale-110":"hover:scale-105"}`,style:{backgroundColor:v.hex},title:ae(T),children:V.accent===T&&n.jsx(ci,{size:20,className:"text-white drop-shadow-md"})},T))})]}),n.jsxs("div",{className:"space-y-3 pt-2",children:[n.jsx("label",{className:"text-sm font-bold text-gray-700",children:p("settings.background")}),n.jsx("div",{className:"grid grid-cols-3 gap-2",children:Object.entries(Mp).map(([T,v])=>n.jsx("button",{onClick:()=>je(T),className:`h-12 rounded-xl border flex items-center justify-center text-xs font-bold transition-all ${V.bg===T?"border-indigo-500 ring-1 ring-indigo-500 text-indigo-700":"border-gray-100 text-gray-500 hover:border-gray-300"}`,style:{backgroundColor:v.vars.card},children:G(T)},T))})]}),n.jsxs("div",{className:"space-y-3 pt-2",children:[n.jsx("label",{className:"text-sm font-bold text-gray-700",children:p("settings.uiV2")}),n.jsx("button",{type:"button",onClick:Pe,className:`w-full py-3 rounded-2xl border text-sm font-bold transition-all ${V.uiV2Enabled?"bg-indigo-50 text-indigo-700 border-indigo-200":"bg-gray-50 text-gray-600 border-gray-200"}`,children:V.uiV2Enabled?p("common.enabled"):p("common.disabled")}),n.jsx("p",{className:"text-xs text-gray-500",children:p("settings.uiV2Help")})]})]}),n.jsxs("div",{className:"bg-white rounded-3xl p-6 shadow-sm border border-gray-100 space-y-4",children:[n.jsx("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-widest",children:p("settings.backupTitle")}),n.jsx("p",{className:"text-sm text-gray-500",children:p("settings.backupSubtitle")}),n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsxs("button",{onClick:Be,disabled:S||R,className:"bg-indigo-50 text-indigo-700 py-4 rounded-2xl font-bold flex flex-col items-center justify-center gap-2 active:scale-95 transition-all border border-indigo-100 hover:bg-indigo-100 disabled:opacity-50",children:[R?n.jsx(Xr,{className:"animate-spin",size:24}):n.jsx(rm,{size:24}),n.jsx("span",{className:"text-xs",children:p(R?"settings.exporting":"settings.export")})]}),n.jsxs("button",{onClick:Ye,disabled:S||R,className:"bg-gray-50 text-gray-700 py-4 rounded-2xl font-bold flex flex-col items-center justify-center gap-2 active:scale-95 transition-all border border-gray-100 hover:bg-gray-100 disabled:opacity-50",children:[n.jsx(cp,{size:24}),n.jsx("span",{className:"text-xs",children:p("settings.importJson")})]}),n.jsxs("button",{onClick:We,disabled:S||R,className:"col-span-2 bg-emerald-50 text-emerald-700 py-4 rounded-2xl font-bold flex flex-col items-center justify-center gap-2 active:scale-95 transition-all border border-emerald-100 hover:bg-emerald-100 disabled:opacity-50",children:[S?n.jsx(Xr,{className:"animate-spin",size:24}):n.jsx(nm,{size:24}),n.jsx("span",{className:"text-xs",children:p(S?"settings.importingCovers":"settings.importCsv")})]}),n.jsx("input",{type:"file",ref:_,onChange:Ge,accept:".json",className:"hidden"}),n.jsx("input",{type:"file",ref:E,onChange:Te,accept:".csv",className:"hidden"})]})]}),n.jsxs("div",{className:"bg-white rounded-3xl p-6 shadow-sm border border-gray-100 space-y-4",children:[n.jsxs("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-widest flex items-center gap-2",children:[n.jsx(Xh,{size:14})," ",p("settings.debugTitle")]}),n.jsx("p",{className:"text-sm text-gray-500",children:p("settings.debugHelp")}),n.jsxs("div",{className:"flex items-center justify-between gap-3",children:[n.jsx("button",{onClick:et,className:`px-4 py-2 rounded-xl text-xs font-bold border transition-all ${he?"bg-emerald-50 text-emerald-700 border-emerald-200":"bg-gray-50 text-gray-600 border-gray-200"}`,children:p(he?"common.enabled":"common.disabled")}),n.jsx("button",{onClick:()=>Z(!0),className:"px-4 py-2 rounded-xl text-xs font-bold border bg-indigo-50 text-indigo-700 border-indigo-200",children:p("settings.openLogs")})]})]}),n.jsxs("div",{className:"bg-white rounded-3xl p-6 shadow-sm border border-gray-100 space-y-4",children:[n.jsx("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-widest",children:p("settings.aboutTitle")}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(dm,{className:"text-indigo-600",size:20}),n.jsxs("div",{className:"text-sm",children:[n.jsx("p",{className:"font-bold text-gray-800",children:p("settings.localStorageTitle")}),n.jsx("p",{className:"text-gray-500 text-xs",children:p("settings.localStorageDesc")})]})]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(ci,{className:"text-emerald-500",size:20}),n.jsxs("div",{className:"text-sm",children:[n.jsx("p",{className:"font-bold text-gray-800",children:"Libra v2.0"}),n.jsx("p",{className:"text-gray-500 text-xs",children:p("settings.versionDesc")})]})]})]})]}),X&&n.jsx("div",{className:"fixed inset-0 z-[120] bg-black/40 backdrop-blur-sm flex items-end sm:items-center justify-center p-0 sm:p-4",children:n.jsxs("div",{className:"w-full h-full sm:h-auto sm:max-h-[90vh] sm:max-w-2xl bg-white sm:rounded-[2rem] shadow-2xl overflow-hidden flex flex-col",children:[n.jsxs("div",{className:"sticky top-0 z-10 bg-white border-b border-gray-100 p-4 flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800",children:p("settings.logsTitle")}),n.jsx("p",{className:"text-xs text-gray-500",children:p("settings.logsCount",{count:te.length})})]}),n.jsx("button",{onClick:()=>Z(!1),className:"p-2 rounded-full bg-gray-50 text-gray-500",children:n.jsx(Ur,{size:18})})]}),n.jsxs("div",{className:"p-4 flex gap-2 border-b border-gray-100",children:[n.jsxs("button",{onClick:it,className:"px-3 py-2 rounded-xl text-xs font-bold border bg-indigo-50 text-indigo-700 border-indigo-200 flex items-center gap-2",children:[n.jsx(em,{size:14})," ",p("settings.logsCopy")]}),n.jsxs("button",{onClick:lt,className:"px-3 py-2 rounded-xl text-xs font-bold border bg-red-50 text-red-700 border-red-200 flex items-center gap-2",children:[n.jsx(Va,{size:14})," ",p("settings.logsClear")]})]}),n.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-2 bg-gray-50",children:te.length===0?n.jsx("div",{className:"text-sm text-gray-500",children:p("settings.logsEmpty")}):te.slice().reverse().map(T=>n.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-3",children:[n.jsxs("div",{className:"text-[10px] text-gray-500",children:[new Date(T.ts).toLocaleString(f)," | ",T.level," | ",T.scope]}),n.jsx("div",{className:"text-xs font-semibold text-gray-800 mt-1 break-words",children:T.message}),T.details&&n.jsx("pre",{className:"mt-2 text-[10px] text-gray-600 whitespace-pre-wrap break-words",children:T.details})]},T.id))})]})})]})},Dg=(i,p)=>{if(p==="year")return new Intl.DateTimeFormat("uk-UA",{year:"numeric"}).format(i);const f=new Intl.DateTimeFormat("uk-UA",{month:"long",year:"numeric"}).format(i);return f.charAt(0).toUpperCase()+f.slice(1)},Ag=i=>new Intl.DateTimeFormat("uk-UA",{day:"2-digit",month:"2-digit",year:"numeric"}).format(i),qf=(i,p,f)=>p==="month"?new Date(i.getFullYear(),i.getMonth()+f,1):new Date(i.getFullYear()+f,0,1),Hf=()=>{const{books:i}=pn(),[p,f]=j.useState(!1),[x,C]=j.useState("month"),[y,_]=j.useState(()=>new Date),E=j.useMemo(()=>{const L=i.filter(Z=>Z.formats.includes("Paper")&&Z.status!=="Wishlist"),R=L.length,J=L.filter(Z=>Z.status==="Completed").length,V=L.filter(Z=>Z.status==="Reading").length,se=L.filter(Z=>Z.status==="Unread").length,he=R>0?Math.round(J/R*100):0,fe={};L.forEach(Z=>{if(!Z.publisher)return;const te=Z.publisher.trim();te&&(fe[te]||(fe[te]={total:0,read:0}),fe[te].total+=1,Z.status==="Completed"&&(fe[te].read+=1))});const X=Object.entries(fe).map(([Z,te])=>({name:Z,total:te.total,read:te.read,percent:te.total>0?Math.round(te.read/te.total*100):0})).sort((Z,te)=>te.total-Z.total);return{total:R,read:J,reading:V,unread:se,readPercent:he,publisherStats:X}},[i]),S=j.useMemo(()=>{const L=x==="month"?new Date(y.getFullYear(),y.getMonth(),1):new Date(y.getFullYear(),0,1),R=x==="month"?new Date(y.getFullYear(),y.getMonth()+1,1):new Date(y.getFullYear()+1,0,1),J=i.filter(V=>V.status==="Completed"&&!!V.completedAt).map(V=>({book:V,completedDate:new Date(V.completedAt)})).filter(V=>!Number.isNaN(V.completedDate.getTime())&&V.completedDate>=L&&V.completedDate<R).sort((V,se)=>se.completedDate.getTime()-V.completedDate.getTime());return{start:L,end:R,completedBooks:J}},[i,y,x]);return p?n.jsxs("div",{className:"p-4 space-y-5 pb-32 animate-in fade-in",children:[n.jsx("header",{className:"flex items-center justify-between gap-3",children:n.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[n.jsx("button",{type:"button",onClick:()=>f(!1),className:"w-10 h-10 rounded-xl border border-gray-100 bg-white text-gray-500 flex items-center justify-center shadow-sm","aria-label":"",children:n.jsx(Ua,{size:18})}),n.jsxs("div",{className:"min-w-0",children:[n.jsx("h1",{className:"text-2xl font-bold text-gray-800 truncate",children:""}),n.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:"     "})]})]})}),n.jsxs("section",{className:"bg-white rounded-3xl border border-gray-100 p-4 space-y-4 shadow-sm",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-2 bg-gray-50 p-1 rounded-2xl",children:[n.jsx("button",{type:"button",onClick:()=>{C("month"),_(new Date)},className:`py-2 rounded-xl text-xs font-bold transition-colors ${x==="month"?"bg-indigo-600 text-white":"text-gray-500 hover:bg-white"}`,children:""}),n.jsx("button",{type:"button",onClick:()=>{C("year"),_(new Date)},className:`py-2 rounded-xl text-xs font-bold transition-colors ${x==="year"?"bg-indigo-600 text-white":"text-gray-500 hover:bg-white"}`,children:""})]}),n.jsxs("div",{className:"flex items-center justify-between gap-2",children:[n.jsx("button",{type:"button",onClick:()=>_(L=>qf(L,x,-1)),className:"w-10 h-10 rounded-xl border border-gray-100 text-gray-500 bg-gray-50 flex items-center justify-center","aria-label":" ",children:n.jsx(ep,{size:18})}),n.jsxs("div",{className:"text-center min-w-0",children:[n.jsx("p",{className:"text-xs uppercase tracking-wider text-gray-400 font-bold",children:" "}),n.jsx("p",{className:"text-sm font-bold text-gray-800 truncate",children:Dg(y,x)})]}),n.jsx("button",{type:"button",onClick:()=>_(L=>qf(L,x,1)),className:"w-10 h-10 rounded-xl border border-gray-100 text-gray-500 bg-gray-50 flex items-center justify-center","aria-label":" ",children:n.jsx(Zu,{size:18})})]}),n.jsxs("div",{className:"bg-indigo-50 border border-indigo-100 rounded-2xl p-4 flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-[10px] font-bold uppercase tracking-wider text-indigo-500",children:" "}),n.jsx("p",{className:"text-3xl font-black text-indigo-700",children:S.completedBooks.length})]}),n.jsx(Ia,{className:"text-indigo-300",size:28})]})]}),n.jsxs("section",{className:"space-y-3",children:[n.jsx("h2",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider ml-1",children:" "}),S.completedBooks.length===0?n.jsxs("div",{className:"bg-white rounded-3xl border border-gray-100 p-8 text-center text-gray-400",children:[n.jsx(Sr,{size:30,className:"mx-auto mb-2 opacity-40"}),n.jsx("p",{className:"text-sm font-semibold",children:"      "})]}):n.jsx("div",{className:"space-y-3",children:S.completedBooks.map(({book:L,completedDate:R})=>n.jsxs("article",{className:"bg-white border border-gray-100 rounded-3xl p-3 shadow-sm flex gap-3 items-center",children:[n.jsx(Or,{book:L,className:"w-12 h-16 rounded-xl flex-shrink-0",iconSize:16}),n.jsxs("div",{className:"min-w-0 flex-1",children:[n.jsx("h3",{className:"text-sm font-bold text-gray-800 truncate",children:L.title}),n.jsx("p",{className:"text-xs text-gray-500 truncate",children:L.author}),n.jsxs("p",{className:"text-[10px] text-gray-400 mt-1",children:[": ",L.formats.map(J=>Jn[J]).join(", ")]})]}),n.jsxs("div",{className:"text-right flex-shrink-0",children:[n.jsx("p",{className:"text-[10px] text-gray-400 font-bold uppercase",children:""}),n.jsx("p",{className:"text-xs font-bold text-gray-700",children:Ag(R)})]})]},L.id))})]})]}):n.jsxs("div",{className:"p-4 space-y-8 pb-32 animate-in fade-in",children:[n.jsxs("header",{children:[n.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:" "}),n.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"  "})]}),n.jsxs("section",{className:"space-y-4",children:[n.jsxs("button",{type:"button",onClick:()=>f(!0),className:"w-full bg-white border border-gray-100 rounded-3xl p-4 flex items-center justify-between shadow-sm hover:bg-gray-50 transition-colors",children:[n.jsxs("div",{className:"text-left",children:[n.jsx("p",{className:"text-[10px] font-bold uppercase tracking-wider text-gray-400",children:""}),n.jsx("p",{className:"text-sm font-bold text-gray-800",children:"   / "})]}),n.jsx(Zu,{size:18,className:"text-gray-400"})]}),n.jsxs("div",{className:"bg-indigo-600 p-6 rounded-[2.5rem] shadow-xl shadow-indigo-200 text-white relative overflow-hidden group",children:[n.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-white opacity-5 rounded-full -translate-y-1/2 translate-x-1/3 blur-3xl"}),n.jsx(Sr,{className:"absolute -right-6 -bottom-6 text-white opacity-10 w-40 h-40 group-hover:scale-110 transition-transform duration-500"}),n.jsxs("div",{className:"relative z-10",children:[n.jsxs("div",{className:"flex items-baseline gap-2 mb-1",children:[n.jsx("span",{className:"text-6xl font-black tracking-tighter",children:E.total}),n.jsx("span",{className:"text-sm font-bold opacity-80 uppercase tracking-widest",children:""})]}),n.jsx("p",{className:"text-indigo-200 text-xs font-medium mb-6",children:"   "}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex justify-between text-xs font-bold uppercase tracking-wider opacity-90",children:[n.jsx("span",{children:" "}),n.jsxs("span",{children:[E.readPercent,"%"]})]}),n.jsx("div",{className:"w-full h-2 bg-black/20 rounded-full overflow-hidden backdrop-blur-sm",children:n.jsx("div",{className:"h-full bg-white rounded-full transition-all duration-1000 ease-out shadow-[0_0_10px_rgba(255,255,255,0.5)]",style:{width:`${E.readPercent}%`}})})]})]})]}),n.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[n.jsxs("div",{className:"bg-emerald-50 p-4 rounded-3xl border border-emerald-100 flex flex-col items-center justify-center gap-2 shadow-sm",children:[n.jsx(vc,{className:"text-emerald-500 mb-1",size:24}),n.jsx("span",{className:"text-3xl font-black text-emerald-700",children:E.read}),n.jsx("span",{className:"text-[9px] font-bold text-emerald-400 uppercase tracking-wide",children:""})]}),n.jsxs("div",{className:"bg-amber-50 p-4 rounded-3xl border border-amber-100 flex flex-col items-center justify-center gap-2 shadow-sm",children:[n.jsx(Jf,{className:"text-amber-500 mb-1",size:24}),n.jsx("span",{className:"text-3xl font-black text-amber-700",children:E.reading}),n.jsx("span",{className:"text-[9px] font-bold text-amber-400 uppercase tracking-wide",children:""})]}),n.jsxs("div",{className:"bg-white p-4 rounded-3xl border border-gray-100 flex flex-col items-center justify-center gap-2 shadow-sm",children:[n.jsx(di,{className:"text-gray-400 mb-1",size:24}),n.jsx("span",{className:"text-3xl font-black text-gray-700",children:E.unread}),n.jsx("span",{className:"text-[9px] font-bold text-gray-400 uppercase tracking-wide",children:" "})]})]})]}),E.publisherStats.length>0&&n.jsxs("section",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center gap-2 ml-1",children:[n.jsx(xi,{size:16,className:"text-gray-400"}),n.jsx("h2",{className:"text-xs font-bold text-gray-400 uppercase tracking-widest",children:""})]}),n.jsx("div",{className:"grid grid-cols-1 gap-3",children:E.publisherStats.map((L,R)=>n.jsxs("div",{className:"bg-white p-4 rounded-2xl border border-gray-100 shadow-sm flex items-center justify-between gap-4",children:[n.jsxs("div",{className:"flex items-center gap-4 min-w-0 flex-1",children:[n.jsx("span",{className:"text-2xl font-black text-gray-100 w-8 text-center flex-shrink-0",children:R+1}),n.jsxs("div",{className:"min-w-0",children:[n.jsx("h3",{className:"font-bold text-sm text-gray-800 truncate",children:L.name}),n.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[n.jsx("div",{className:"h-1.5 w-24 bg-gray-100 rounded-full overflow-hidden",children:n.jsx("div",{className:`h-full rounded-full ${L.percent===100?"bg-emerald-500":"bg-indigo-500"}`,style:{width:`${L.percent}%`}})}),n.jsxs("span",{className:"text-[10px] font-bold text-gray-400",children:[L.percent,"%"]})]})]})]}),n.jsxs("div",{className:"text-right flex-shrink-0",children:[n.jsxs("div",{className:"flex items-baseline justify-end gap-1",children:[n.jsx("span",{className:"text-lg font-black text-gray-800",children:L.read}),n.jsxs("span",{className:"text-xs font-bold text-gray-400",children:["/ ",L.total]})]}),n.jsx("span",{className:"text-[9px] font-bold text-gray-400 uppercase",children:""})]})]},L.name))})]}),E.total===0&&n.jsxs("div",{className:"text-center py-12 text-gray-300",children:[n.jsx(Sr,{size:48,className:"mx-auto mb-2 opacity-20"}),n.jsx("p",{className:"text-sm font-medium",children:"   "}),n.jsx("p",{className:"text-xs mt-1",children:'    "",   '})]})]})},tr=(i,p)=>i.slice(0,p).replace(/[\u0000-\u0008\u000B\u000C\u000E-\u001F\u007F\u200B-\u200D\uFEFF]/g,""),Oa=i=>{if(!i||i.length===0)return["Paper"];const p=Array.from(new Set(i));return p.length>0?p:["Paper"]},Ma=i=>!i||i.length===0?[]:Array.from(new Set(i.map(p=>Zn(p)).map(p=>p.trim()).filter(Boolean))),Kp=({title:i,submitLabel:p,initialValue:f,publisherSuggestions:x,genreSuggestions:C,allowedStatuses:y,onSubmit:_,onCancel:E})=>{const{t:S}=Rs(),{toast:L}=Yo(),[R,J]=j.useState({title:f.title||"",author:f.author||"",publisher:f.publisher||"",genre:f.genre||"",series:f.series||"",seriesPart:f.seriesPart||"",pagesTotal:Number(f.pagesTotal)||0,formats:Oa(f.formats),status:f.status||y[0]||"Unread",coverUrl:f.coverUrl||"",coverBlob:f.coverBlob,notes:f.notes||"",comment:f.comment||"",seasons:Ma(f.seasons)}),[V,se]=j.useState(!1),[he,fe]=j.useState(!1),[X,Z]=j.useState(!1),[te,oe]=j.useState(!1),[ce,ie]=j.useState(null),je=j.useRef(null),de=j.useRef(null);j.useEffect(()=>{const v=w=>{X&&je.current&&!je.current.contains(w.target)&&Z(!1),te&&de.current&&!de.current.contains(w.target)&&oe(!1)};return document.addEventListener("mousedown",v),document.addEventListener("touchstart",v),()=>{document.removeEventListener("mousedown",v),document.removeEventListener("touchstart",v)}},[X,te]),j.useEffect(()=>{let v=null;return R.coverBlob?(v=URL.createObjectURL(R.coverBlob),ie(v)):ie(null),()=>{v&&URL.revokeObjectURL(v)}},[R.coverBlob]);const Pe=j.useMemo(()=>Array.from(new Set(x.filter(Boolean))).slice(0,100),[x]),Be=j.useMemo(()=>Array.from(new Set(C.filter(Boolean))).slice(0,100),[C]),Ye=j.useMemo(()=>{const v=(R.publisher||"").trim().toLowerCase();return v?Pe.filter(w=>w.toLowerCase().includes(v)):Pe},[R.publisher,Pe]),We=j.useMemo(()=>{const v=(R.genre||"").trim().toLowerCase();return v?Be.filter(w=>w.toLowerCase().includes(v)):Be},[R.genre,Be]),Ge=()=>{Z(!1),oe(!1)},Te=(v,w)=>{J(N=>({...N,[v]:w}))};j.useMemo(()=>({id:"__preview__",title:R.title||S("bookForm.preview"),author:R.author||"",formats:Oa(R.formats),status:R.status||y[0]||"Unread",genre:R.genre||"",publisher:R.publisher||"",series:R.series||"",seriesPart:R.seriesPart||"",pagesTotal:Math.max(0,Number(R.pagesTotal)||0),pagesRead:0,coverUrl:R.coverUrl||ce||"",coverBlob:void 0,notes:R.notes||"",comment:R.comment||"",seasons:Ma(R.seasons),addedAt:f.addedAt||new Date().toISOString(),sessions:f.sessions||[]}),[y,ce,R.author,R.comment,R.coverUrl,R.formats,R.genre,R.notes,R.pagesTotal,R.publisher,R.seasons,R.series,R.seriesPart,R.status,R.title,f.addedAt,f.sessions,S]);const et=j.useMemo(()=>({id:"__preview__",title:R.title||S("bookForm.preview"),coverUrl:R.coverUrl||ce||"",coverBlob:void 0,author:"",status:"Unread",addedAt:"",formats:[]}),[R.title,R.coverUrl,ce,S]),lt=(R.coverUrl||ce||"").trim(),it=async()=>{const v=tr(R.title||"",180).trim(),w=tr(R.author||"",140).trim();if(!v){L.show(S("bookForm.toast.coverNeedTitle"),"info");return}fe(!0);try{const N=await Qo(v,w);N?(J(re=>({...re,coverUrl:N,coverBlob:void 0})),L.show(S("bookForm.toast.coverFound"),"success")):L.show(S("bookForm.toast.coverNotFound"),"info")}catch(N){console.error("Cover search failed",N),L.show(S("bookForm.toast.coverSearchError"),"error")}finally{fe(!1)}},ae=v=>{const w=Oa(R.formats);if(w.includes(v)){if(w.length===1)return;Te("formats",w.filter(N=>N!==v));return}Te("formats",[...w,v])},G=v=>{const w=Zn(v),N=Ma(R.seasons);if(N.includes(w)){Te("seasons",N.filter(re=>re!==w));return}Te("seasons",[...N,w])},T=v=>{if(v.preventDefault(),V)return;Ge();const w=tr(R.title||"",180).trim(),N=tr(R.author||"",140).trim();if(!(!w||!N)){se(!0);try{_({...R,title:w,author:N,publisher:tr(R.publisher||"",120).trim(),genre:tr(R.genre||"",160).trim(),series:tr(R.series||"",120).trim(),seriesPart:tr(R.seriesPart||"",60).trim(),coverUrl:tr(R.coverUrl||"",1024).trim(),notes:tr(R.notes||"",80),comment:tr(R.comment||"",2e3),pagesTotal:Math.max(0,Number(R.pagesTotal)||0),formats:Oa(R.formats),seasons:Ma(R.seasons)})}finally{se(!1)}}};return n.jsxs("div",{className:"h-[100dvh] overflow-y-auto overscroll-contain p-4 pb-24 text-gray-800",children:[n.jsxs("button",{onClick:()=>{Ge(),E()},className:"flex items-center gap-2 text-gray-400 hover:text-gray-600 transition-colors",children:[n.jsx(Ua,{size:20}),n.jsx("span",{className:"text-sm font-bold",children:S("common.back")})]}),n.jsxs("div",{className:"mt-4 bg-white p-6 rounded-3xl shadow-sm border border-gray-100",children:[n.jsx("header",{className:"mb-6",children:n.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:i})}),n.jsxs("form",{onSubmit:T,className:"space-y-4",children:[n.jsxs("div",{className:"flex gap-5 mb-6",children:[n.jsxs("div",{className:"relative w-32 flex-shrink-0",children:[n.jsx("div",{className:"w-32 aspect-[2/3] bg-gray-50 rounded-2xl border border-gray-100 overflow-hidden shadow-sm",children:lt?n.jsx(Or,{book:et,className:"w-full h-full",iconSize:32}):n.jsxs("div",{className:"w-full h-full flex flex-col items-center justify-center gap-1 text-gray-300",children:[n.jsx(vi,{size:22}),n.jsx("span",{className:"text-[9px] font-bold uppercase tracking-wide",children:S("bookForm.cover")})]})}),!lt&&n.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:n.jsx("span",{className:"sr-only",children:"Upload"})}),n.jsx("button",{type:"button",onClick:it,disabled:V||he,className:"absolute top-2 right-2 bg-white/90 backdrop-blur-sm p-1.5 rounded-full text-indigo-600 shadow-sm border border-indigo-50 active:scale-95 transition-all disabled:opacity-50 z-20",title:S("bookForm.magicSearch"),"aria-label":S("bookForm.magicSearch"),children:he?n.jsx(Xr,{className:"animate-spin",size:16}):n.jsx(Wa,{size:16})})]}),n.jsxs("div",{className:"flex-1 space-y-3 min-w-0",children:[n.jsxs("div",{className:"space-y-1",children:[n.jsx("label",{className:"text-[10px] font-bold text-gray-400 uppercase ml-1",children:S("bookForm.title")}),n.jsx("input",{required:!0,maxLength:180,className:"w-full bg-gray-50 p-3 rounded-2xl outline-none focus:ring-2 focus:ring-indigo-500 border-none text-sm font-bold",value:R.title||"",onChange:v=>Te("title",tr(v.target.value,180)),placeholder:S("bookForm.title")})]}),n.jsxs("div",{className:"space-y-1",children:[n.jsx("label",{className:"text-[10px] font-bold text-gray-400 uppercase ml-1",children:S("bookForm.author")}),n.jsx("input",{required:!0,maxLength:140,className:"w-full bg-gray-50 p-3 rounded-2xl outline-none focus:ring-2 focus:ring-indigo-500 border-none text-sm font-bold",value:R.author||"",onChange:v=>Te("author",tr(v.target.value,140)),placeholder:S("bookForm.author")})]})]})]}),n.jsxs("div",{className:"space-y-1",children:[n.jsx("label",{className:"text-[10px] font-bold text-gray-400 uppercase ml-1",children:S("bookForm.coverUrl")}),n.jsx("input",{maxLength:1024,className:"w-full bg-gray-50 p-3 rounded-2xl outline-none focus:ring-2 focus:ring-indigo-500 border-none text-xs font-medium",value:R.coverUrl||R.coverBlob&&ce||"",onChange:v=>{const w=tr(v.target.value,1024);J(N=>({...N,coverUrl:w,coverBlob:void 0}))},placeholder:S("bookForm.coverUrlPlaceholder")})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsxs("div",{ref:je,className:"space-y-1 relative",children:[n.jsx("label",{className:"text-[10px] font-bold text-gray-400 uppercase ml-1",children:S("bookForm.publisher")}),n.jsx("input",{maxLength:120,className:"w-full bg-gray-50 p-3 rounded-2xl outline-none focus:ring-2 focus:ring-indigo-500 border-none text-xs font-bold",value:R.publisher||"",onChange:v=>Te("publisher",tr(v.target.value,120)),onFocus:()=>Z(!0)}),X&&Ye.length>0&&n.jsx("div",{className:"absolute left-0 right-0 top-full mt-1 bg-white border border-gray-100 rounded-xl shadow-xl z-30 max-h-48 overflow-y-auto overscroll-contain",style:{WebkitOverflowScrolling:"touch",touchAction:"pan-y"},children:Ye.map(v=>n.jsx("button",{type:"button",onClick:()=>{Te("publisher",v),Z(!1)},className:"w-full text-left px-3 py-2 text-xs font-bold text-gray-700 hover:bg-gray-50 border-b border-gray-50 last:border-none",children:v},v))})]}),n.jsxs("div",{ref:de,className:"space-y-1 relative",children:[n.jsx("label",{className:"text-[10px] font-bold text-gray-400 uppercase ml-1",children:S("bookForm.genre")}),n.jsx("input",{maxLength:160,className:"w-full bg-gray-50 p-3 rounded-2xl outline-none focus:ring-2 focus:ring-indigo-500 border-none text-xs font-bold",value:R.genre||"",onChange:v=>Te("genre",tr(v.target.value,160)),onFocus:()=>oe(!0)}),te&&We.length>0&&n.jsx("div",{className:"absolute left-0 right-0 top-full mt-1 bg-white border border-gray-100 rounded-xl shadow-xl z-30 max-h-48 overflow-y-auto overscroll-contain",style:{WebkitOverflowScrolling:"touch",touchAction:"pan-y"},children:We.map(v=>n.jsx("button",{type:"button",onClick:()=>{Te("genre",v),oe(!1)},className:"w-full text-left px-3 py-2 text-xs font-bold text-gray-700 hover:bg-gray-50 border-b border-gray-50 last:border-none",children:v},v))})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsxs("div",{className:"space-y-1",children:[n.jsx("label",{className:"text-[10px] font-bold text-gray-400 uppercase ml-1",children:S("bookForm.series")}),n.jsx("input",{maxLength:120,className:"w-full bg-gray-50 p-3 rounded-2xl outline-none focus:ring-2 focus:ring-indigo-500 border-none text-xs font-bold",value:R.series||"",onChange:v=>Te("series",tr(v.target.value,120))})]}),n.jsxs("div",{className:"space-y-1",children:[n.jsx("label",{className:"text-[10px] font-bold text-gray-400 uppercase ml-1",children:S("bookForm.seriesPart")}),n.jsx("input",{maxLength:60,className:"w-full bg-gray-50 p-3 rounded-2xl outline-none focus:ring-2 focus:ring-indigo-500 border-none text-xs font-bold",value:R.seriesPart||"",onChange:v=>Te("seriesPart",tr(v.target.value,60))})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsxs("div",{className:"space-y-1",children:[n.jsx("label",{className:"text-[10px] font-bold text-gray-400 uppercase ml-1",children:S("bookForm.pages")}),n.jsx("input",{type:"number",inputMode:"numeric",min:0,className:"w-full bg-gray-50 p-3 rounded-2xl outline-none focus:ring-2 focus:ring-indigo-500 border-none text-xs font-bold",value:Number(R.pagesTotal)||0,onChange:v=>Te("pagesTotal",Math.max(0,Number(v.target.value)||0))})]}),n.jsxs("div",{className:"space-y-1",children:[n.jsx("label",{className:"text-[10px] font-bold text-gray-400 uppercase ml-1",children:S("bookForm.status")}),n.jsx("select",{className:"w-full bg-gray-50 p-3 rounded-2xl outline-none focus:ring-2 focus:ring-indigo-500 border-none text-xs font-bold",value:R.status||y[0],onChange:v=>Te("status",v.target.value),children:y.map(v=>n.jsx("option",{value:v,children:S(`status.${v}`)},v))})]})]}),R.status==="Completed"&&n.jsxs("div",{className:"grid grid-cols-2 gap-3 animate-in fade-in slide-in-from-top-1",children:[n.jsxs("div",{className:"space-y-1",children:[n.jsx("label",{className:"text-[10px] font-bold text-gray-400 uppercase ml-1",children:S("details.completed")}),n.jsx("input",{type:"date",className:"w-full bg-gray-50 p-3 rounded-2xl text-xs font-bold border-none outline-none",value:R.completedAt?R.completedAt.substring(0,10):"",onChange:v=>Te("completedAt",v.target.value?new Date(v.target.value).toISOString():void 0)})]}),n.jsxs("div",{className:"space-y-1",children:[n.jsx("label",{className:"text-[10px] font-bold text-gray-400 uppercase ml-1",children:S("details.rating")}),n.jsxs("select",{className:"w-full bg-gray-50 p-3 rounded-2xl text-xs font-bold border-none outline-none appearance-none",value:R.rating||0,onChange:v=>Te("rating",parseInt(v.target.value)),children:[n.jsx("option",{value:0,children:S("common.unknown")}),[10,9,8,7,6,5,4,3,2,1].map(v=>n.jsx("option",{value:v,children:v},v))]})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx("label",{className:"text-[10px] font-bold text-gray-400 uppercase ml-1",children:S("bookForm.seasons")}),n.jsx("div",{className:"grid grid-cols-2 gap-2",children:Sc.map(v=>{const w=Ma(R.seasons).includes(v);return n.jsxs("button",{type:"button",onClick:()=>G(v),className:`px-3 py-2 rounded-xl text-xs font-bold border transition-all flex items-center justify-between ${w?"border-indigo-200 bg-indigo-50":"bg-gray-50 text-gray-600 border-gray-100"}`,children:[n.jsx("span",{className:`px-2 py-0.5 rounded-full ${uo(v)}`,children:S(`season.${v}`)}),n.jsx("span",{className:`w-3 h-3 rounded-full border-2 ${w?"border-indigo-600 bg-indigo-600":"border-gray-300 bg-transparent"}`})]},v)})})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx("label",{className:"text-[10px] font-bold text-gray-400 uppercase ml-1",children:S("bookForm.formats")}),n.jsx("div",{className:"grid grid-cols-2 gap-2",children:Object.keys(Jn).map(v=>{const w=Oa(R.formats).includes(v);return n.jsxs("button",{type:"button",onClick:()=>ae(v),className:`px-3 py-2 rounded-xl text-xs font-bold border transition-all flex items-center justify-between ${w?"border-indigo-200 bg-indigo-50 text-indigo-700":"bg-gray-50 text-gray-600 border-gray-100"}`,children:[n.jsx("span",{children:S(`format.${v}`)}),n.jsx("span",{className:`w-3 h-3 rounded-full border-2 ${w?"border-indigo-600 bg-indigo-600":"border-gray-300 bg-transparent"}`})]},v)})})]}),n.jsxs("div",{className:"space-y-1",children:[n.jsx("label",{className:"text-[10px] font-bold text-gray-400 uppercase ml-1",children:S("bookForm.notes")}),n.jsx("input",{maxLength:80,className:"w-full bg-gray-50 p-3 rounded-2xl outline-none focus:ring-2 focus:ring-indigo-500 border-none text-xs font-medium",value:R.notes||"",onChange:v=>{const w=v.target.value;try{const N=w.replace(/[^\p{Extended_Pictographic}\s]/gu,"");Te("notes",N)}catch{Te("notes",w)}},placeholder:S("bookForm.notesPlaceholder")})]}),n.jsxs("div",{className:"space-y-1",children:[n.jsx("label",{className:"text-[10px] font-bold text-gray-400 uppercase ml-1",children:S("bookForm.comment")}),n.jsx("textarea",{maxLength:2e3,className:"w-full bg-gray-50 p-3 rounded-2xl outline-none focus:ring-2 focus:ring-indigo-500 border-none text-xs font-medium resize-none h-24",value:R.comment||"",onChange:v=>Te("comment",tr(v.target.value,2e3))})]}),n.jsxs("button",{type:"submit",disabled:V,onClick:()=>Ge(),className:"w-full bg-indigo-600 text-white py-4 rounded-2xl font-bold shadow-lg shadow-indigo-100 mt-2 active:scale-95 transition-all flex items-center justify-center gap-2 disabled:opacity-60",children:[n.jsx(Ka,{size:18}),n.jsx("span",{children:p})]})]})]})]})},Lg=({publisherSuggestions:i,genreSuggestions:p,onAdd:f,onCancel:x})=>{const{t:C}=Rs();return n.jsx(Kp,{title:C("bookForm.addBookTitle"),submitLabel:C("bookForm.addBookSubmit"),initialValue:{status:"Unread",formats:["Paper"],seasons:[]},publisherSuggestions:i,genreSuggestions:p,allowedStatuses:["Unread","Reading","Completed","Wishlist"],onCancel:x,onSubmit:y=>{const _=new Date().toISOString(),E=y.status||"Unread",S=Math.max(0,Number(y.pagesTotal)||0),L=E==="Completed",R=E==="Reading",J={id:fn(),title:y.title||"",author:y.author||"",formats:y.formats||["Paper"],status:E,isbn:y.isbn||"",genre:y.genre||"",seasons:y.seasons||[],publisher:y.publisher||"",series:y.series||"",seriesPart:y.seriesPart||"",coverUrl:y.coverUrl||"",pagesTotal:S,pagesRead:L?S:0,notes:y.notes||"",comment:y.comment||"",addedAt:_,readingStartedAt:R||L?_:void 0,completedAt:L?_:void 0,sessions:[]};f(J)}})},Og=({onAdd:i,onCancel:p})=>{const{t:f}=Rs(),{toast:x}=Yo(),[C,y]=Nr.useState(""),[_,E]=Nr.useState(""),[S,L]=Nr.useState(""),[R,J]=Nr.useState(!1),[V,se]=Nr.useState(!1),he=Nr.useMemo(()=>({id:"__wishlist_preview__",title:C||f("bookForm.preview"),author:_||"",formats:["Paper"],status:"Wishlist",genre:"",publisher:"",series:"",seriesPart:"",pagesTotal:0,pagesRead:0,coverUrl:S.trim(),addedAt:new Date().toISOString(),sessions:[]}),[_,S,f,C]),fe=async()=>{const X=C.trim(),Z=_.trim();if(!X){x.show(f("bookForm.toast.coverNeedTitle"),"info");return}se(!0);try{const te=await Qo(X,Z);te?(L(te),x.show(f("bookForm.toast.coverFound"),"success")):x.show(f("bookForm.toast.coverNotFound"),"info")}catch(te){console.error("Cover search failed",te),x.show(f("bookForm.toast.coverSearchError"),"error")}finally{se(!1)}};return n.jsxs("div",{className:"h-[100dvh] overflow-y-auto overscroll-contain p-4 pb-24 text-gray-800",children:[n.jsx("button",{onClick:p,className:"flex items-center gap-2 text-gray-400 hover:text-gray-600 transition-colors",children:n.jsx("span",{className:"text-sm font-bold",children:f("common.back")})}),n.jsxs("div",{className:"mt-4 bg-white p-6 rounded-3xl shadow-sm border border-gray-100",children:[n.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:f("bookForm.addWishlistTitle")}),n.jsx("p",{className:"text-xs text-gray-500 mt-1",children:f("bookForm.addWishlistSubtitle")}),n.jsxs("form",{className:"mt-6 space-y-4",onSubmit:X=>{if(X.preventDefault(),!R&&!(!C.trim()||!_.trim())){J(!0);try{const Z=new Date().toISOString();i({id:fn(),title:C.trim(),author:_.trim(),formats:["Paper"],status:"Wishlist",genre:"",publisher:"",series:"",seriesPart:"",pagesTotal:0,pagesRead:0,coverUrl:S.trim(),addedAt:Z,sessions:[]})}finally{J(!1)}}},children:[n.jsx("div",{className:"flex justify-center",children:n.jsxs("div",{className:"relative w-24",children:[n.jsx("div",{className:"w-24 aspect-[2/3] bg-gray-50 rounded-2xl border border-gray-100 overflow-hidden shadow-sm",children:S.trim()?n.jsx(Or,{book:he,className:"w-full h-full",iconSize:20}):n.jsxs("div",{className:"w-full h-full flex flex-col items-center justify-center gap-1 text-gray-300",children:[n.jsx(vi,{size:22}),n.jsx("span",{className:"text-[9px] font-bold uppercase tracking-wide",children:f("bookForm.cover")})]})}),n.jsx("button",{type:"button",onClick:fe,disabled:R||V,className:"absolute top-0 -right-14 bg-white p-3 rounded-2xl text-indigo-600 shadow-lg border border-indigo-50 active:scale-95 transition-all disabled:opacity-50",title:f("bookForm.magicSearch"),"aria-label":f("bookForm.magicSearch"),children:V?n.jsx(Xr,{className:"animate-spin",size:20}):n.jsx(Wa,{size:20})})]})}),n.jsxs("div",{className:"space-y-1",children:[n.jsx("label",{className:"text-[10px] font-bold text-gray-400 uppercase ml-1",children:f("bookForm.title")}),n.jsx("input",{required:!0,maxLength:180,className:"w-full bg-gray-50 p-3 rounded-2xl outline-none focus:ring-2 focus:ring-indigo-500 border-none text-sm font-bold",value:C,onChange:X=>y(X.target.value)})]}),n.jsxs("div",{className:"space-y-1",children:[n.jsx("label",{className:"text-[10px] font-bold text-gray-400 uppercase ml-1",children:f("bookForm.author")}),n.jsx("input",{required:!0,maxLength:140,className:"w-full bg-gray-50 p-3 rounded-2xl outline-none focus:ring-2 focus:ring-indigo-500 border-none text-sm font-bold",value:_,onChange:X=>E(X.target.value)})]}),n.jsxs("div",{className:"space-y-1",children:[n.jsx("label",{className:"text-[10px] font-bold text-gray-400 uppercase ml-1",children:f("bookForm.coverUrl")}),n.jsx("input",{maxLength:1024,className:"w-full bg-gray-50 p-3 rounded-2xl outline-none focus:ring-2 focus:ring-indigo-500 border-none text-xs font-medium",value:S,onChange:X=>L(X.target.value),placeholder:f("bookForm.coverUrlPlaceholder")})]}),n.jsx("button",{type:"submit",disabled:R,className:"w-full bg-indigo-600 text-white py-4 rounded-2xl font-bold shadow-lg shadow-indigo-100 mt-2 active:scale-95 transition-all disabled:opacity-60",children:f("bookForm.saveWishlist")})]})]})]})},Mg=({book:i,publisherSuggestions:p,genreSuggestions:f,onSave:x,onCancel:C})=>{const{t:y}=Rs();return n.jsx(Kp,{title:y("bookForm.editBookTitle"),submitLabel:y("bookForm.saveSubmit"),initialValue:i,publisherSuggestions:p,genreSuggestions:f,allowedStatuses:["Unread","Reading","Completed","Wishlist"],onCancel:C,onSubmit:_=>{const E={...i,..._,id:i.id,addedAt:i.addedAt,sessions:_.sessions||i.sessions||[],updatedAt:new Date().toISOString()};if(E.status==="Completed"){E.completedAt||(E.completedAt=new Date().toISOString());const S=$r(E),L=E.sessions||[],R=L.reduce((J,V)=>J+V.pages,0);if(R<S&&S>0){const J=S-R,V=Math.round(J*72),se=E.completedAt.split("T")[0];E.sessions=[...L,{id:fn(),date:se,duration:V,pages:J}]}(!E.pagesRead||E.pagesRead<S)&&S>0&&(E.pagesRead=S)}x(E)}})},Qu=(i,p,f)=>{if(!i)return f;const x=new Date(i);return Number.isNaN(x.getTime())?f:x.toLocaleDateString(p)},Fg=({book:i,onBack:p,onEdit:f,onDelete:x,onStartReadingWishlist:C,onOpenReadingMode:y,onTagClick:_,isBusy:E=!1})=>{const{t:S,locale:L}=Rs(),R=i.status==="Wishlist",J=$r(i),V=Ho(i.pagesRead,J),se=S("common.unknown"),he=Z=>{const te=(Z||"").trim();!te||E||_==null||_(te)},fe=Z=>S(`status.${Z}`),X=Z=>S(`format.${Z}`);return n.jsxs("div",{className:"h-[100dvh] overflow-y-auto overscroll-contain p-4 pb-24 text-gray-800 space-y-4",children:[n.jsxs("button",{onClick:p,disabled:E,className:"flex items-center gap-2 text-gray-400 hover:text-gray-600 transition-colors disabled:opacity-50",children:[n.jsx(Ua,{size:20}),n.jsx("span",{className:"text-sm font-bold",children:S("common.back")})]}),n.jsxs("div",{className:"bg-white rounded-3xl border border-gray-100 shadow-sm overflow-hidden",children:[n.jsx("div",{className:"p-5 border-b border-gray-100",children:n.jsxs("div",{className:"flex gap-5",children:[n.jsx("div",{className:"w-32 aspect-[2/3] rounded-xl border border-gray-100 overflow-hidden bg-gray-50 flex-shrink-0 shadow-lg",children:n.jsx(Or,{book:i,className:"w-full h-full",iconSize:32})}),n.jsxs("div",{className:"min-w-0 flex-1 flex flex-col justify-end",children:[R?n.jsxs("button",{onClick:C,disabled:E,className:"w-full bg-indigo-600 text-white py-2.5 rounded-xl font-bold flex items-center justify-center gap-2 mb-3 shadow-lg shadow-indigo-200 active:scale-95 transition-all disabled:opacity-60",children:[n.jsx(Sr,{size:16}),n.jsx("span",{className:"text-xs",children:S("details.startReading")})]}):n.jsxs("button",{onClick:y,disabled:E,className:"w-full bg-indigo-600 text-white py-2.5 rounded-xl font-bold flex items-center justify-center gap-2 mb-3 shadow-lg shadow-indigo-200 active:scale-95 transition-all disabled:opacity-60",children:[n.jsx(Sr,{size:16}),n.jsx("span",{className:"text-xs",children:S("details.openReading")})]}),n.jsx("div",{className:"mb-2",children:n.jsx("span",{className:`inline-block w-fit px-2.5 py-1 rounded-lg text-[10px] font-bold uppercase tracking-wider ${i.status==="Completed"?"bg-emerald-50 text-emerald-600":i.status==="Wishlist"?"bg-pink-50 text-pink-600":"bg-indigo-50 text-indigo-600"}`,children:fe(i.status)})}),n.jsx("h1",{className:"text-xl font-bold text-gray-800 leading-tight line-clamp-3",children:i.title}),i.author?n.jsx("button",{type:"button",onClick:()=>he(i.author),disabled:E,className:"text-sm font-medium text-gray-500 mt-1 truncate hover:text-indigo-600 transition-colors text-left active:scale-95",children:i.author}):n.jsx("p",{className:"text-sm text-gray-500 mt-1",children:se})]})]})}),n.jsxs("div",{className:"p-5 space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsxs("button",{type:"button",onClick:()=>he(i.publisher),disabled:!i.publisher||E,className:"bg-gray-50 p-3 rounded-2xl border border-gray-100 flex items-center gap-3 text-left disabled:opacity-70",children:[n.jsx(xi,{size:16,className:"text-gray-400"}),n.jsxs("div",{className:"min-w-0",children:[n.jsx("p",{className:"text-[10px] text-gray-400 uppercase font-bold",children:S("details.publisher")}),n.jsx("p",{className:"text-xs font-bold text-gray-700 truncate",children:i.publisher||se})]})]}),n.jsxs("button",{type:"button",onClick:()=>he(i.genre),disabled:!i.genre||E,className:"bg-gray-50 p-3 rounded-2xl border border-gray-100 flex items-center gap-3 text-left disabled:opacity-70",children:[n.jsx(up,{size:16,className:"text-gray-400"}),n.jsxs("div",{className:"min-w-0",children:[n.jsx("p",{className:"text-[10px] text-gray-400 uppercase font-bold",children:S("details.genre")}),n.jsx("p",{className:"text-xs font-bold text-gray-700 truncate",children:i.genre||se})]})]}),n.jsxs("button",{type:"button",onClick:()=>{var Z;return he((Z=i.seasons)==null?void 0:Z.join(", "))},disabled:!i.seasons||i.seasons.length===0||E,className:"col-span-2 bg-gray-50 p-3 rounded-2xl border border-gray-100 flex items-center gap-3 text-left disabled:opacity-70",children:[n.jsx(Ia,{size:16,className:"text-gray-400"}),n.jsxs("div",{className:"min-w-0",children:[n.jsx("p",{className:"text-[10px] text-gray-400 uppercase font-bold",children:S("details.seasons")}),i.seasons&&i.seasons.length>0?n.jsx("div",{className:"flex flex-wrap gap-1.5 mt-1",children:i.seasons.map(Z=>n.jsx("span",{className:`text-[10px] px-2 py-0.5 rounded-full font-bold ${uo(Z)}`,children:S(`season.${Zn(Z)}`)},Z))}):n.jsx("p",{className:"text-xs font-bold text-gray-700",children:se})]})]}),n.jsxs("button",{type:"button",onClick:()=>he(i.series),disabled:!i.series||E,className:"col-span-2 bg-gray-50 p-3 rounded-2xl border border-gray-100 flex items-center gap-3 text-left disabled:opacity-70",children:[n.jsx(mc,{size:16,className:"text-gray-400"}),n.jsxs("div",{className:"min-w-0 flex-1 flex justify-between items-center gap-2",children:[n.jsxs("div",{className:"min-w-0",children:[n.jsx("p",{className:"text-[10px] text-gray-400 uppercase font-bold",children:S("details.series")}),n.jsx("p",{className:"text-xs font-bold text-gray-700 truncate",children:i.series||se})]}),i.seriesPart&&n.jsxs("div",{className:"bg-white px-2 py-1 rounded-lg border border-gray-200 text-[10px] font-black text-indigo-600",children:["#",i.seriesPart]})]})]})]}),n.jsxs("div",{className:"bg-gray-50 p-4 rounded-2xl border border-gray-100 space-y-2",children:[n.jsxs("div",{className:"flex justify-between items-center border-b border-gray-200 pb-2",children:[n.jsx("span",{className:"text-[10px] font-bold text-gray-400 uppercase",children:S("details.status")}),n.jsx("span",{className:`text-xs font-bold ${i.status==="Completed"?"text-emerald-600":i.status==="Wishlist"?"text-pink-600":"text-indigo-600"}`,children:fe(i.status)})]}),(i.rating||0)>0&&n.jsxs("div",{className:"flex justify-between items-center border-b border-gray-200 pb-2",children:[n.jsx("span",{className:"text-[10px] font-bold text-gray-400 uppercase",children:S("details.rating")}),n.jsxs("span",{className:"text-xs font-black px-2 py-0.5 rounded bg-white border border-gray-100 shadow-sm",style:{color:Ap(i.rating||0)},children:[i.rating,"/10"]})]}),n.jsxs("div",{className:"flex justify-between items-center border-b border-gray-200 pb-2",children:[n.jsx("span",{className:"text-[10px] font-bold text-gray-400 uppercase",children:S("details.pages")}),n.jsx("span",{className:"text-xs font-bold text-gray-700",children:J||se})]}),n.jsxs("div",{className:"flex justify-between items-center border-b border-gray-200 pb-2",children:[n.jsx("span",{className:"text-[10px] font-bold text-gray-400 uppercase",children:S("details.added")}),n.jsx("span",{className:"text-xs font-bold text-gray-700",children:Qu(i.addedAt,L,se)})]}),n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("span",{className:"text-[10px] font-bold text-gray-400 uppercase",children:S("details.formats")}),n.jsx("span",{className:"text-xs font-bold text-gray-700 text-right",children:(i.formats||[]).map(Z=>X(Z)).join(", ")||se})]})]}),i.status==="Completed"?n.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[n.jsxs("div",{className:"bg-emerald-50/50 p-3 rounded-2xl border border-emerald-100 flex flex-col items-center",children:[n.jsx($a,{size:16,className:"text-emerald-500 mb-1"}),n.jsx("span",{className:"text-[10px] font-bold text-emerald-400 uppercase text-center",children:S("details.completed")}),n.jsx("span",{className:"text-[11px] font-bold text-emerald-700",children:Qu(i.completedAt,L,se)})]}),n.jsxs("div",{className:"bg-indigo-50/50 p-3 rounded-2xl border border-indigo-100 flex flex-col items-center",children:[n.jsx(io,{size:16,className:"text-indigo-500 mb-1"}),n.jsx("span",{className:"text-[10px] font-bold text-indigo-400 uppercase",children:S("details.time")}),n.jsxs("span",{className:"text-[11px] font-bold text-indigo-700",children:[Lp(i)," ",S("details.unit.minutes")]})]}),n.jsxs("div",{className:"bg-amber-50/50 p-3 rounded-2xl border border-amber-100 flex flex-col items-center",children:[n.jsx(bc,{size:16,className:"text-amber-500 mb-1"}),n.jsx("span",{className:"text-[10px] font-bold text-amber-400 uppercase",children:S("details.speed")}),n.jsxs("span",{className:"text-[11px] font-bold text-amber-700",children:[Cc(i)," ",S("details.unit.pagesPerHour")]})]})]}):R?n.jsxs("div",{className:"bg-pink-50/50 p-4 rounded-3xl border border-pink-100 flex items-center gap-3",children:[n.jsx("div",{className:"p-2 bg-pink-100 rounded-full text-pink-500",children:n.jsx(Ia,{size:20})}),n.jsxs("div",{children:[n.jsx("p",{className:"text-[10px] font-bold text-pink-400 uppercase",children:S("details.inWishlistSince")}),n.jsx("p",{className:"text-xs font-bold text-pink-700",children:Qu(i.addedAt,L,se)})]})]}):n.jsxs("div",{className:"bg-gray-50 p-4 rounded-3xl border border-gray-100",children:[n.jsxs("div",{className:"flex justify-between items-center mb-2",children:[n.jsx("h4",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-widest",children:S("details.progress")}),n.jsxs("span",{className:"text-xs font-bold text-indigo-600",children:[V,"%"]})]}),n.jsx("div",{className:"w-full h-2 bg-gray-200 rounded-full overflow-hidden",children:n.jsx("div",{className:"h-full bg-indigo-600 transition-all duration-500",style:{width:`${V}%`}})})]}),(i.notes||i.comment)&&n.jsxs("div",{className:"space-y-3 pt-1",children:[i.notes&&n.jsxs("div",{className:"bg-gray-50 p-4 rounded-3xl border border-gray-100",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx(ip,{size:14,className:"text-gray-400"}),n.jsx("span",{className:"text-[10px] font-bold text-gray-400 uppercase",children:S("details.notes")})]}),n.jsx("div",{className:"text-xl tracking-wide leading-relaxed text-gray-800",children:i.notes})]}),i.comment&&n.jsxs("div",{className:"bg-gray-50 p-4 rounded-3xl border border-gray-100",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx(sp,{size:14,className:"text-gray-400"}),n.jsx("span",{className:"text-[10px] font-bold text-gray-400 uppercase",children:S("details.comment")})]}),n.jsx("p",{className:"text-sm text-gray-700 whitespace-pre-wrap break-words leading-relaxed",children:i.comment})]})]}),n.jsx("div",{className:"space-y-2 pt-1",children:n.jsxs("div",{className:"flex gap-2",children:[n.jsxs("button",{onClick:f,disabled:E,className:"flex-1 bg-gray-100 text-gray-700 py-3 rounded-2xl font-bold flex items-center justify-center gap-2 disabled:opacity-60",children:[n.jsx(im,{size:16}),n.jsx("span",{children:S("common.edit")})]}),n.jsx("button",{onClick:x,disabled:E,className:"w-12 bg-red-50 text-red-600 py-3 rounded-2xl font-bold flex items-center justify-center disabled:opacity-60","aria-label":S("details.deleteAria"),children:n.jsx(Va,{size:16})})]})})]})]})]})},zg=({format:i})=>{switch(i){case"Paper":return n.jsx(Sr,{size:14});case"Audio":return n.jsx(yi,{size:14});case"E-book":return n.jsx(bi,{size:14});case"Pirate":return n.jsx(rp,{size:14});case"Expected":return n.jsx(io,{size:14});case"Sold":return n.jsx(lp,{size:14});default:return null}},Ig=({status:i})=>i==="Completed"?n.jsx("span",{className:"w-6 h-6 rounded-lg border border-emerald-100 bg-emerald-50 text-emerald-600 flex items-center justify-center",children:n.jsx(vc,{size:13})}):i==="Reading"?n.jsx("span",{className:"w-6 h-6 rounded-lg border border-amber-100 bg-amber-50 text-amber-600 flex items-center justify-center",children:n.jsx(Jf,{size:13})}):n.jsx("span",{className:"w-6 h-6 rounded-lg border border-gray-200 bg-gray-50 text-gray-500 flex items-center justify-center",children:n.jsx(di,{size:13})}),Bg=({book:i,onOpen:p,reorderMode:f=!1,canMoveUp:x=!1,canMoveDown:C=!1,onMoveUp:y,onMoveDown:_})=>{const{t:E}=Rs();return n.jsxs("div",{className:"w-full bg-white p-4 rounded-3xl shadow-sm border border-gray-100 flex gap-3 items-center",children:[n.jsxs("button",{type:"button",onClick:()=>p(i),disabled:f,className:"min-w-0 flex-1 text-left flex gap-4 items-center disabled:cursor-default active:scale-[0.99] transition-transform cursor-pointer select-none",children:[n.jsx("div",{className:"w-12 h-16 bg-gray-50 rounded-xl overflow-hidden flex-shrink-0 border border-gray-100",children:n.jsx(Or,{book:i,className:"w-full h-full",iconSize:18})}),n.jsxs("div",{className:"min-w-0 flex-1",children:[n.jsx("div",{className:"flex items-center gap-2 min-w-0",children:n.jsx("h3",{className:"font-bold text-gray-800 text-sm truncate",children:i.title})}),n.jsx("p",{className:"text-[11px] text-gray-500 truncate",children:i.author}),i.seasons&&i.seasons.length>0&&n.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:i.seasons.map(S=>n.jsx("span",{className:`text-[9px] px-1.5 py-0.5 rounded-full font-bold ${uo(S)}`,children:E(`season.${Zn(S)}`)},S))}),n.jsxs("div",{className:"flex gap-2 mt-1.5 items-center min-w-0",children:[i.formats.map(S=>n.jsx("span",{className:S==="Sold"?"text-red-500":"text-gray-400",children:n.jsx(zg,{format:S})},S)),i.notes&&n.jsx("span",{className:"text-[13px] leading-none truncate max-w-[110px] text-gray-700",children:i.notes}),(i.rating||0)>0&&n.jsxs("span",{className:"text-[10px] font-black px-1.5 py-0.5 bg-gray-50 rounded text-gray-600 flex-shrink-0 inline-flex items-center gap-1",children:[n.jsx(hm,{size:10}),n.jsx("span",{children:i.rating})]})]})]})]}),f?n.jsxs("div",{className:"flex flex-col gap-1",children:[n.jsx("button",{type:"button",onClick:y,disabled:!x,className:"w-8 h-8 rounded-lg border border-gray-200 bg-white text-gray-600 disabled:opacity-30 flex items-center justify-center","aria-label":"Move up",children:n.jsx(Zh,{size:14})}),n.jsx("button",{type:"button",onClick:_,disabled:!C,className:"w-8 h-8 rounded-lg border border-gray-200 bg-white text-gray-600 disabled:opacity-30 flex items-center justify-center","aria-label":"Move down",children:n.jsx(Jh,{size:14})})]}):n.jsx("span",{className:"flex-shrink-0","aria-label":`status-${i.status}`,children:n.jsx(Ig,{status:i.status})})]})},ii=["Reading","Unread","Completed"],Yu=["Paper","E-book","Audio","Pirate","Expected"],Ug=["Paper","E-book","Audio","Pirate","Expected","Sold"],Gu="library_sort_prefs",Xu="wishlist_sort_prefs",Qf=i=>i==="addedAt"||i==="title"||i==="author"||i==="genre"||i==="custom"?i:"addedAt",Yf=i=>i==="asc"||i==="desc"?i:"desc",Ju={library:0,wishlist:0},Gf=(i,p)=>i.length===p.length&&i.every(f=>p.includes(f)),ao=(i,p,f="en-US")=>(i||"").trim().toLowerCase().localeCompare((p||"").trim().toLowerCase(),f),$g=(i,p,f="en-US")=>{const x=Number((i||"").replace(",",".")),C=Number((p||"").replace(",",".")),y=Number.isFinite(x),_=Number.isFinite(C);return y&&_?x-C:y?-1:_?1:ao(i,p,f)},Xf=({onNavigateToReading:i})=>{const{t:p,locale:f}=Rs(),{books:x,addBook:C,updateBook:y,deleteBook:_,reorderBooks:E,filterTag:S,setFilterTag:L}=pn(),{toast:R,confirm:J}=Yo(),[V,se]=j.useState({kind:"list",tab:"library"}),he=j.useCallback(W=>{se(ne=>{const Fe=typeof W=="function"?W(ne):W;return ne.kind==="list"&&(Fe.kind!=="list"||ne.tab!==Fe.tab)&&(Ju[ne.tab]=window.scrollY),Fe})},[]);j.useEffect(()=>{if(V.kind==="list"){const W=Ju[V.tab];W>0?setTimeout(()=>{window.scrollTo(0,W)},10):window.scrollTo(0,0)}else window.scrollTo(0,0)},[V]);const fe=j.useRef(V);j.useEffect(()=>{fe.current=V},[V]),j.useEffect(()=>()=>{fe.current.kind==="list"&&(Ju[fe.current.tab]=window.scrollY)},[]);const[X,Z]=j.useState(!1),[te,oe]=j.useState(!1),[ce,ie]=j.useState(!1),[je,de]=j.useState({library:"",wishlist:""}),[Pe,Be]=j.useState(ii),[Ye,We]=j.useState(Yu),[Ge,Te]=j.useState(""),[et,lt]=j.useState(""),[it,ae]=j.useState(!1),[G,T]=j.useState(!1),v=j.useRef(null),w=j.useRef(null),N=j.useRef(null);j.useEffect(()=>{const W=ne=>{ce&&v.current&&!v.current.contains(ne.target)&&ie(!1),it&&w.current&&!w.current.contains(ne.target)&&ae(!1),G&&N.current&&!N.current.contains(ne.target)&&T(!1)};return document.addEventListener("mousedown",W),document.addEventListener("touchstart",W),()=>{document.removeEventListener("mousedown",W),document.removeEventListener("touchstart",W)}},[ce,it,G]);const[re,pe]=j.useState(()=>{const W=qo(Gu),ne=qo(Xu);return{library:Qf(W.key),wishlist:Qf(ne.key)}}),[be,Oe]=j.useState(()=>{const W=qo(Gu),ne=qo(Xu);return{library:Yf(W.direction),wishlist:Yf(ne.direction)}}),[Ke,qe]=j.useState({library:!1,wishlist:!1}),[tt,Se]=j.useState(!1),Ht=j.useCallback(W=>p(`status.${W}`),[p]),ct=j.useCallback(W=>p(`format.${W}`),[p]),Mt=j.useMemo(()=>x.filter(W=>W.status!=="Wishlist"),[x]),fr=j.useMemo(()=>x.filter(W=>W.status==="Wishlist"),[x]),Me=V.tab,Vt=je[Me],Cr=Me==="library"?Mt:fr,Mr=j.useMemo(()=>{const W=Vt.trim().toLowerCase();return Cr.filter(ne=>{if(Me==="library"){if(Pe.length>0&&!Pe.includes(ne.status)||Ye.length>0&&!ne.formats.some(st=>Ye.includes(st)))return!1;const ue=Ge.trim().toLowerCase();if(ue&&!(ne.publisher||"").toLowerCase().includes(ue))return!1;const ut=et.trim().toLowerCase();if(ut&&!(ne.genre||"").toLowerCase().includes(ut))return!1}return W?[ne.title,ne.author,ne.genre||"",ne.publisher||"",ne.series||"",ne.seriesPart||""].join(" ").toLowerCase().includes(W):!0})},[Me,et,Ge,Vt,Ye,Pe,Cr]),_r=j.useMemo(()=>{const W=re[Me],ne=be[Me];if(W==="custom")return ne==="asc"?[...Mr]:[...Mr].reverse();const Fe=[...Mr];return Fe.sort((ue,ut)=>{if(W==="addedAt"){const st=Date.parse(ue.addedAt||""),Rt=Date.parse(ut.addedAt||"");return(Number.isFinite(st)?st:0)-(Number.isFinite(Rt)?Rt:0)}if(W==="author")return ao(ue.author,ut.author,f);if(W==="genre"){const st=!!(ue.genre||"").trim(),Rt=!!(ut.genre||"").trim();if(st!==Rt)return st?-1:1;const Wt=ao(ue.genre,ut.genre,f)||ao(ue.author,ut.author,f)||ao(ue.series,ut.series,f)||$g(ue.seriesPart,ut.seriesPart,f)||ao(ue.title,ut.title,f);return ne==="asc"?Wt:-Wt}return ao(ue.title,ut.title,f)}),ne==="asc"?Fe:Fe.reverse()},[Me,Mr,f,be,re]),Xt=j.useMemo(()=>{const W=new Set;return x.forEach(ne=>{ne.publisher&&ne.publisher.trim()&&W.add(ne.publisher.trim())}),Array.from(W).sort((ne,Fe)=>ne.localeCompare(Fe,f))},[x,f]),Nt=j.useMemo(()=>{const W=new Set;return x.forEach(ne=>{const Fe=(ne.genre||"").trim();Fe&&W.add(Fe)}),Array.from(W).sort((ne,Fe)=>ne.localeCompare(Fe,f))},[x,f]),we=j.useCallback(W=>{he({kind:"list",tab:W})},[he]),Ze=j.useMemo(()=>{const W=Ge.trim().toLowerCase();return W?Xt.filter(ne=>ne.toLowerCase().includes(W)).slice(0,12):Xt.slice(0,12)},[Ge,Xt]),Ct=j.useMemo(()=>{const W=et.trim().toLowerCase();return W?Nt.filter(ne=>ne.toLowerCase().includes(W)).slice(0,12):Nt.slice(0,12)},[et,Nt]),ft=j.useMemo(()=>!Gf(Pe,ii)||!Gf(Ye,Yu)||Ge.trim().length>0||et.trim().length>0,[et,Ge,Ye,Pe]),rt=j.useCallback(W=>{Be(ne=>ne.includes(W)?ne.filter(Fe=>Fe!==W):[...ne,W])},[]),Ft=j.useCallback(W=>{We(ne=>ne.includes(W)?ne.filter(Fe=>Fe!==W):[...ne,W])},[]),Tt=j.useCallback(()=>{Be(ii),We(Yu),Te(""),lt(""),ae(!1),T(!1)},[]),Qt=j.useMemo(()=>{const W=Vt.trim().toLowerCase();if(W.length<2)return[];const ne=new Set;return Cr.forEach(Fe=>{const ue=(Fe.title||"").trim(),ut=(Fe.author||"").trim(),st=(Fe.publisher||"").trim(),Rt=(Fe.genre||"").trim();ue&&ue.toLowerCase().includes(W)&&ne.add(ue),ut&&ut.toLowerCase().includes(W)&&ne.add(ut),st&&st.toLowerCase().includes(W)&&ne.add(st),Rt&&Rt.toLowerCase().includes(W)&&ne.add(Rt)}),Array.from(ne).slice(0,8)},[Vt,Cr]),vt=j.useCallback(W=>{de(ne=>({...ne,[Me]:W})),Me==="library"&&W.trim().length===0&&L("")},[Me,L]),$t=j.useCallback(W=>{Ke[Me]&&qe(ne=>({...ne,[Me]:!1})),re[Me]===W?Oe(ne=>({...ne,[Me]:ne[Me]==="asc"?"desc":"asc"})):(pe(ne=>({...ne,[Me]:W})),Oe(ne=>({...ne,[Me]:W==="addedAt"?"desc":"asc"})))},[Me,Ke,re]),pr=re[Me]==="custom",Er=Ke[Me]&&pr&&Vt.trim().length===0,Re=j.useCallback(()=>{Vt.trim().length>0&&de(W=>({...W,[Me]:""})),Me==="library"&&ft&&Tt(),pe(W=>({...W,[Me]:"custom"})),Oe(W=>({...W,[Me]:"asc"})),qe(W=>({...W,[Me]:!W[Me]}))},[Tt,Me,ft,Vt]),nt=j.useCallback((W,ne)=>{if(tt)return;const Fe=Me==="library"?x.filter(Wt=>Wt.status!=="Wishlist"):x.filter(Wt=>Wt.status==="Wishlist"),ue=Fe.findIndex(Wt=>Wt.id===W);if(ue<0)return;const ut=ne==="up"?ue-1:ue+1;if(ut<0||ut>=Fe.length)return;const st=[...Fe];[st[ue],st[ut]]=[st[ut],st[ue]];const Rt=Me==="library"?[...st,...x.filter(Wt=>Wt.status==="Wishlist")]:[...x.filter(Wt=>Wt.status!=="Wishlist"),...st];try{E(Rt)}catch(Wt){console.error(Wt),R.show(p("library.failedReorder"),"error")}},[x,Me,tt,E,p,R]);j.useEffect(()=>{Vt.trim().length!==0&&Ke[Me]&&qe(W=>({...W,[Me]:!1}))},[Me,Ke,Vt]),j.useEffect(()=>{ft&&Ke.library&&qe(W=>({...W,library:!1}))},[ft,Ke.library]),j.useEffect(()=>{re[Me]!=="custom"&&Ke[Me]&&qe(W=>({...W,[Me]:!1}))},[Me,Ke,re]),j.useEffect(()=>{Me!=="library"&&(Z(!1),oe(!1),ae(!1),T(!1),ie(!1))},[Me]),j.useEffect(()=>{const W=S.trim();W&&(he(ne=>ne.kind==="list"&&ne.tab==="library"?ne:{kind:"list",tab:"library"}),de(ne=>ne.library===W?ne:{...ne,library:W}))},[S]),j.useEffect(()=>{mi(Gu,re.library,be.library)},[be.library,re.library]),j.useEffect(()=>{mi(Xu,re.wishlist,be.wishlist)},[be.wishlist,re.wishlist]);const Ce=j.useCallback((W,ne)=>{if(tt)return;Se(!0);let Fe={...W};if(Fe.status==="Completed"){Fe.completedAt||(Fe.completedAt=new Date().toISOString());const ue=$r(Fe);if((!Fe.pagesRead||Fe.pagesRead<ue)&&ue>0&&(Fe.pagesRead=ue),(!Fe.sessions||Fe.sessions.length===0)&&ue>0){const ut=Math.round(ue*72),st=Fe.completedAt.split("T")[0];Fe.sessions=[{id:fn(),date:st,duration:ut,pages:ue}]}}try{y(Fe),he({kind:"details",tab:ne,bookId:Fe.id}),R.show(p("library.saved"),"success")}catch(ue){console.error(ue),R.show(p("library.failedSave"),"error")}finally{Se(!1)}},[tt,p,R,y]);if(V.kind==="add")return V.tab==="library"?n.jsx(Lg,{publisherSuggestions:Xt,genreSuggestions:Nt,onAdd:W=>{if(!tt){Se(!0);try{C(W),R.show(p("library.bookAdded"),"success"),we("library")}catch(ne){console.error(ne),R.show(p("library.failedAddBook"),"error")}finally{Se(!1)}}},onCancel:()=>we("library")}):n.jsx(Og,{onAdd:W=>{if(!tt){Se(!0);try{C(W),R.show(p("library.wishlistAdded"),"success"),we("wishlist")}catch(ne){console.error(ne),R.show(p("library.failedAddWishlist"),"error")}finally{Se(!1)}}},onCancel:()=>we("wishlist")});if(V.kind==="details"){const W=x.find(ne=>ne.id===V.bookId);return W?n.jsx(Fg,{book:W,onBack:()=>we(V.tab),onOpenReadingMode:()=>he({kind:"reading",tab:V.tab,bookId:W.id}),onEdit:()=>he({kind:"edit",tab:V.tab,bookId:W.id}),onTagClick:ne=>{const Fe=(ne||"").trim();Fe&&(L(Fe),he({kind:"list",tab:"library"}))},onDelete:()=>{tt||(async()=>{if(await J({title:p("library.deleteTitle"),message:p("library.deleteMessage",{title:W.title}),type:"danger",confirmText:p("common.delete"),cancelText:p("common.cancel")})){Se(!0);try{_(W.id),R.show(p("library.bookDeleted"),"success"),we(V.tab)}catch(Fe){console.error(Fe),R.show(p("library.failedDelete"),"error")}finally{Se(!1)}}})()},onStartReadingWishlist:()=>{if(!tt){Se(!0);try{y({...W,status:"Reading",readingStartedAt:new Date().toISOString()}),R.show(p("library.movedToReading"),"success"),i?i():we("library")}catch(ne){console.error(ne),R.show(p("library.failedUpdateStatus"),"error")}finally{Se(!1)}}},isBusy:tt}):n.jsxs("div",{className:"p-4 pb-24 text-gray-800",children:[n.jsx("p",{className:"text-sm text-gray-500",children:p("library.bookNotFound")}),n.jsx("button",{className:"mt-3 px-3 py-2 rounded-xl bg-indigo-600 text-white text-sm font-bold",onClick:()=>we(V.tab),children:p("common.back")})]})}if(V.kind==="reading"){const W=x.find(ne=>ne.id===V.bookId);return W?n.jsx(ji,{book:W,onClose:()=>he({kind:"details",tab:V.tab,bookId:W.id})}):n.jsxs("div",{className:"p-4 pb-24 text-gray-800",children:[n.jsx("p",{className:"text-sm text-gray-500",children:p("library.bookNotFound")}),n.jsx("button",{className:"mt-3 px-3 py-2 rounded-xl bg-indigo-600 text-white text-sm font-bold",onClick:()=>we(V.tab),children:p("common.back")})]})}if(V.kind==="edit"){const W=x.find(ne=>ne.id===V.bookId);return W?n.jsx(Mg,{book:W,onCancel:()=>he({kind:"details",tab:V.tab,bookId:W.id}),onSave:ne=>Ce(ne,V.tab),publisherSuggestions:Xt,genreSuggestions:Nt}):n.jsxs("div",{className:"p-4 pb-24 text-gray-800",children:[n.jsx("p",{className:"text-sm text-gray-500",children:p("library.bookNotFound")}),n.jsx("button",{className:"mt-3 px-3 py-2 rounded-xl bg-indigo-600 text-white text-sm font-bold",onClick:()=>we(V.tab),children:p("common.back")})]})}return n.jsxs("div",{className:"px-4 pb-24 text-gray-800 space-y-4",children:[n.jsxs("div",{className:"sticky top-0 z-30 -mx-4 px-4 pt-0 pb-2 bg-slate-50/95 backdrop-blur-sm border-b border-gray-100 space-y-4",children:[n.jsxs("header",{className:"flex items-center gap-4",children:[n.jsx("button",{onClick:()=>we("library"),className:`text-3xl font-bold transition-colors ${Me==="library"?"text-gray-800":"text-gray-300"}`,children:p("library.tab.library")}),n.jsx("button",{onClick:()=>we("wishlist"),className:`text-3xl font-bold transition-colors ${Me==="wishlist"?"text-gray-800":"text-gray-300"}`,children:p("library.tab.wishlist")})]}),n.jsxs("div",{className:"flex gap-2 h-12",children:[n.jsx("button",{onClick:()=>he({kind:"add",tab:Me}),className:"h-12 w-12 flex-shrink-0 bg-indigo-600 text-white rounded-xl flex items-center justify-center shadow-lg shadow-indigo-200 active:scale-95 transition-all",title:p(Me==="library"?"library.addBook":"library.addWishlist"),children:n.jsx(xc,{size:24})}),n.jsxs("div",{ref:v,className:"relative flex-1",children:[n.jsx(yc,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:18}),n.jsx("input",{type:"text",placeholder:p("library.searchPlaceholder"),className:"w-full h-full pl-10 pr-10 bg-white rounded-xl border-none shadow-sm focus:ring-2 focus:ring-indigo-500 outline-none text-sm font-medium",value:Vt,onChange:W=>{vt(W.target.value),ie(!0)},onFocus:()=>ie(!0)}),Vt.length>0&&n.jsx("button",{type:"button",onClick:()=>{vt(""),ie(!1)},className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 p-1.5","aria-label":p("library.clearSearch"),children:n.jsx(Ur,{size:16})}),ce&&Qt.length>0&&n.jsx("div",{className:"absolute top-full left-0 right-0 mt-2 bg-white rounded-2xl shadow-xl z-50 overflow-hidden border border-gray-100 max-h-48 overflow-y-auto overscroll-contain",style:{WebkitOverflowScrolling:"touch",touchAction:"pan-y"},children:Qt.map(W=>n.jsx("button",{type:"button",onClick:()=>{vt(W),ie(!1)},className:"w-full text-left px-4 py-3 text-xs font-bold text-gray-700 hover:bg-gray-50 border-b border-gray-50 last:border-none",children:W},`${Me}-${W}`))})]}),n.jsx("button",{type:"button",onClick:()=>{Z(W=>!W),oe(!1),ae(!1),T(!1)},className:`h-12 w-12 flex-shrink-0 rounded-xl flex items-center justify-center shadow-sm active:scale-95 transition-all ${X?"bg-indigo-600 text-white shadow-indigo-200":"bg-white text-indigo-600 border border-indigo-200"}`,title:p("library.sort"),children:n.jsx(fc,{size:20})}),Me==="library"&&n.jsxs("button",{type:"button",onClick:()=>{oe(W=>!W),Z(!1)},className:`relative h-12 w-12 flex-shrink-0 border rounded-xl flex items-center justify-center shadow-sm active:scale-95 transition-all ${te||ft?"bg-white text-indigo-600 border-indigo-200":"bg-white text-gray-400 border-gray-100"}`,title:p("library.filters"),children:[n.jsx(tp,{size:20}),ft&&!te&&n.jsx("div",{className:"absolute top-3 right-3 w-2 h-2 bg-indigo-600 rounded-full border border-white"})]})]}),X&&n.jsxs("div",{className:"bg-white p-4 rounded-[1.5rem] shadow-sm border border-gray-100 space-y-3",children:[n.jsx("h3",{className:"text-[11px] font-bold text-gray-400 uppercase tracking-widest ml-1",children:p("sort.sortBy")}),n.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[["title","author","addedAt","genre"].map(W=>{const ne=re[Me]===W&&!Er;return n.jsxs("button",{type:"button",onClick:()=>$t(W),className:`py-2.5 rounded-xl font-bold text-xs transition-all flex items-center justify-center gap-1.5 ${ne?"bg-indigo-600 text-white shadow-lg shadow-indigo-200":"bg-gray-50 text-gray-600 hover:bg-gray-100"}`,children:[n.jsx("span",{children:p(W==="title"?"sort.title":W==="author"?"sort.author":W==="addedAt"?"sort.date":"sort.genre")}),ne&&(be[Me]==="asc"?n.jsx(hc,{size:14}):n.jsx(pc,{size:14}))]},W)}),n.jsx("button",{type:"button",onClick:Re,disabled:_r.length<2,className:`py-2.5 rounded-xl font-bold text-xs transition-all ${Er||re[Me]==="custom"?"bg-indigo-600 text-white shadow-lg shadow-indigo-200":"bg-gray-50 text-gray-600 hover:bg-gray-100"} disabled:opacity-40 disabled:cursor-not-allowed`,children:p("sort.customOrder")})]})]}),pr&&Vt.trim().length>0&&n.jsx("div",{className:"text-[11px] text-gray-500",children:p("library.reorder.clearSearch")}),Me==="library"&&pr&&ft&&n.jsx("div",{className:"text-[11px] text-gray-500",children:p("library.reorder.clearFilters")}),Me==="library"&&te&&n.jsxs("div",{className:"bg-white p-4 rounded-2xl border border-gray-100 shadow-sm space-y-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx("div",{className:"text-[11px] font-bold text-gray-400 uppercase tracking-widest",children:p("library.filter.status")}),n.jsx("div",{className:"flex flex-wrap gap-2",children:ii.map(W=>{const ne=Pe.includes(W);return n.jsx("button",{type:"button",onClick:()=>rt(W),className:`px-4 py-2 rounded-xl text-xs font-bold transition-all border ${ne?"bg-indigo-100 text-indigo-700 border-indigo-200":"bg-gray-50 text-gray-400 border-gray-100"}`,children:Ht(W)},W)})})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx("div",{className:"text-[11px] font-bold text-gray-400 uppercase tracking-widest",children:p("library.filter.format")}),n.jsx("div",{className:"flex flex-wrap gap-2",children:Ug.map(W=>{const ne=Ye.includes(W);return n.jsx("button",{type:"button",onClick:()=>Ft(W),className:`px-4 py-2 rounded-xl text-xs font-bold transition-all border ${ne?"bg-indigo-100 text-indigo-700 border-indigo-200":"bg-gray-50 text-gray-400 border-gray-100"}`,children:ct(W)},W)})})]}),n.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[n.jsxs("div",{ref:w,className:"relative space-y-1",children:[n.jsx("label",{className:"text-[10px] font-bold text-gray-400 uppercase ml-1",children:p("library.filter.publisher")}),n.jsx("input",{type:"text",value:Ge,onChange:W=>{Te(W.target.value),ae(!0)},onFocus:()=>ae(!0),placeholder:p("library.filter.publisherPlaceholder"),className:"w-full bg-gray-50 px-3 py-2.5 rounded-xl text-xs font-bold border border-gray-100 outline-none focus:ring-2 focus:ring-indigo-500"}),Ge.length>0&&n.jsx("button",{type:"button",onClick:()=>Te(""),className:"absolute right-2 top-7 text-gray-400 hover:text-gray-600 p-1",children:n.jsx(Ur,{size:14})}),it&&Ze.length>0&&n.jsx("div",{className:"absolute left-0 right-0 top-full mt-1 bg-white rounded-xl shadow-xl z-40 overflow-hidden border border-gray-100 max-h-40 overflow-y-auto overscroll-contain",style:{WebkitOverflowScrolling:"touch",touchAction:"pan-y"},children:Ze.map(W=>n.jsx("button",{type:"button",onClick:()=>{Te(W),ae(!1)},className:"w-full text-left px-3 py-2 text-xs font-bold text-gray-700 hover:bg-gray-50 border-b border-gray-50 last:border-none",children:W},W))})]}),n.jsxs("div",{ref:N,className:"relative space-y-1",children:[n.jsx("label",{className:"text-[10px] font-bold text-gray-400 uppercase ml-1",children:p("library.filter.genre")}),n.jsx("input",{type:"text",value:et,onChange:W=>{lt(W.target.value),T(!0)},onFocus:()=>T(!0),placeholder:p("library.filter.genrePlaceholder"),className:"w-full bg-gray-50 px-3 py-2.5 rounded-xl text-xs font-bold border border-gray-100 outline-none focus:ring-2 focus:ring-indigo-500"}),et.length>0&&n.jsx("button",{type:"button",onClick:()=>lt(""),className:"absolute right-2 top-7 text-gray-400 hover:text-gray-600 p-1",children:n.jsx(Ur,{size:14})}),G&&Ct.length>0&&n.jsx("div",{className:"absolute left-0 right-0 top-full mt-1 bg-white rounded-xl shadow-xl z-40 overflow-hidden border border-gray-100 max-h-40 overflow-y-auto overscroll-contain",style:{WebkitOverflowScrolling:"touch",touchAction:"pan-y"},children:Ct.map(W=>n.jsx("button",{type:"button",onClick:()=>{lt(W),T(!1)},className:"w-full text-left px-3 py-2 text-xs font-bold text-gray-700 hover:bg-gray-50 border-b border-gray-50 last:border-none",children:W},W))})]})]}),ft&&n.jsxs("button",{type:"button",onClick:Tt,className:"w-full py-3 flex items-center justify-center gap-2 text-sm font-bold text-red-500 bg-red-50 rounded-2xl hover:bg-red-100 transition-colors",children:[n.jsx(Ur,{size:18}),n.jsx("span",{children:p("library.clearFilters")})]})]})]}),_r.length===0?n.jsx("div",{className:"py-8 text-sm text-gray-500",children:p("library.empty")}):n.jsx("div",{className:"space-y-3",children:_r.map((W,ne)=>n.jsx(Bg,{book:W,onOpen:Fe=>he({kind:"details",tab:Me,bookId:Fe.id}),reorderMode:Er,canMoveUp:ne>0,canMoveDown:ne<_r.length-1,onMoveUp:()=>nt(W.id,"up"),onMoveDown:()=>nt(W.id,"down")},W.id))})]})},Kg=()=>{const[i,p]=j.useState("library"),[f,x]=j.useState(()=>_p()),{isLoading:C,filterTag:y,setFilterTag:_}=pn(),E=f.language==="uk"?"uk":"en",S=za[E],L=V=>S[V]||za.en[V];j.useEffect(()=>{Am()},[]),j.useEffect(()=>{Fp(f.accent,f.bg)},[f.accent,f.bg]),j.useEffect(()=>{y&&p("library")},[y]),j.useEffect(()=>{f.uiV2Enabled&&i==="add"&&p("library")},[i,f.uiV2Enabled]);const R=j.useCallback(V=>{x(V)},[]),J=()=>{if(C)return n.jsx("div",{className:"flex h-screen items-center justify-center animate-bounce",children:n.jsx(di,{size:48,className:"text-indigo-600","aria-label":L("app.loading")})});if(f.uiV2Enabled)switch(i){case"statistics":return n.jsx(Hf,{});case"library":return n.jsx(Xf,{onNavigateToReading:()=>p("reading")});case"reading":return n.jsx(Kf,{});case"add":return n.jsx(Xf,{onNavigateToReading:()=>p("reading")});case"calendar":return n.jsx($f,{});case"wishlist":return null;case"settings":return n.jsx(Wf,{onSettingsChange:R})}switch(i){case"statistics":return n.jsx(Hf,{});case"library":return n.jsx(Sg,{onAddClick:()=>p("add")});case"reading":return n.jsx(Kf,{});case"add":return n.jsx(hg,{onAddSuccess:()=>p("library"),onCancel:()=>p("library")});case"calendar":return n.jsx($f,{});case"wishlist":return null;case"settings":return n.jsx(Wf,{onSettingsChange:R})}};return n.jsx(Pg,{language:E,children:n.jsxs("div",{className:"w-full min-h-screen bg-slate-50 overflow-x-clip relative transition-colors duration-300",children:[n.jsx("main",{className:"min-h-screen",children:J()}),n.jsxs("nav",{className:"fixed bottom-6 left-1/2 -translate-x-1/2 w-[95%] max-w-md bg-white border border-gray-100 rounded-[2.5rem] shadow-2xl p-2 z-50 grid grid-cols-5 gap-1 items-center",children:[n.jsx(Fa,{active:i==="library"||i==="add",onClick:()=>{p("library"),_("")},icon:n.jsx(di,{size:20}),label:L("nav.library")}),n.jsx(Fa,{active:i==="reading",onClick:()=>p("reading"),icon:n.jsx(Zf,{size:20}),label:L("nav.reading")}),n.jsx(Fa,{active:i==="calendar",onClick:()=>p("calendar"),icon:n.jsx($a,{size:20}),label:L("nav.calendar")}),n.jsx(Fa,{active:i==="statistics",onClick:()=>p("statistics"),icon:n.jsx(Yh,{size:20}),label:L("nav.statistics")}),n.jsx(Fa,{active:i==="settings",onClick:()=>p("settings"),icon:n.jsx(cm,{size:20}),label:L("nav.settings")})]})]})})},Fa=({active:i,onClick:p,icon:f,label:x})=>{const C=Nr.useRef(0),y=Nr.useCallback(()=>{const _=Date.now();_-C.current<300||(C.current=_,p())},[p]);return n.jsxs("button",{onClick:y,onTouchEnd:y,className:`flex flex-col items-center justify-center p-2 rounded-2xl transition-all w-full ${i?"text-indigo-600 scale-110 font-medium":"text-gray-400 hover:bg-gray-50/50"}`,children:[f,n.jsx("span",{className:`text-[9px] font-bold mt-1 uppercase tracking-tighter transition-opacity ${i?"opacity-100":"opacity-0"}`,children:x})]})},Vg=()=>n.jsx(yg,{children:n.jsx(ug,{children:n.jsx(ag,{children:n.jsx(Kg,{})})})});window.addEventListener("touchmove",function(){},{passive:!1});const Vp=document.getElementById("root");if(!Vp)throw new Error("Could not find root element to mount to");const Wg=qh.createRoot(Vp);Wg.render(n.jsx(Nr.StrictMode,{children:n.jsx(Vg,{})}));
